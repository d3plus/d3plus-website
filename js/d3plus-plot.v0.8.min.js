/*
  d3plus-plot v0.8.25
  A reusable javascript x/y plot built on D3.
  Copyright (c) 2019 D3plus - https://d3plus.org
  @license MIT
*/
(function(t){typeof define==="function"&&define.amd?define(t):t()})(function(){"use strict";var t=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function e(t,e){return e={exports:{}},t(e,e.exports),e.exports}var n="object";var r=function(t){return t&&t.Math==Math&&t};var d=r(typeof globalThis==n&&globalThis)||r(typeof window==n&&window)||r(typeof self==n&&self)||r(typeof t==n&&t)||Function("return this")();var i=function(t){try{return!!t()}catch(t){return true}};var h=!i(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7});var a={}.propertyIsEnumerable;var o=Object.getOwnPropertyDescriptor;var s=o&&!a.call({1:2},1);var c=s?function t(e){var n=o(this,e);return!!n&&n.enumerable}:a;var v={f:c};var u=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}};var f={}.toString;var l=function(t){return f.call(t).slice(8,-1)};var _="".split;var m=i(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return l(t)=="String"?_.call(t,""):Object(t)}:Object;var g=function(t){if(t==undefined)throw TypeError("Can't call method on "+t);return t};var y=function(t){return m(g(t))};var p=function(t){return typeof t==="object"?t!==null:typeof t==="function"};var x=function(t,e){if(!p(t))return t;var n,r;if(e&&typeof(n=t.toString)=="function"&&!p(r=n.call(t)))return r;if(typeof(n=t.valueOf)=="function"&&!p(r=n.call(t)))return r;if(!e&&typeof(n=t.toString)=="function"&&!p(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")};var b={}.hasOwnProperty;var C=function(t,e){return b.call(t,e)};var w=d.document;var k=p(w)&&p(w.createElement);var S=function(t){return k?w.createElement(t):{}};var O=!h&&!i(function(){return Object.defineProperty(S("div"),"a",{get:function(){return 7}}).a!=7});var A=Object.getOwnPropertyDescriptor;var P=h?A:function t(e,n){e=y(e);n=x(n,true);if(O)try{return A(e,n)}catch(t){}if(C(e,n))return u(!v.f.call(e,n),e[n])};var T={f:P};var z=function(t){if(!p(t)){throw TypeError(String(t)+" is not an object")}return t};var j=Object.defineProperty;var D=h?j:function t(e,n,r){z(e);n=x(n,true);z(r);if(O)try{return j(e,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");if("value"in r)e[n]=r.value;return e};var L={f:D};var M=h?function(t,e,n){return L.f(t,e,u(1,n))}:function(t,e,n){t[e]=n;return t};var E=function(e,n){try{M(d,e,n)}catch(t){d[e]=n}return n};var B=e(function(t){var e="__core-js_shared__";var n=d[e]||E(e,{});(t.exports=function(t,e){return n[t]||(n[t]=e!==undefined?e:{})})("versions",[]).push({version:"3.2.1",mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})});var R=B("native-function-to-string",Function.toString);var q=d.WeakMap;var N=typeof q==="function"&&/native code/.test(R.call(q));var F=0;var I=Math.random();var W=function(t){return"Symbol("+String(t===undefined?"":t)+")_"+(++F+I).toString(36)};var V=B("keys");var G=function(t){return V[t]||(V[t]=W(t))};var H={};var U=d.WeakMap;var K,Y,J;var Q=function(t){return J(t)?Y(t):K(t,{})};var X=function(n){return function(t){var e;if(!p(t)||(e=Y(t)).type!==n){throw TypeError("Incompatible receiver, "+n+" required")}return e}};if(N){var Z=new U;var $=Z.get;var tt=Z.has;var et=Z.set;K=function(t,e){et.call(Z,t,e);return e};Y=function(t){return $.call(Z,t)||{}};J=function(t){return tt.call(Z,t)}}else{var nt=G("state");H[nt]=true;K=function(t,e){M(t,nt,e);return e};Y=function(t){return C(t,nt)?t[nt]:{}};J=function(t){return C(t,nt)}}var rt={set:K,get:Y,has:J,enforce:Q,getterFor:X};var it=e(function(t){var e=rt.get;var s=rt.enforce;var c=String(R).split("toString");B("inspectSource",function(t){return R.call(t)});(t.exports=function(t,e,n,r){var i=r?!!r.unsafe:false;var a=r?!!r.enumerable:false;var o=r?!!r.noTargetGet:false;if(typeof n=="function"){if(typeof e=="string"&&!C(n,"name"))M(n,"name",e);s(n).source=c.join(typeof e=="string"?e:"")}if(t===d){if(a)t[e]=n;else E(e,n);return}else if(!i){delete t[e]}else if(!o&&t[e]){a=true}if(a)t[e]=n;else M(t,e,n)})(Function.prototype,"toString",function t(){return typeof this=="function"&&e(this).source||R.call(this)})});var at=d;var ot=function(t){return typeof t=="function"?t:undefined};var st=function(t,e){return arguments.length<2?ot(at[t])||ot(d[t]):at[t]&&at[t][e]||d[t]&&d[t][e]};var ct=Math.ceil;var ut=Math.floor;var ft=function(t){return isNaN(t=+t)?0:(t>0?ut:ct)(t)};var dt=Math.min;var lt=function(t){return t>0?dt(ft(t),9007199254740991):0};var ht=Math.max;var vt=Math.min;var _t=function(t,e){var n=ft(t);return n<0?ht(n+e,0):vt(n,e)};var gt=function(s){return function(t,e,n){var r=y(t);var i=lt(r.length);var a=_t(n,i);var o;if(s&&e!=e)while(i>a){o=r[a++];if(o!=o)return true}else for(;i>a;a++){if((s||a in r)&&r[a]===e)return s||a||0}return!s&&-1}};var yt={includes:gt(true),indexOf:gt(false)};var pt=yt.indexOf;var xt=function(t,e){var n=y(t);var r=0;var i=[];var a;for(a in n)!C(H,a)&&C(n,a)&&i.push(a);while(e.length>r)if(C(n,a=e[r++])){~pt(i,a)||i.push(a)}return i};var mt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];var bt=mt.concat("length","prototype");var Ct=Object.getOwnPropertyNames||function t(e){return xt(e,bt)};var wt={f:Ct};var kt=Object.getOwnPropertySymbols;var St={f:kt};var Ot=st("Reflect","ownKeys")||function t(e){var n=wt.f(z(e));var r=St.f;return r?n.concat(r(e)):n};var At=function(t,e){var n=Ot(e);var r=L.f;var i=T.f;for(var a=0;a<n.length;a++){var o=n[a];if(!C(t,o))r(t,o,i(e,o))}};var Pt=/#|\.prototype\./;var Tt=function(t,e){var n=jt[zt(t)];return n==Lt?true:n==Dt?false:typeof e=="function"?i(e):!!e};var zt=Tt.normalize=function(t){return String(t).replace(Pt,".").toLowerCase()};var jt=Tt.data={};var Dt=Tt.NATIVE="N";var Lt=Tt.POLYFILL="P";var Mt=Tt;var Et=T.f;var Bt=function(t,e){var n=t.target;var r=t.global;var i=t.stat;var a,o,s,c,u,f;if(r){o=d}else if(i){o=d[n]||E(n,{})}else{o=(d[n]||{}).prototype}if(o)for(s in e){u=e[s];if(t.noTargetGet){f=Et(o,s);c=f&&f.value}else c=o[s];a=Mt(r?s:n+(i?".":"#")+s,t.forced);if(!a&&c!==undefined){if(typeof u===typeof c)continue;At(u,c)}if(t.sham||c&&c.sham){M(u,"sham",true)}it(o,s,u,t)}};var Rt=function(t){if(typeof t!="function"){throw TypeError(String(t)+" is not a function")}return t};var qt=function(r,i,t){Rt(r);if(i===undefined)return r;switch(t){case 0:return function(){return r.call(i)};case 1:return function(t){return r.call(i,t)};case 2:return function(t,e){return r.call(i,t,e)};case 3:return function(t,e,n){return r.call(i,t,e,n)}}return function(){return r.apply(i,arguments)}};var Nt=function(t){return Object(g(t))};var Ft=Array.isArray||function t(e){return l(e)=="Array"};var It=!!Object.getOwnPropertySymbols&&!i(function(){return!String(Symbol())});var Wt=d.Symbol;var Vt=B("wks");var Gt=function(t){return Vt[t]||(Vt[t]=It&&Wt[t]||(It?Wt:W)("Symbol."+t))};var Ht=Gt("species");var Ut=function(t,e){var n;if(Ft(t)){n=t.constructor;if(typeof n=="function"&&(n===Array||Ft(n.prototype)))n=undefined;else if(p(n)){n=n[Ht];if(n===null)n=undefined}}return new(n===undefined?Array:n)(e===0?0:e)};var Kt=[].push;var Yt=function(h){var v=h==1;var _=h==2;var g=h==3;var y=h==4;var p=h==6;var x=h==5||p;return function(t,e,n,r){var i=Nt(t);var a=m(i);var o=qt(e,n,3);var s=lt(a.length);var c=0;var u=r||Ut;var f=v?u(t,s):_?u(t,0):undefined;var d,l;for(;s>c;c++)if(x||c in a){d=a[c];l=o(d,c,i);if(h){if(v)f[c]=l;else if(l)switch(h){case 3:return true;case 5:return d;case 6:return c;case 2:Kt.call(f,d)}else if(y)return false}}return p?-1:g||y?y:f}};var Jt={forEach:Yt(0),map:Yt(1),filter:Yt(2),some:Yt(3),every:Yt(4),find:Yt(5),findIndex:Yt(6)};var Qt=Object.keys||function t(e){return xt(e,mt)};var Xt=h?Object.defineProperties:function t(e,n){z(e);var r=Qt(n);var i=r.length;var a=0;var o;while(i>a)L.f(e,o=r[a++],n[o]);return e};var Zt=st("document","documentElement");var $t=G("IE_PROTO");var te="prototype";var ee=function(){};var ne=function(){var t=S("iframe");var e=mt.length;var n="<";var r="script";var i=">";var a="java"+r+":";var o;t.style.display="none";Zt.appendChild(t);t.src=String(a);o=t.contentWindow.document;o.open();o.write(n+r+i+"document.F=Object"+n+"/"+r+i);o.close();ne=o.F;while(e--)delete ne[te][mt[e]];return ne()};var re=Object.create||function t(e,n){var r;if(e!==null){ee[te]=z(e);r=new ee;ee[te]=null;r[$t]=e}else r=ne();return n===undefined?r:Xt(r,n)};H[$t]=true;var ie=Gt("unscopables");var ae=Array.prototype;if(ae[ie]==undefined){M(ae,ie,re(null))}var oe=function(t){ae[ie][t]=true};var se=Jt.find;var ce="find";var ue=true;if(ce in[])Array(1)[ce](function(){ue=false});Bt({target:"Array",proto:true,forced:ue},{find:function t(e){return se(this,e,arguments.length>1?arguments[1]:undefined)}});oe(ce);var fe=yt.includes;Bt({target:"Array",proto:true},{includes:function t(e){return fe(this,e,arguments.length>1?arguments[1]:undefined)}});oe("includes");var de=Object.assign;var le=!de||i(function(){var t={};var e={};var n=Symbol();var r="abcdefghijklmnopqrst";t[n]=7;r.split("").forEach(function(t){e[t]=t});return de({},t)[n]!=7||Qt(de({},e)).join("")!=r})?function t(e,n){var r=Nt(e);var i=arguments.length;var a=1;var o=St.f;var s=v.f;while(i>a){var c=m(arguments[a++]);var u=o?Qt(c).concat(o(c)):Qt(c);var f=u.length;var d=0;var l;while(f>d){l=u[d++];if(!h||s.call(c,l))r[l]=c[l]}}return r}:de;Bt({target:"Object",stat:true,forced:Object.assign!==le},{assign:le});var he=Gt("match");var ve=function(t){var e;return p(t)&&((e=t[he])!==undefined?!!e:l(t)=="RegExp")};var _e=function(t){if(ve(t)){throw TypeError("The method doesn't accept regular expressions")}return t};var ge=Gt("match");var ye=function(e){var n=/./;try{"/./"[e](n)}catch(t){try{n[ge]=false;return"/./"[e](n)}catch(t){}}return false};Bt({target:"String",proto:true,forced:!ye("includes")},{includes:function t(e){return!!~String(g(this)).indexOf(_e(e),arguments.length>1?arguments[1]:undefined)}});var pe="".startsWith;var xe=Math.min;Bt({target:"String",proto:true,forced:!ye("startsWith")},{startsWith:function t(e){var n=String(g(this));_e(e);var r=lt(xe(arguments.length>1?arguments[1]:undefined,n.length));var i=String(e);return pe?pe.call(n,i,r):n.slice(r,r+i.length)===i}});if(typeof window!=="undefined"){(function(){var r=function(t,e){var n=t.nodeType;if(n===3){e.push(t.textContent.replace(/&/,"&amp;").replace(/</,"&lt;").replace(">","&gt;"))}else if(n===1){e.push("<",t.tagName);if(t.hasAttributes()){[].forEach.call(t.attributes,function(t){e.push(" ",t.item.name,"='",t.item.value,"'")})}if(t.hasChildNodes()){e.push(">");[].forEach.call(t.childNodes,function(t){r(t,e)});e.push("</",t.tagName,">")}else{e.push("/>")}}else if(n==8){e.push("\x3c!--",t.nodeValue,"--\x3e")}};Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){var t=[];var e=this.firstChild;while(e){r(e,t);e=e.nextSibling}return t.join("")},set:function(t){while(this.firstChild){this.removeChild(this.firstChild)}try{var e=new DOMParser;e.async=false;var n="<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>"+t+"</svg>";var r=e.parseFromString(n,"text/xml").documentElement;var i=r.firstChild;while(i){this.appendChild(this.ownerDocument.importNode(i,true));i=i.nextSibling}}catch(t){}}});Object.defineProperty(SVGElement.prototype,"innerSVG",{get:function(){return this.innerHTML},set:function(t){this.innerHTML=t}})})()}});(function(t,e){typeof exports==="object"&&typeof module!=="undefined"?e(exports,require("d3plus-common"),require("d3-array"),require("d3-collection"),require("d3-scale"),require("d3-shape"),require("d3plus-axis"),require("d3plus-color"),require("d3plus-shape"),require("d3plus-viz"),require("d3-selection")):typeof define==="function"&&define.amd?define("d3plus-plot",["exports","d3plus-common","d3-array","d3-collection","d3-scale","d3-shape","d3plus-axis","d3plus-color","d3plus-shape","d3plus-viz","d3-selection"],e):(t=t||self,e(t.d3plus={},t.d3plusCommon,t.d3Array,t.d3Collection,t.scales,t.d3Shape,t.d3plusAxis,t.d3plusColor,t.shapes,t.d3plusViz,t.d3Selection))})(this,function(t,Rt,qt,Nt,Ft,It,Wt,r,Vt,e,m){"use strict";function n(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(t,r.key,r)}}function a(t,e,n){if(e)i(t.prototype,e);if(n)i(t,n);return t}function Gt(t,e,n){if(e in t){Object.defineProperty(t,e,{value:n,enumerable:true,configurable:true,writable:true})}else{t[e]=n}return t}function o(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)s(t,e)}function Ht(t){Ht=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return Ht(t)}function s(t,e){s=Object.setPrototypeOf||function t(e,n){e.__proto__=n;return e};return s(t,e)}function c(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function u(t,e){if(e&&(typeof e==="object"||typeof e==="function")){return e}return c(t)}function f(t,e){while(!Object.prototype.hasOwnProperty.call(t,e)){t=Ht(t);if(t===null)break}return t}function Ut(t,e,n){if(typeof Reflect!=="undefined"&&Reflect.get){Ut=Reflect.get}else{Ut=function t(e,n,r){var i=f(e,n);if(!i)return;var a=Object.getOwnPropertyDescriptor(i,n);if(a.get){return a.get.call(r)}return a.value}}return Ut(t,e,n||t)}var x=function(t,e,n){if(t.padding)t.padding(.5);else{var r=e.map(function(t){return t[n]}).reduce(function(t,e,n,r){if(!n)return t;var i=r[n-1];if(!t||e-i<t)return e-i;else return t},0);var i=t.domain().slice();if(n==="y")i.reverse();i[0]=new Date(+i[0]-r/2);i[1]=new Date(+i[1]+r/2);if(n==="y")i.reverse();t.domain(i)}};function d(t){var e=this;var n=t.data,r=t.x,i=t.y,a=t.x2,o=t.y2,s=t.buffer,c=s===void 0?10:s;var u=a?"x2":"x";var f=o?"y2":"y";var d=this._discrete==="x"?i:r;var l=d.domain().slice();var h=this._discrete==="x";if(h)l.reverse();var v,_;if(this._stacked){var g=Nt.nest().key(function(t){return"".concat(t[e._discrete],"_").concat(t.group)}).entries(n).map(function(t){return t.values.map(function(t){return t[h?f:u]})});_=g.map(function(t){return qt.sum(t.filter(function(t){return t>0}))});v=g.map(function(t){return qt.sum(t.filter(function(t){return t<0}))})}else{_=n.map(function(t){return t[h?f:u]});v=_}var y=d(qt.max(_));if(h?y<d(0):y>d(0))y+=h?-c:c;y=d.invert(y);var p=d(qt.min(v));if(h?p>d(0):p<d(0))p+=h?c:-c;p=d.invert(p);if(y>l[1])l[1]=y;if(p<l[0])l[0]=p;if(h)l.reverse();d.domain(l);x(h?r:i,n,this._discrete);return[r,i]}function l(t){var e=this;var n=t.data,r=t.x,i=t.y,a=t.x2,o=t.y2,s=t.buffer,c=s===void 0?10:s;var u=a?"x2":"x";var f=o?"y2":"y";var d=this._discrete==="x"?i:r;var l=d.domain().slice();var h=this._discrete==="x";if(h)l.reverse();var v,_;if(this._stacked){var g=Nt.nest().key(function(t){return t[e._discrete]}).entries(n).map(function(t){return t.values.map(function(t){return t[h?f:u]})});_=g.map(function(t){return qt.sum(t.filter(function(t){return t>0}))});v=g.map(function(t){return qt.sum(t.filter(function(t){return t<0}))})}else{_=n.map(function(t){return t[h?f:u]});v=_}var y=d(qt.max(_));y+=h?-c:c;y=d.invert(y);var p=d(qt.min(v));p+=h?c:-c;p=d.invert(p);if(y>l[1])l[1]=y;if(p<l[0])l[0]=p;if(h)l.reverse();d.domain(l);x(h?r:i,n,this._discrete);return[r,i]}function h(t){var e=t.data,o=t.x,s=t.y,n=t.x2,r=t.y2,c=t.config,u=t.buffer;var f=n?"x2":"x";var d=r?"y2":"y";var l=o.domain().slice(),h=s.domain().slice();var v=o.range(),_=s.range();if(!o.invert&&o.padding)x(o,e,this._discrete);if(!s.invert&&s.padding)x(s,e,this._discrete);e.forEach(function(t){var e=u?u:c.r(t.data,t.i)*2;if(o.invert&&o(t[f])-v[0]<e){var n=o.invert(o(t[f])-e);if(n<l[0])l[0]=n}if(o.invert&&v[1]-o(t[f])<e){var r=o.invert(o(t[f])+e);if(r>l[1])l[1]=r}if(s.invert&&s(t[d])-_[0]<e){var i=s.invert(s(t[d])-e);if(i>h[0])h[0]=i}if(s.invert&&_[1]-s(t[d])<e){var a=s.invert(s(t[d])+e);if(a<h[1])h[1]=a}});o.domain(l).range(v);s.domain(h).range(_);return[o,s]}function v(t){var e=this;var n=t.data,r=t.x,i=t.y,a=t.x2,o=t.y2;var s=a?"x2":"x";var c=o?"y2":"y";var u=this._discrete==="x"?i:r;var f=u.domain().slice();if(this._discrete==="x")f.reverse();var d=n.map(function(t){return t[e._discrete==="x"?c:s]});var l=u.invert(u(qt.max(d))+(this._discrete==="x"?-10:10));if(l>f[1])f[1]=l;if(this._discrete==="x")f.reverse();u.domain(f);return[r,i]}function _(t){var e=t.data,s=t.x,c=t.y,n=t.x2,r=t.y2,u=t.config;var f=n?"x2":"x";var d=r?"y2":"y";var l=s.domain().slice(),h=c.domain().slice();var v=s.range(),_=c.range();if(!s.invert&&s.padding)x(s,e,this._discrete);if(!c.invert&&c.padding)x(c,e,this._discrete);e.forEach(function(t){var e=u.height(t.data,t.i),n=u.width(t.data,t.i);if(s.invert&&s(t[f])-v[0]<n){var r=s.invert(s(t[f])-n);if(r<l[0])l[0]=r}if(s.invert&&v[1]-s(t[f])<n){var i=s.invert(s(t[f])+n);if(i>l[1])l[1]=i}if(c.invert&&c(t[d])-_[0]<e){var a=c.invert(c(t[d])-e);if(a>h[0])h[0]=a}if(c.invert&&_[1]-c(t[d])<e){var o=c.invert(c(t[d])+e);if(o<h[1])h[1]=o}});s.domain(l);c.domain(h);return[s,c]}function g(t){return this._sizeScaleD3(this._size?this._size(t):null)}function y(t){var n=t.map(b);var r=t.map(function(t){return t.key.split("_")[0]});return It.stackOrderNone(t).sort(function(t,e){return r[e].localeCompare(r[t])||n[t]-n[e]})}function p(t){return y(t).reverse()}function b(t){var e=-1,n=0,r;var i=t.length;while(++e<i){if(r=+t[e][1])n+=r}return n}var C=function(t){o(Bt,t);function Bt(){var i;n(this,Bt);i=u(this,Ht(Bt).call(this));i._annotations=[];i._backgroundConfig={duration:0,fill:"transparent"};i._barPadding=0;i._buffer={Bar:d,Box:l,Circle:h,Line:v,Rect:_};i._confidenceConfig={fillOpacity:Rt.constant(.5)};i._discreteCutoff=100;i._groupPadding=5;i._shape=Rt.constant("Circle");i._shapeConfig=Rt.assign(i._shapeConfig,{Area:{label:function t(e,n){return i._stacked?i._drawLabel(e,n):false},labelConfig:{fontResize:true}},ariaLabel:function t(e,n){var r="";if(e.nested)r="".concat(i._drawLabel(e.data,e.i));else{r="".concat(i._drawLabel(e,n));if(i._x(e,n)!==undefined)r+=", x: ".concat(i._x(e,n));if(i._y(e,n)!==undefined)r+=", y: ".concat(i._y(e,n));if(i._x2(e,n)!==undefined)r+=", x2: ".concat(i._x2(e,n));if(i._y2(e,n)!==undefined)r+=", y2: ".concat(i._y2(e,n))}return"".concat(r,".")},Bar:{labelConfig:{textAnchor:function t(){return i._discrete==="x"?"middle":"end"},verticalAlign:function t(){return i._discrete==="x"?"top":"middle"}}},Circle:{r:g.bind(c(i))},Line:{fill:Rt.constant("none"),label:false,stroke:function t(e,n){return r.colorAssign(i._id(e,n))},strokeWidth:Rt.constant(1)},Rect:{height:function t(e){return g.bind(c(i))(e)*2},width:function t(e){return g.bind(c(i))(e)*2}}});i._shapeOrder=["Area","Path","Bar","Box","Line","Rect","Circle"];i._shapeSort=function(t,e){return i._shapeOrder.indexOf(t)-i._shapeOrder.indexOf(e)};i._sizeMax=20;i._sizeMin=5;i._sizeScale="sqrt";i._stackOffset=It.stackOffsetDiverging;i._stackOrder=p;i._timelineConfig=Rt.assign(i._timelineConfig,{brushing:true});i._x=Rt.accessor("x");i._xAxis=(new Wt.AxisBottom).align("end");i._xTest=(new Wt.AxisBottom).align("end").gridSize(0);i._xConfig={};i._xCutoff=150;i._x2=Rt.accessor("x2");i._x2Axis=(new Wt.AxisTop).align("start");i._x2Test=(new Wt.AxisTop).align("start").gridSize(0);i._x2Config={padding:0};i._y=Rt.accessor("y");i._yAxis=(new Wt.AxisLeft).align("start");i._yTest=(new Wt.AxisLeft).align("start").gridSize(0);i._yConfig={gridConfig:{stroke:function t(e){var n=i._yAxis.domain();return n[n.length-1]===e.id?"transparent":"#ccc"}}};i._yCutoff=150;i._y2=Rt.accessor("y2");i._y2Axis=(new Wt.AxisRight).align("end");i._y2Test=(new Wt.AxisLeft).align("end").gridSize(0);i._y2Config={};return i}a(Bt,[{key:"_draw",value:function t(e){var O=this;if(!this._filteredData.length)return this;var s=function t(e,n){return O._stacked?"".concat(O._groupBy.length>1?O._ids(e,n).slice(0,-1).join("_"):"group"):"".concat(O._ids(e,n).join("_"))};var c=this._filteredData.map(function(t,e){return{__d3plus__:true,data:t,group:s(t,e),i:e,hci:O._confidence&&O._confidence[1]&&O._confidence[1](t,e),id:O._ids(t,e).slice(0,O._drawDepth+1).join("_"),lci:O._confidence&&O._confidence[0]&&O._confidence[0](t,e),shape:O._shape(t,e),x:O._x(t,e),x2:O._x2(t,e),y:O._y(t,e),y2:O._y2(t,e)}});this._formattedData=c;if(this._size){var n=qt.extent(c,function(t){return O._size(t.data)});this._sizeScaleD3=function(){return O._sizeMin};this._sizeScaleD3=Ft["scale".concat(this._sizeScale.charAt(0).toUpperCase()).concat(this._sizeScale.slice(1))]().domain(n).range([n[0]===n[1]?this._sizeMax:qt.min([this._sizeMax/2,this._sizeMin]),this._sizeMax])}else{this._sizeScaleD3=function(){return O._sizeMin}}var r=c.some(function(t){return t.x2!==undefined}),i=c.some(function(t){return t.y2!==undefined});var a=this._height-this._margin.top-this._margin.bottom,u=this._discrete?this._discrete==="x"?"y":"x":undefined,o=this._discrete?this._discrete==="x"?"y2":"x2":undefined,f=[u,o].filter(function(t){return t}),d=this._select,l=this._transition,A=this._width-this._margin.left-this._margin.right;var h=this._time&&c[0].x2===this._time(c[0].data,c[0].i),v=this._time&&c[0].x===this._time(c[0].data,c[0].i),_=this._time&&c[0].y2===this._time(c[0].data,c[0].i),g=this._time&&c[0].y===this._time(c[0].data,c[0].i);for(var y=0;y<c.length;y++){var p=c[y];if(v)p.x=Wt.date(p.x);if(h)p.x2=Wt.date(p.x2);if(g)p.y=Wt.date(p.y);if(_)p.y2=Wt.date(p.y2);p.discrete=p.shape==="Bar"?"".concat(p[this._discrete],"_").concat(p.group):"".concat(p[this._discrete])}var x,m,b,C;if(this._stacked){var w;var k=Nt.nest().key(function(t){return t.group}).entries(c).reduce(function(t,e){if(!t[e.key])t[e.key]=0;t[e.key]+=qt.sum(e.values,function(t){return t[u]});return t},{});c=c.sort(function(t,e){if(O["_".concat(O._discrete,"Sort")])return O["_".concat(O._discrete,"Sort")](t.data,e.data);var n=t[O._discrete],r=e[O._discrete];if(n-r!==0)return n-r;if(t.group!==e.group)return k[e.group]-k[t.group];return e[u]-t[u]});x=Array.from(new Set(c.map(function(t){return t.discrete})));C=Array.from(new Set(c.map(function(t){return t.id})));b=Nt.nest().key(function(t){return t.discrete}).entries(c).map(function(t){return t.values});b.forEach(function(a){var o=Array.from(new Set(a.map(function(t){return t.id})));if(o.length<C.length){C.forEach(function(e){if(!o.includes(e)){var t=c.filter(function(t){return t.id===e})[0];if(t.shape==="Area"){var n;var r=s(t.data,t.i);var i=(n={__d3plus__:true,data:t.data,discrete:t.shape==="Bar"?"".concat(a[0][O._discrete],"_").concat(r):"".concat(a[0][O._discrete]),group:r,id:e,shape:t.shape},Gt(n,O._discrete,a[0][O._discrete]),Gt(n,u,0),n);c.push(i)}}})}});if(this["_".concat(this._discrete,"Sort")]){c.sort(function(t,e){return O["_".concat(O._discrete,"Sort")](t.data,e.data)})}else{c.sort(function(t,e){return t[O._discrete]-e[O._discrete]})}var S=this._stackOrder;if(S instanceof Array)C.sort(function(t,e){return S.indexOf(t)-S.indexOf(e)});else if(S===It.stackOrderNone)C.sort(function(t,e){return t.localeCompare(e)});b=It.stack().keys(C).offset(this._stackOffset).order(S instanceof Array?It.stackOrderNone:S).value(function(t,e){var n=t.filter(function(t){return t.id===e});return n.length?n[0][u]:0})(b);m=(w={},Gt(w,this._discrete,qt.extent(c,function(t){return t[O._discrete]})),Gt(w,u,[qt.min(b.map(function(t){return qt.min(t.map(function(t){return t[0]}))})),qt.max(b.map(function(t){return qt.max(t.map(function(t){return t[1]}))}))]),w)}else{var P=this._discrete==="x"?c.map(function(t){return t.x}):c.map(function(t){return t.x}).concat(this._confidence&&this._confidence[0]?c.map(function(t){return t.lci}):[]).concat(this._confidence&&this._confidence[1]?c.map(function(t){return t.hci}):[]);var T=this._discrete==="x"?c.map(function(t){return t.x2}):c.map(function(t){return t.x2}).concat(this._confidence&&this._confidence[0]?c.map(function(t){return t.lci}):[]).concat(this._confidence&&this._confidence[1]?c.map(function(t){return t.hci}):[]);var z=this._discrete==="y"?c.map(function(t){return t.y}):c.map(function(t){return t.y}).concat(this._confidence&&this._confidence[0]?c.map(function(t){return t.lci}):[]).concat(this._confidence&&this._confidence[1]?c.map(function(t){return t.hci}):[]);var j=this._discrete==="y"?c.map(function(t){return t.y2}):c.map(function(t){return t.y2}).concat(this._confidence&&this._confidence[0]?c.map(function(t){return t.lci}):[]).concat(this._confidence&&this._confidence[1]?c.map(function(t){return t.hci}):[]);if(this["_".concat(this._discrete,"Sort")]){c.sort(function(t,e){return O["_".concat(O._discrete,"Sort")](t.data,e.data)})}else{c.sort(function(t,e){return t[O._discrete]-e[O._discrete]})}m={x:this._xSort?Array.from(new Set(c.filter(function(t){return t.x}).sort(function(t,e){return O._xSort(t.data,e.data)}).map(function(t){return t.x}))):qt.extent(P,function(t){return t}),x2:this._x2Sort?Array.from(new Set(c.filter(function(t){return t.x2}).sort(function(t,e){return O._x2Sort(t.data,e.data)}).map(function(t){return t.x2}))):qt.extent(T,function(t){return t}),y:this._ySort?Array.from(new Set(c.filter(function(t){return t.y}).sort(function(t,e){return O._ySort(t.data,e.data)}).map(function(t){return t.y}))):qt.extent(z,function(t){return t}),y2:this._y2Sort?Array.from(new Set(c.filter(function(t){return t.y2}).sort(function(t,e){return O._y2Sort(t.data,e.data)}).map(function(t){return t.y2}))):qt.extent(j,function(t){return t})}}var D=this._xDomain?this._xDomain.slice():m.x,L=this._xSort?"Point":"Linear";if(D[0]===void 0)D[0]=m.x[0];if(D[1]===void 0)D[1]=m.x[1];if(v){D=D.map(Wt.date);L="Time"}else if(this._discrete==="x"){D=Array.from(new Set(c.filter(function(t){return t.x}).sort(function(t,e){return O._xSort?O._xSort(t.data,e.data):t.x-e.x}).map(function(t){return t.x})));L="Point"}var M=this._x2Domain?this._x2Domain.slice():m.x2,E=this._x2Sort?"Point":"Linear";if(M&&M[0]===void 0)M[0]=m.x2[0];if(M&&M[1]===void 0)M[1]=m.x2[1];if(h){M=M.map(Wt.date);E="Time"}else if(this._discrete==="x"){M=Array.from(new Set(c.filter(function(t){return t.x2}).sort(function(t,e){return O._x2Sort?O._x2Sort(t.data,e.data):t.x2-e.x2}).map(function(t){return t.x2})));E="Point"}var B=this._yDomain?this._yDomain.slice():m.y,R=this._ySort?"Point":"Linear";if(B[0]===void 0)B[0]=m.y[0];if(B[1]===void 0)B[1]=m.y[1];var q=this._y2Domain?this._y2Domain.slice():m.y2,N=this._y2Sort?"Point":"Linear";if(q&&q[0]===void 0)q[0]=m.y2[0];if(q&&q[1]===void 0)q[1]=m.y2[1];if(g){B=B.map(Wt.date);R="Time"}else if(this._discrete==="y"){B=Array.from(new Set(c.sort(function(t,e){return O._ySort?O._ySort(t.data,e.data):t.y-e.y}).map(function(t){return t.y})));R="Point";q=Array.from(new Set(c.sort(function(t,e){return O._y2Sort?O._y2Sort(t.data,e.data):t.y2-e.y2}).map(function(t){return t.y2})));N="Point"}if(_){q=q.map(Wt.date);N="Time"}m={x:D,x2:M||D,y:B,y2:q||B};f.forEach(function(t){if(O["_".concat(t,"Config")].domain){var e=O["_".concat(t,"Config")].domain;if(O._discrete==="x")e.reverse();m[t]=e}else if(t&&O._baseline!==void 0){var n=O._baseline;if(m[t]&&m[t][0]>n)m[t][0]=n;else if(m[t]&&m[t][1]<n)m[t][1]=n}});var F=Ft["scale".concat(L)]().domain(m.x).range(qt.range(0,A+1,A/(m.x.length-1))),I=Ft["scale".concat(E)]().domain(m.x2).range(qt.range(0,A+1,A/(m.x2.length-1))),W=Ft["scale".concat(R)]().domain(m.y.reverse()).range(qt.range(0,a+1,a/(m.y.length-1))),V=Ft["scale".concat(N)]().domain(m.y2.reverse()).range(qt.range(0,a+1,a/(m.y2.length-1)));var G=Nt.nest().key(function(t){return t.shape}).entries(c).sort(function(t,e){return O._shapeSort(t.key,e.key)});var H=this._discrete==="x"?R:L;if(this._xConfig.scale!=="log"&&this._yConfig.scale!=="log"&&H!=="Point"){G.forEach(function(t){if(O._buffer[t.key]){var e=O._buffer[t.key].bind(O)({data:t.values,x:F,y:W,config:O._shapeConfig[t.key]});if(O._xConfig.scale!=="log")F=e[0];if(O._yConfig.scale!=="log")W=e[1];var n=O._buffer[t.key].bind(O)({data:t.values,x:I,y:V,x2:true,y2:true,config:O._shapeConfig[t.key]});if(O._x2Config.scale!=="log")I=n[0];if(O._y2Config.scale!=="log")V=n[1]}})}D=F.domain();M=I.domain();B=W.domain();q=V.domain();var U={barConfig:{"stroke-width":0},gridSize:0,labels:[],title:false,tickSize:0};var K=r?{}:U;var Y=i?{}:U;var J=this._discrete==="x"&&this._width>this._discreteCutoff||this._width>this._xCutoff;var Q=this._discrete==="y"&&this._height>this._discreteCutoff||this._height>this._yCutoff;var X={gridConfig:{stroke:!this._discrete||this._discrete==="x"?this._yTest.gridConfig().stroke:"transparent"},locale:this._locale,scalePadding:W.padding?W.padding():0};if(!J){X.barConfig={stroke:"transparent"};X.tickSize=0;X.shapeConfig={labelBounds:function t(e,n){var r=e.labelBounds,i=r.width,a=r.y;var o=O._height/2;var s=n?-o:0;return{x:s,y:a,width:i,height:o}},labelConfig:{padding:0,rotate:0,verticalAlign:function t(e){return e.id===nt[0]?"top":"bottom"}},labelRotation:false}}var Z=Rt.elem("g.d3plus-plot-test",{enter:{opacity:0},parent:this._select}),$=this._discrete==="x"&&!h?m.x2:undefined,tt=!Q?qt.extent(m.x):this._discrete==="x"&&!v?m.x:undefined,et=this._discrete==="y"&&!_?m.y2:undefined,nt=!J?qt.extent(m.y):this._discrete==="y"&&!g?m.y:undefined;if(Q){this._yTest.domain(B).height(a).maxSize(A/2).range([undefined,undefined]).scale(R.toLowerCase()).select(Z.node()).ticks(nt).width(A).config(X).config(this._yConfig).render()}var rt=this._yTest.outerBounds();var it=rt.width?rt.width+this._yTest.padding():undefined;if(i){this._y2Test.domain(q).height(a).range([undefined,undefined]).scale(N.toLowerCase()).select(Z.node()).ticks(et).width(A).config(X).config(Y).config(this._y2Config).render()}var at=this._y2Test.outerBounds();var ot=at.width?at.width+this._y2Test.padding():undefined;var st={gridConfig:{stroke:!this._discrete||this._discrete==="y"?this._xTest.gridConfig().stroke:"transparent"},locale:this._locale,scalePadding:F.padding?F.padding():0};if(!Q){st.barConfig={stroke:"transparent"};st.tickSize=0;st.shapeConfig={labelBounds:function t(e,n){var r=e.labelBounds,i=r.height,a=r.y;var o=O._width/2;var s=n?-o:0;return{x:s,y:a,width:o,height:i}},labelConfig:{padding:0,rotate:0,textAnchor:function t(e){return e.id===tt[0]?"start":"end"}},labelRotation:false}}if(J){this._xTest.domain(D).height(a).maxSize(a/2).range([undefined,undefined]).scale(L.toLowerCase()).select(Z.node()).ticks(tt).width(A).config(st).config(this._xConfig).render()}if(r){this._x2Test.domain(M).height(a).range([undefined,undefined]).scale(E.toLowerCase()).select(Z.node()).ticks($).width(A).config(st).tickSize(0).config(K).config(this._x2Config).render()}var ct=this._xTest._getRange();var ut=this._x2Test._getRange();var ft=this._x2Test.outerBounds();var dt=r?ft.height+this._x2Test.padding():0;var lt=qt.max([it,ct[0],ut[0]]);if(J){this._xTest.range([lt,undefined]).render()}var ht=Q?this._yTest.shapeConfig().labelConfig.fontSize()/2:0;var vt=qt.max([ot,A-ct[1],A-ut[1]]);var _t=this._xTest.outerBounds();var gt=_t.height+(Q?this._xTest.padding():0);this._padding.left+=lt;this._padding.right+=vt;this._padding.bottom+=gt;this._padding.top+=dt+ht;Ut(Ht(Bt.prototype),"_draw",this).call(this,e);var yt=this._margin.left+this._margin.right;var pt=this._margin.top+this._margin.bottom;var xt=[dt,a-(gt+ht+pt)];if(Q){this._yTest.domain(B).height(a).maxSize(A/2).range(xt).scale(R.toLowerCase()).select(Z.node()).ticks(nt).width(A).config(X).config(this._yConfig).render()}rt=this._yTest.outerBounds();it=rt.width?rt.width+this._yTest.padding():undefined;lt=qt.max([it,ct[0],ut[0]]);if(i){this._y2Test.config(X).domain(q).gridSize(0).height(a).range(xt).scale(N.toLowerCase()).select(Z.node()).width(A-qt.max([0,vt-ot])).title(false).config(this._y2Config).config(Y).render()}at=this._y2Test.outerBounds();ot=at.width?at.width+this._y2Test.padding():undefined;vt=qt.max([0,ot,A-ct[1],A-ut[1]]);var mt=[lt,A-(vt+yt)];var bt=Rt.elem("g.d3plus-plot-background",{parent:d,transition:l});var Ct="translate(".concat(this._margin.left,", ").concat(this._margin.top+dt+ht,")");var wt="translate(".concat(this._margin.left,", ").concat(this._margin.top+ht,")");var kt=J&&Rt.elem("g.d3plus-plot-x-axis",{parent:d,transition:l,enter:{transform:Ct},update:{transform:Ct}});var St=r&&Rt.elem("g.d3plus-plot-x2-axis",{parent:d,transition:l,enter:{transform:wt},update:{transform:wt}});var Ot=lt>it?lt-it:0;var At="translate(".concat(this._margin.left+Ot,", ").concat(this._margin.top+ht,")");var Pt=Q&&Rt.elem("g.d3plus-plot-y-axis",{parent:d,transition:l,enter:{transform:At},update:{transform:At}});var Tt="translate(-".concat(this._margin.right,", ").concat(this._margin.top+ht,")");var zt=i&&Rt.elem("g.d3plus-plot-y2-axis",{parent:d,transition:l,enter:{transform:Tt},update:{transform:Tt}});this._xAxis.domain(D).height(a-(dt+ht+pt)).maxSize(a/2).range(mt).scale(L.toLowerCase()).select(J?kt.node():undefined).ticks(tt).width(A).config(st).config(this._xConfig).render();if(r){this._x2Axis.domain(M).height(a-(gt+ht+pt)).range(mt).scale(E.toLowerCase()).select(St.node()).ticks($).width(A).config(st).config(K).config(this._x2Config).render()}F=function t(e,n){if(n==="x2"){if(O._x2Config.scale==="log"&&e===0)e=M[0]<0?-1:1;return O._x2Axis._getPosition.bind(O._x2Axis)(e)}else{if(O._xConfig.scale==="log"&&e===0)e=D[0]<0?-1:1;return O._xAxis._getPosition.bind(O._xAxis)(e)}};xt=[this._xAxis.outerBounds().y+dt,a-(gt+ht+pt)];this._yAxis.domain(B).height(a).maxSize(A/2).range(xt).scale(R.toLowerCase()).select(Q?Pt.node():undefined).ticks(nt).width(mt[mt.length-1]).config(X).config(this._yConfig).render();if(i){this._y2Axis.config(X).domain(i?q:B).gridSize(0).height(a).range(xt).scale(i?N.toLowerCase():R.toLowerCase()).select(zt.node()).width(A-qt.max([0,vt-ot])).title(false).config(this._y2Config).config(Y).render()}W=function t(e,n){if(n==="y2"){if(O._y2Config.scale==="log"&&e===0)e=q[0]<0?-1:1;return O._y2Axis._getPosition.bind(O._y2Axis)(e)-dt}else{if(O._yConfig.scale==="log"&&e===0)e=B[0]<0?-1:1;return O._yAxis._getPosition.bind(O._yAxis)(e)-dt}};(new Vt.Rect).data([{}]).select(bt.node()).x(mt[0]+(mt[1]-mt[0])/2).width(mt[1]-mt[0]).y(this._margin.top+ht+xt[0]+(xt[1]-xt[0])/2).height(xt[1]-xt[0]).config(this._backgroundConfig).render();var jt=Rt.elem("g.d3plus-plot-annotations",{parent:d,transition:l,enter:{transform:Ct},update:{transform:Ct}}).node();this._annotations.forEach(function(t){(new Vt[t.shape]).config(t).config({x:function t(e){return e.x2?F(e.x2,"x2"):F(e.x)},x0:O._discrete==="x"?function(t){return t.x2?F(t.x2,"x2"):F(t.x)}:F(m.x[0]),x1:O._discrete==="x"?null:function(t){return t.x2?F(t.x2,"x2"):F(t.x)},y:function t(e){return e.y2?W(e.y2,"y2"):W(e.y)},y0:O._discrete==="y"?function(t){return t.y2?W(t.y2,"y2"):W(t.y)}:W(m.y[1])-Dt,y1:O._discrete==="y"?null:function(t){return t.y2?W(t.y2,"y2"):W(t.y)-Dt}}).select(jt).render()});var Dt=this._xAxis.barConfig()["stroke-width"];if(Dt)Dt/=2;var Lt={duration:this._duration,label:function t(e){return O._drawLabel(e.data,e.i)},select:Rt.elem("g.d3plus-plot-shapes",{parent:d,transition:l,enter:{transform:Ct},update:{transform:Ct}}).node(),x:function t(e){return e.x2?F(e.x2,"x2"):F(e.x)},x0:this._discrete==="x"?function(t){return t.x2?F(t.x2,"x2"):F(t.x)}:F(typeof this._baseline==="number"?this._baseline:m.x[0]),x1:this._discrete==="x"?null:function(t){return t.x2?F(t.x2,"x2"):F(t.x)},y:function t(e){return e.y2?W(e.y2,"y2"):W(e.y)},y0:this._discrete==="y"?function(t){return t.y2?W(t.y2,"y2"):W(t.y)}:W(typeof this._baseline==="number"?this._baseline:m.y[1])-Dt,y1:this._discrete==="y"?null:function(t){return t.y2?W(t.y2,"y2"):W(t.y)-Dt}};if(this._stacked){var Mt=u==="x"?F:W;Lt["".concat(u)]=Lt["".concat(u,"0")]=function(t){var e=C.indexOf(t.id),n=x.indexOf(t.discrete);return e>=0?Mt(b[e][n][0]):Mt(m[u][u==="x"?0:1])};Lt["".concat(u,"1")]=function(t){var e=C.indexOf(t.id),n=x.indexOf(t.discrete);return e>=0?Mt(b[e][n][1]):Mt(m[u][u==="x"?0:1])}}var Et=Object.keys(this._on);G.forEach(function(e){var n=(new Vt[e.key]).config(Lt).data(e.values);if(e.key==="Bar"){var t;var r=O._discrete==="x"?F:W;var i=O._discrete==="x"?L:R;var a=O._discrete==="x"?D:B;var o=O._discrete==="x"?mt:xt;if(i!=="Point"&&a.length===2){t=(r(e.values[O._discrete==="x"?0:e.values.length-1][O._discrete])-r(a[0]))*2}else if(a.length>1)t=r(a[1])-r(a[0]);else t=o[o.length-1]-o[0];if(O._groupPadding<t)t-=O._groupPadding;var s=t||1;var c=Nt.nest().key(function(t){return t[O._discrete]}).key(function(t){return t.group}).entries(e.values);var u=qt.merge(c.map(function(t){return t.values.map(function(t){return t.key})}));var f=Array.from(new Set(u));if(qt.max(c.map(function(t){return t.values.length}))===1){n[O._discrete](function(t,e){return Lt[O._discrete](t,e)})}else{s=(s-O._barPadding*f.length-1)/f.length;var d=t/2-s/2;var l=Ft.scaleLinear().domain([0,f.length-1]).range([-d,d]);n[O._discrete](function(t,e){return Lt[O._discrete](t,e)+l(f.indexOf(t.group))})}n.width(s);n.height(s)}else if(e.key==="Line"){n.duration(A*1.5);if(O._confidence){var h=Object.assign({},Lt);var v=O._discrete==="x"?"y":"x";var _=O._discrete==="x"?W:F;h["".concat(v,"0")]=function(t){return _(O._confidence[0]?t.lci:t[v])};h["".concat(v,"1")]=function(t){return _(O._confidence[1]?t.hci:t[v])};var g=(new Vt.Area).config(h).data(e.values);var y=Object.assign(O._shapeConfig,O._confidenceConfig);g.config(Rt.configPrep.bind(O)(y,"shape","Area")).render();O._shapes.push(g)}}var p=Et.filter(function(t){return t.includes(".".concat(e.key))}),x=Et.filter(function(t){return!t.includes(".")}),m=Et.filter(function(t){return t.includes(".shape")});var b=function t(e){n.on(x[e],function(t){return O._on[x[e]](t.data,t.i)})};for(var C=0;C<x.length;C++){b(C)}var w=function t(e){n.on(m[e],function(t){return O._on[m[e]](t.data,t.i)})};for(var C=0;C<m.length;C++){w(C)}var k=function t(e){n.on(p[e],function(t){return O._on[p[e]](t.data,t.i)})};for(var C=0;C<p.length;C++){k(C)}var S=Rt.configPrep.bind(O)(O._shapeConfig,"shape",e.key);if(O._shapeConfig.duration===undefined)delete S.duration;n.config(S).render();O._shapes.push(n)});return this}},{key:"annotations",value:function t(e){return arguments.length?(this._annotations=e instanceof Array?e:[e],this):this._annotations}},{key:"backgroundConfig",value:function t(e){return arguments.length?(this._backgroundConfig=Rt.assign(this._backgroundConfig,e),this):this._backgroundConfig}},{key:"barPadding",value:function t(e){return arguments.length?(this._barPadding=e,this):this._barPadding}},{key:"baseline",value:function t(e){return arguments.length?(this._baseline=e,this):this._baseline}},{key:"confidence",value:function t(e){if(arguments.length&&e instanceof Array){this._confidence=[];var n=e[0];this._confidence[0]=typeof n==="function"||!n?n:Rt.accessor(n);var r=e[1];this._confidence[1]=typeof r==="function"||!r?r:Rt.accessor(r);return this}else return this._confidence}},{key:"confidenceConfig",value:function t(e){return arguments.length?(this._confidenceConfig=Rt.assign(this._confidenceConfig,e),this):this._confidenceConfig}},{key:"discrete",value:function t(e){return arguments.length?(this._discrete=e,this):this._discrete}},{key:"discreteCutoff",value:function t(e){return arguments.length?(this._discreteCutoff=e,this):this._discreteCutoff}},{key:"groupPadding",value:function t(e){return arguments.length?(this._groupPadding=e,this):this._groupPadding}},{key:"shapeSort",value:function t(e){return arguments.length?(this._shapeSort=e,this):this._shapeSort}},{key:"size",value:function t(e){return arguments.length?(this._size=typeof e==="function"||!e?e:Rt.accessor(e),this):this._size}},{key:"sizeMax",value:function t(e){return arguments.length?(this._sizeMax=e,this):this._sizeMax}},{key:"sizeMin",value:function t(e){return arguments.length?(this._sizeMin=e,this):this._sizeMin}},{key:"sizeScale",value:function t(e){return arguments.length?(this._sizeScale=e,this):this._sizeScale}},{key:"stacked",value:function t(e){return arguments.length?(this._stacked=e,this):this._stacked}},{key:"stackOffset",value:function t(e){return arguments.length?(this._stackOffset=typeof e==="function"?e:It["stackOffset".concat(e.charAt(0).toUpperCase()+e.slice(1))],this):this._stackOffset}},{key:"stackOrder",value:function t(e){if(arguments.length){if(typeof e==="string")this._stackOrder=e==="ascending"?y:e==="descending"?p:It["stackOrder".concat(e.charAt(0).toUpperCase()+e.slice(1))];else this._stackOrder=e;return this}else return this._stackOrder}},{key:"x",value:function t(e){if(arguments.length){if(typeof e==="function")this._x=e;else{this._x=Rt.accessor(e);if(!this._aggs[e]&&this._discrete==="x"){this._aggs[e]=function(t){var e=Array.from(new Set(t));return e.length===1?e[0]:e}}}return this}else return this._x}},{key:"x2",value:function t(e){if(arguments.length){if(typeof e==="function")this._x2=e;else{this._x2=Rt.accessor(e);if(!this._aggs[e]&&this._discrete==="x"){this._aggs[e]=function(t){var e=Array.from(new Set(t));return e.length===1?e[0]:e}}}return this}else return this._x2}},{key:"xConfig",value:function t(e){return arguments.length?(this._xConfig=Rt.assign(this._xConfig,e),this):this._xConfig}},{key:"xCutoff",value:function t(e){return arguments.length?(this._xCutoff=e,this):this._xCutoff}},{key:"x2Config",value:function t(e){return arguments.length?(this._x2Config=Rt.assign(this._x2Config,e),this):this._x2Config}},{key:"xDomain",value:function t(e){return arguments.length?(this._xDomain=e,this):this._xDomain}},{key:"x2Domain",value:function t(e){return arguments.length?(this._x2Domain=e,this):this._x2Domain}},{key:"xSort",value:function t(e){return arguments.length?(this._xSort=e,this):this._xSort}},{key:"x2Sort",value:function t(e){return arguments.length?(this._x2Sort=e,this):this._x2Sort}},{key:"y",value:function t(e){if(arguments.length){if(typeof e==="function")this._y=e;else{this._y=Rt.accessor(e);if(!this._aggs[e]&&this._discrete==="y"){this._aggs[e]=function(t){var e=Array.from(new Set(t));return e.length===1?e[0]:e}}}return this}else return this._y}},{key:"y2",value:function t(e){if(arguments.length){if(typeof e==="function")this._y2=e;else{this._y2=Rt.accessor(e);if(!this._aggs[e]&&this._discrete==="y2"){this._aggs[e]=function(t){var e=Array.from(new Set(t));return e.length===1?e[0]:e}}}return this}else return this._y2}},{key:"yConfig",value:function t(e){if(arguments.length){if(e.domain)e.domain=e.domain.slice().reverse();this._yConfig=Rt.assign(this._yConfig,e);return this}return this._yConfig}},{key:"yCutoff",value:function t(e){return arguments.length?(this._yCutoff=e,this):this._yCutoff}},{key:"y2Config",value:function t(e){return arguments.length?(this._y2Config=Rt.assign(this._y2Config,e),this):this._y2Config}},{key:"yDomain",value:function t(e){return arguments.length?(this._yDomain=e,this):this._yDomain}},{key:"y2Domain",value:function t(e){return arguments.length?(this._y2Domain=e,this):this._y2Domain}},{key:"ySort",value:function t(e){return arguments.length?(this._ySort=e,this):this._ySort}},{key:"y2Sort",value:function t(e){return arguments.length?(this._y2Sort=e,this):this._y2Sort}}]);return Bt}(e.Viz);var w=function(t){o(e,t);function e(){var t;n(this,e);t=u(this,Ht(e).call(this));t._baseline=0;t._discrete="x";t._shape=Rt.constant("Area");t.x("x");return t}return e}(C);var k=function(t){o(e,t);function e(){var t;n(this,e);t=u(this,Ht(e).call(this));t._baseline=0;t._discrete="x";t._shape=Rt.constant("Bar");t.x("x");return t}return e}(C);var S=function(t){o(e,t);function e(){var i;n(this,e);i=u(this,Ht(e).call(this));i._discrete="x";i._shape=Rt.constant("Box");i.x("x");i._tooltipConfig=Rt.assign(i._tooltipConfig,{title:function t(e,n){if(!e)return"";while(e.__d3plus__&&e.data){e=e.data;n=e.i}if(i._label)return i._label(e,n);var r=i._ids(e,n).slice(0,i._drawDepth);return r[r.length-1]}});return i}return e}(C);var O=function(t){o(e,t);function e(){var o;n(this,e);o=u(this,Ht(e).call(this));o._discrete="x";o._shape=Rt.constant("Line");o.x("x");o.y2(function(t){return o._y(t)});o.yConfig({tickFormat:function t(e){var n=o._formattedData;var r=n[0].x instanceof Date?n[0].x.getTime():n[0].x;var i=n.filter(function(t){return(t.x instanceof Date?t.x.getTime():t.x)===r});var a=i.find(function(t){return t.y===e});return a?o._drawLabel(a,a.i):""}});o.y2Config({tickFormat:function t(e){var n=o._formattedData;var r=n[n.length-1].x instanceof Date?n[n.length-1].x.getTime():n[n.length-1].x;var i=n.filter(function(t){return(t.x instanceof Date?t.x.getTime():t.x)===r});var a=i.find(function(t){return t.y===e});return a?o._drawLabel(a,a.i):""}});o.ySort(function(t,e){return o._y(e)-o._y(t)});o.y2Sort(function(t,e){return o._y(e)-o._y(t)});return o}return e}(C);var A=function(t){o(e,t);function e(){var t;n(this,e);t=u(this,Ht(e).call(this));t._discrete="x";t._shape=Rt.constant("Line");t.x("x");return t}return e}(C);var P=Math.PI*2;var T=function(t){o(x,t);function x(){var t;n(this,x);t=u(this,Ht(x).call(this));t._axisConfig={shapeConfig:{fill:Rt.constant("none"),labelConfig:{fontColor:"#000",padding:0,textAnchor:function t(e){return e.textAnchor},rotateAnchor:function t(e){return e.data.rotateAnchor},verticalAlign:"middle"},stroke:"#ccc",strokeWidth:Rt.constant(1)}};t._discrete="metric";t._levels=6;t._metric=Rt.accessor("metric");t._outerPadding=100;t._shape=Rt.constant("Path");t._value=Rt.accessor("value");return t}a(x,[{key:"_draw",value:function t(e){var h=this;Ut(Ht(x.prototype),"_draw",this).call(this,e);var u=this._height-this._margin.top-this._margin.bottom,f=this._width-this._margin.left-this._margin.right;var v=qt.min([u,f])/2-this._outerPadding,n="translate(".concat(f/2,", ").concat(u/2,")");var r=Nt.nest().key(this._metric).entries(this._filteredData),i=Nt.nest().key(this._id).key(this._metric).entries(this._filteredData);var a=qt.max(i.map(function(t){return t.values.map(function(t){return qt.sum(t.values,function(t,e){return h._value(t,e)})})}).flat());var o=Array.from(Array(this._levels).keys()).map(function(t){return{id:t,r:v*((t+1)/h._levels)}});var s=Rt.configPrep.bind(this)(this._axisConfig.shapeConfig,"shape","Circle");delete s.label;(new Vt.Circle).data(o).select(Rt.elem("g.d3plus-Radar-radial-circles",{parent:this._select,enter:{transform:n},update:{transform:n}}).node()).config(s).render();var _=r.length;var c=r.map(function(t,e){var n=h._outerPadding;var r=h._shapeConfig.labelConfig.fontSize&&h._shapeConfig.labelConfig.fontSize(t,e)||11;var i=r*1.4;var a=i*2;var o=10,s=parseInt(360-360/_*e/90,10)%4+1,c=P/_*e;var u=360/_*e;var f="start";var d=o;if(s===2||s===3){d=-n-o;f="end";u+=180}var l={x:d,y:-a/2,width:n,height:a};return{__d3plus__:true,data:Rt.merge(t.values),i:e,id:t.key,angle:u,textAnchor:f,labelBounds:l,rotateAnchor:[-d,a/2],x:v*Math.cos(c),y:v*Math.sin(c)}}).sort(function(t,e){return t.key-e.key});(new Vt.Rect).data(c).rotate(function(t){return t.angle}).width(0).height(0).x(function(t){return t.x}).y(function(t){return t.y}).label(function(t){return t.id}).labelBounds(function(t){return t.labelBounds}).labelConfig(this._axisConfig.shapeConfig.labelConfig).select(Rt.elem("g.d3plus-Radar-text",{parent:this._select,enter:{transform:n},update:{transform:n}}).node()).render();(new Vt.Path).data(c).d(function(t){return"M".concat(0,",",0," ",-t.x,",").concat(-t.y)}).select(Rt.elem("g.d3plus-Radar-axis",{parent:this._select,enter:{transform:n},update:{transform:n}}).node()).config(Rt.configPrep.bind(this)(this._axisConfig.shapeConfig,"shape","Path")).render();var d=i.map(function(t){var e=t.values.map(function(t,e){var n=qt.sum(t.values,function(t,e){return h._value(t,e)});var r=n/a*v,i=P/_*e;return{x:r*Math.cos(i),y:r*Math.sin(i)}});var n="M ".concat(e[0].x," ").concat(e[0].y," ").concat(e.map(function(t){return"L ".concat(t.x," ").concat(t.y)}).join(" ")," L ").concat(e[0].x," ").concat(e[0].y);return{arr:t.values.map(function(t){return Rt.merge(t.values)}),id:t.key,points:e,d:n,__d3plus__:true,data:Rt.merge(t.values.map(function(t){return Rt.merge(t.values)}))}});var l=Rt.configPrep.bind(this)(this._shapeConfig,"shape","Path");var g=Object.keys(l.on);l.on={};var y=function t(e){var c=g[e];l.on[c]=function(t,e){var n=t.points.map(function(t){return t.x+f/2});var r=t.points.map(function(t){return t.y+u/2});var i=m.mouse(h._select.node());var a=n.map(function(t){return Math.abs(t-i[0])});var o=r.map(function(t){return Math.abs(t-i[1])});var s=a.map(function(t,e){return t+o[e]});h._on[c].bind(h)(t.arr[s.indexOf(qt.min(s))],e)}};for(var p=0;p<g.length;p++){y(p)}this._shapes.push((new Vt.Path).data(d).d(function(t){return t.d}).select(Rt.elem("g.d3plus-Radar-items",{parent:this._select,enter:{transform:n},update:{transform:n}}).node()).config(l).render());return this}},{key:"axisConfig",value:function t(e){return arguments.length?(this._axisConfig=Rt.assign(this._axisConfig,e),this):this._axisConfig}},{key:"metric",value:function t(e){return arguments.length?(this._metric=typeof e==="function"?e:Rt.accessor(e),this):this._metric}},{key:"outerPadding",value:function t(e){return arguments.length?(this._outerPadding=e,this):this._outerPadding}},{key:"value",value:function t(e){return arguments.length?(this._value=typeof e==="function"?e:Rt.accessor(e),this):this._value}}]);return x}(e.Viz);var z=function(t){o(e,t);function e(){var t;n(this,e);t=u(this,Ht(e).call(this));t._stacked=true;return t}return e}(w);t.AreaPlot=w;t.BarChart=k;t.BoxWhisker=S;t.BumpChart=O;t.LinePlot=A;t.Plot=C;t.Radar=T;t.StackedArea=z;Object.defineProperty(t,"__esModule",{value:true})});