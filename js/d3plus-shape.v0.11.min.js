/*
  d3plus-shape v0.11.1
  Fancy SVG shapes for visualizations
  Copyright (c) 2016 D3plus - https://d3plus.org
  @license MIT
*/
(function(t,i){typeof exports==="object"&&typeof module!=="undefined"?i(exports,require("d3-selection"),require("d3-transition"),require("d3plus-common"),require("d3-array"),require("d3-color"),require("d3plus-color"),require("d3plus-text"),require("d3-collection"),require("d3-interpolate-path"),require("d3-shape")):typeof define==="function"&&define.amd?define("d3plus-shape",["exports","d3-selection","d3-transition","d3plus-common","d3-array","d3-color","d3plus-color","d3plus-text","d3-collection","d3-interpolate-path","d3-shape"],i):i(t.d3plus=t.d3plus||{},t.d3Selection,t.d3Transition,t.d3plusCommon,t.d3Array,t.d3Color,t.d3plusColor,t.d3plusText,t.d3Collection,t.d3InterpolatePath,t.paths)})(this,function(t,i,e,n,r,s,o,a,h,u,_){"use strict";var c=function(t,i){if(!(t instanceof Array)){t=[t.x,t.y]}if(!(i instanceof Array)){i=[i.x,i.y]}var e=Math.abs(t[0]-i[0]);var n=Math.abs(t[1]-i[1]);return Math.sqrt(e*e+n*n)};var p=function t(){this._duration=600;this._height=n.accessor("height");this._id=n.accessor("id");this._pointerEvents=n.constant("auto");this._select;this._url=n.accessor("url");this._width=n.accessor("width");this._x=n.accessor("x",0);this._y=n.accessor("y",0)};p.prototype.render=function t(n){var r=this;if(this._select===void 0){this.select(i.select("body").append("svg").style("width",window.innerWidth+"px").style("height",window.innerHeight+"px").style("display","block").node())}var s=this._select.selectAll(".d3plus-Image").data(this._data,this._id);var o=s.enter().append("image").attr("class","d3plus-Image").attr("opacity",0).attr("width",0).attr("height",0).attr("x",function(t,i){return r._x(t,i)+r._width(t,i)/2}).attr("y",function(t,i){return r._y(t,i)+r._height(t,i)/2});var a=e.transition().duration(this._duration),h=this,u=o.merge(s);u.attr("xlink:href",this._url).style("pointer-events",this._pointerEvents).transition(a).attr("opacity",1).attr("width",function(t,i){return r._width(t,i)}).attr("height",function(t,i){return r._height(t,i)}).attr("x",function(t,i){return r._x(t,i)}).attr("y",function(t,i){return r._y(t,i)}).each(function(t,e){var n=i.select(this),r=h._url(t,e);var s=r.indexOf("http://")===0||r.indexOf("https://")===0;if(!s||r.indexOf(window.location.hostname)===0){var o=new p;o.src=r;o.crossOrigin="Anonymous";o.onload=function(){var t=document.createElement("canvas");t.width=this.width;t.height=this.height;var i=t.getContext("2d");i.drawImage(this,0,0);n.attr("xlink:href",t.toDataURL("image/png"))}}});s.exit().transition(a).attr("width",function(t,i){return r._width(t,i)}).attr("height",function(t,i){return r._height(t,i)}).attr("x",function(t,i){return r._x(t,i)}).attr("y",function(t,i){return r._y(t,i)}).attr("opacity",0).remove();if(n){setTimeout(n,this._duration+100)}return this};p.prototype.data=function t(i){return arguments.length?(this._data=i,this):this._data};p.prototype.duration=function t(i){return arguments.length?(this._duration=i,this):this._duration};p.prototype.height=function t(i){return arguments.length?(this._height=typeof i==="function"?i:n.constant(i),this):this._height};p.prototype.id=function t(i){return arguments.length?(this._id=i,this):this._id};p.prototype.pointerEvents=function t(i){return arguments.length?(this._pointerEvents=typeof i==="function"?i:n.constant(i),this):this._pointerEvents};p.prototype.select=function t(e){return arguments.length?(this._select=i.select(e),this):this._select};p.prototype.url=function t(i){return arguments.length?(this._url=i,this):this._url};p.prototype.width=function t(i){return arguments.length?(this._width=typeof i==="function"?i:n.constant(i),this):this._width};p.prototype.x=function t(i){return arguments.length?(this._x=typeof i==="function"?i:n.constant(i),this):this._x};p.prototype.y=function t(i){return arguments.length?(this._y=typeof i==="function"?i:n.constant(i),this):this._y};var l=function(t){function h(i){var e=this;if(i===void 0)i="g";t.call(this);this._activeOpacity=.75;this._activeStyle={stroke:function(t,i){return s.color(e._stroke(t,i)).darker(2)},"stroke-width":function(t,i){var n=e._strokeWidth(t,i);return n?n*2:1}};this._backgroundImage=n.constant(false);this._data=[];this._duration=600;this._fill=n.constant("black");this._fontColor=function(t,i){return o.contrast(e._fill(t,i))};this._fontFamily=n.constant("Verdana");this._fontResize=n.constant(false);this._fontSize=n.constant(12);this._hoverOpacity=.5;this._id=function(t,i){return t.id!==void 0?t.id:i};this._label=n.constant(false);this._labelPadding=n.constant(5);this._name="Shape";this._opacity=n.constant(1);this._scale=n.constant(1);this._shapeRendering=n.constant("geometricPrecision");this._stroke=function(t,i){return s.color(e._fill(t,i)).darker(1)};this._strokeWidth=n.constant(0);this._tagName=i;this._textAnchor=n.constant("start");this._vectorEffect=n.constant("non-scaling-stroke");this._verticalAlign=n.constant("top");this._x=n.accessor("x",0);this._y=n.accessor("y",0)}if(t)h.__proto__=t;h.prototype=Object.create(t&&t.prototype);h.prototype.constructor=h;h.prototype._aes=function t(){return{}};h.prototype._applyEvents=function t(e){var n=this;var s=Object.keys(this._on);var o=function(t){e.on(s[t],function(e,o){if(!n._on[s[t]]){return}if(e.i!==void 0){o=e.i}if(e.nested&&e.values){var a=i.mouse(n._select.node()),h=e.values.map(function(t){return c(a,[n._x(t,o),n._y(t,o)])});e=e.values[h.indexOf(r.min(h))]}n._on[s[t]].bind(n)(e,o)})};for(var a=0;a<s.length;a++)o(a)};h.prototype._applyActive=function t(i){var e=this;var r=this;if(i.size()&&i.node().tagName==="g"){i=i.selectAll("*")}function s(t,i){return typeof this!=="function"?this:t.nested&&t.key&&t.values?this(t.values[0],r._data.indexOf(t.values[0])):this(t,i)}var o={};for(var a in this._activeStyle){if({}.hasOwnProperty.call(e._activeStyle,a)){o[a]=s.bind(e._activeStyle[a])}}i.transition().duration(0).call(n.attrize,o)};h.prototype._applyStyle=function t(i){var e=this;if(i.size()&&i.node().tagName==="g"){i=i.selectAll("*")}function n(t,i){return typeof this!=="function"?this:t.nested&&t.key&&t.values?this(t.values[0],e._data.indexOf(t.values[0])):this(t,i)}i.attr("fill",n.bind(this._fill)).attr("stroke",n.bind(this._stroke)).attr("stroke-width",n.bind(this._strokeWidth)).attr("vector-effect",n.bind(this._vectorEffect))};h.prototype._applyTransform=function t(i){var e=this;i.attr("transform",function(t,i){return"\n        translate("+(t.__d3plusShape__?t.translate?t.translate:e._x(t.data,t.i)+","+e._y(t.data,t.i):e._x(t,i)+","+e._y(t,i))+")\n        scale("+(t.__d3plusShape__?t.scale||e._scale(t.data,t.i):e._scale(t,i))+")"})};h.prototype._nestWrapper=function t(i){return function(t,e){return i(t.__d3plusShape__?t.data:t,t.__d3plusShape__?t.i:e)}};h.prototype._renderImage=function t(){var i=this;var e=[];this._update.merge(this._enter).data().forEach(function(t,n){var r=i._aes(t,n);if(r.r||r.width&&r.height){var s=t;if(t.nested&&t.key&&t.values){s=t.values[0];n=i._data.indexOf(s)}var o=r.r?r.r*2:r.height,a=i._backgroundImage(s,n),h=r.r?r.r*2:r.width;if(a){var u=s.__d3plusShape__?s.translate?s.translate[0]:i._x(s.data,s.i):i._x(s,n),_=s.__d3plusShape__?s.translate?s.translate[1]:i._y(s.data,s.i):i._y(s,n);if(r.x){u+=r.x}if(r.y){_+=r.y}if(s.__d3plusShape__){s=s.data;n=s.i}e.push({__d3plus__:true,data:s,height:o,i:n,id:i._id(s,n),url:a,width:h,x:u+-h/2,y:_+-o/2})}}});return(new p).data(e).duration(this._duration).pointerEvents("none").select(n.elem("g.d3plus-"+this._name+"-image",{parent:this._group,update:{opacity:this._active?this._activeOpacity:1}}).node()).render()};h.prototype._renderLabels=function t(){var i=this;var e=[];this._update.merge(this._enter).data().forEach(function(t,n){var r=t;if(t.nested&&t.key&&t.values){r=t.values[0];n=i._data.indexOf(r)}var s=i._label(r,n);if(i._labelBounds&&s!==false&&s!==void 0){var o=i._aes(t,n),a=i._labelBounds(r,n,o);if(a){if(s.constructor!==Array){s=[s]}var h=r.__d3plusShape__?r.translate?r.translate[0]:i._x(r.data,r.i):i._x(r,n),u=r.__d3plusShape__?r.translate?r.translate[1]:i._y(r.data,r.i):i._y(r,n);if(o.x){h+=o.x}if(o.y){u+=o.y}if(r.__d3plusShape__){r=r.data;n=r.i}var _=i._fontColor(r,n),c=i._fontFamily(r,n),p=i._fontResize(r,n),l=i._fontSize(r,n),d=i._lineHeight(r,n),f=i._labelPadding(r,n),y=i._textAnchor(r,n),g=i._verticalAlign(r,n);for(var v=0;v<s.length;v++){var x=a.constructor===Array?a[v]:Object.assign({},a),m=f.constructor===Array?f[v]:f;e.push(Object.assign(x,{__d3plusShape__:true,data:r,fC:_.constructor===Array?_[v]:_,fF:c.constructor===Array?c[v]:c,fR:p.constructor===Array?p[v]:p,fS:l.constructor===Array?l[v]:l,height:x.height-m*2,i:n,id:i._id(r,n)+"_"+v,lH:d.constructor===Array?d[v]:d,tA:y.constructor===Array?y[v]:y,text:s[v],vA:g.constructor===Array?g[v]:g,width:x.width-m*2,x:h+x.x+m,y:u+x.y+m}))}}}});return(new a.TextBox).data(e).delay(this._duration/2).duration(this._duration).fontColor(function(t){return t.fC}).fontFamily(function(t){return t.fF}).fontResize(function(t){return t.fR}).fontSize(function(t){return t.fS}).lineHeight(function(t){return t.lH}).pointerEvents("none").textAnchor(function(t){return t.tA}).verticalAlign(function(t){return t.vA}).select(n.elem("g.d3plus-"+this._name+"-text",{parent:this._group,update:{opacity:this._active?this._activeOpacity:1}}).node()).render()};h.prototype.render=function t(r){var s=this;if(this._select===void 0){this.select(i.select("body").append("svg").style("width",window.innerWidth+"px").style("height",window.innerHeight+"px").style("display","block").node())}if(this._lineHeight===void 0){this.lineHeight(function(t,i){return s._fontSize(t,i)*1.1})}this._transition=e.transition().duration(this._duration);var o=this._data,h=this._id;if(this._dataFilter){o=this._dataFilter(o);if(o.key){h=o.key}}if(this._sort){o=o.sort(function(t,i){return s._sort(t.__d3plusShape__?t.data:t,i.__d3plusShape__?i.data:i)})}i.selectAll("g.d3plus-"+this._name+"-hover > *, g.d3plus-"+this._name+"-active > *").each(function(t){if(t&&t.parentNode){t.parentNode.appendChild(this)}else{this.parentNode.removeChild(this)}});this._group=n.elem("g.d3plus-"+this._name+"-group",{parent:this._select});var u=this._update=n.elem("g.d3plus-"+this._name+"-shape",{parent:this._group,update:{opacity:this._active?this._activeOpacity:1}}).selectAll(".d3plus-"+this._name).data(o,h);u.order().transition(this._transition).call(this._applyTransform.bind(this));var _=this._enter=u.enter().append(this._tagName).attr("class",function(t,i){return"d3plus-Shape d3plus-"+s._name+" d3plus-id-"+a.strip(s._nestWrapper(s._id)(t,i))}).call(this._applyTransform.bind(this)).attr("opacity",this._nestWrapper(this._opacity));var c=_.merge(u);c.attr("shape-rendering",this._nestWrapper(this._shapeRendering)).attr("pointer-events","none").transition(this._transition).attr("opacity",this._nestWrapper(this._opacity)).transition().attr("pointer-events","all");var p=this._exit=u.exit();p.transition().delay(this._duration).remove();this._renderImage();this._renderLabels();this._hoverGroup=n.elem("g.d3plus-"+this._name+"-hover",{parent:this._group});this._activeGroup=n.elem("g.d3plus-"+this._name+"-active",{parent:this._group});var l=this;var d=this._group.selectAll(".d3plus-HitArea").data(this._hitArea?o:[],h);d.order().transition(this._transition).call(this._applyTransform.bind(this));var f=d.enter().append("rect").attr("class",function(t,i){return"d3plus-HitArea d3plus-id-"+a.strip(s._nestWrapper(s._id)(t,i))}).attr("fill","transparent").call(this._applyTransform.bind(this));var y=d.merge(f).each(function(t){var e=l._hitArea(t,l._data.indexOf(t),l._aes(t,l._data.indexOf(t)));return e?i.select(this).call(n.attrize,e):i.select(this).remove()});d.exit().remove();this._applyEvents(this._hitArea?y:c);this.active(this._active);if(r){setTimeout(r,this._duration+100)}return this};h.prototype.active=function t(e){if(!arguments.length||e===void 0){return this._active}this._active=e;var n=this;this._group.selectAll(".d3plus-Shape, .d3plus-Image, .d3plus-textBox").each(function(t,r){if(!t.parentNode){t.parentNode=this.parentNode}var s=t.parentNode;if(this.tagName==="text"){t=t.data}if(t.__d3plusShape__||t.__d3plus__){r=t.i;t=t.data}else{r=n._data.indexOf(t)}var o=!e||typeof e!=="function"||!e(t,r)?s:n._activeGroup.node();if(o!==this.parentNode){o.appendChild(this);if(this.className.baseVal.includes("d3plus-Shape")){if(s===o){i.select(this).call(n._applyStyle.bind(n))}else{i.select(this).call(n._applyActive.bind(n))}}}});this._group.selectAll("g.d3plus-"+this._name+"-shape, g.d3plus-"+this._name+"-image, g.d3plus-"+this._name+"-text").attr("opacity",this._hover?this._hoverOpacity:this._active?this._activeOpacity:1);return this};h.prototype.activeOpacity=function t(i){return arguments.length?(this._activeOpacity=i,this):this._activeOpacity};h.prototype.backgroundImage=function t(i){return arguments.length?(this._backgroundImage=typeof i==="function"?i:n.constant(i),this):this._backgroundImage};h.prototype.data=function t(i){return arguments.length?(this._data=i,this):this._data};h.prototype.duration=function t(i){return arguments.length?(this._duration=i,this):this._duration};h.prototype.fill=function t(i){return arguments.length?(this._fill=typeof i==="function"?i:n.constant(i),this):this._fill};h.prototype.fontColor=function t(i){return arguments.length?(this._fontColor=typeof i==="function"?i:n.constant(i),this):this._fontColor};h.prototype.fontFamily=function t(i){return arguments.length?(this._fontFamily=typeof i==="function"?i:n.constant(i),this):this._fontFamily};h.prototype.fontResize=function t(i){return arguments.length?(this._fontResize=typeof i==="function"?i:n.constant(i),this):this._fontResize};h.prototype.fontSize=function t(i){return arguments.length?(this._fontSize=typeof i==="function"?i:n.constant(i),this):this._fontSize};h.prototype.hover=function t(i){if(!arguments.length||i===void 0){return this._hover}this._hover=i;var e=this;this._group.selectAll("g.d3plus-"+this._name+"-shape, g.d3plus-"+this._name+"-image, g.d3plus-"+this._name+"-text, g.d3plus-"+this._name+"-hover").selectAll(".d3plus-Shape, .d3plus-Image, .d3plus-textBox").each(function(t,n){if(!t.parentNode){t.parentNode=this.parentNode}var r=t.parentNode;if(this.tagName==="text"){t=t.data}if(t.__d3plusShape__||t.__d3plus__){n=t.i;t=t.data}else{n=e._data.indexOf(t)}var s=!i||typeof i!=="function"||!i(t,n)?r:e._hoverGroup.node();if(s!==this.parentNode){s.appendChild(this)}});this._group.selectAll("g.d3plus-"+this._name+"-shape, g.d3plus-"+this._name+"-image, g.d3plus-"+this._name+"-text").attr("opacity",this._hover?this._hoverOpacity:this._active?this._activeOpacity:1);return this};h.prototype.hoverOpacity=function t(i){return arguments.length?(this._hoverOpacity=i,this):this._hoverOpacity};h.prototype.hitArea=function t(i){return arguments.length?(this._hitArea=typeof i==="function"?i:n.constant(i),this):this._hitArea};h.prototype.id=function t(i){return arguments.length?(this._id=i,this):this._id};h.prototype.label=function t(i){return arguments.length?(this._label=typeof i==="function"?i:n.constant(i),this):this._label};h.prototype.labelBounds=function t(i){return arguments.length?(this._labelBounds=typeof i==="function"?i:n.constant(i),this):this._labelBounds};h.prototype.labelPadding=function t(i){return arguments.length?(this._labelPadding=typeof i==="function"?i:n.constant(i),this):this._labelPadding};h.prototype.lineHeight=function t(i){return arguments.length?(this._lineHeight=typeof i==="function"?i:n.constant(i),this):this._lineHeight};h.prototype.opacity=function t(i){return arguments.length?(this._opacity=typeof i==="function"?i:n.constant(i),this):this._opacity};h.prototype.scale=function t(i){return arguments.length?(this._scale=typeof i==="function"?i:n.constant(i),this):this._scale};h.prototype.select=function t(e){return arguments.length?(this._select=i.select(e),this):this._select};h.prototype.shapeRendering=function t(i){return arguments.length?(this._shapeRendering=typeof i==="function"?i:n.constant(i),this):this._shapeRendering};h.prototype.sort=function t(i){return arguments.length?(this._sort=i,this):this._sort};h.prototype.stroke=function t(i){return arguments.length?(this._stroke=typeof i==="function"?i:n.constant(i),this):this._stroke};h.prototype.strokeWidth=function t(i){return arguments.length?(this._strokeWidth=typeof i==="function"?i:n.constant(i),this):this._strokeWidth};h.prototype.textAnchor=function t(i){return arguments.length?(this._textAnchor=typeof i==="function"?i:n.constant(i),this):this._textAnchor};h.prototype.vectorEffect=function t(i){return arguments.length?(this._vectorEffect=typeof i==="function"?i:n.constant(i),this):this._vectorEffect};h.prototype.verticalAlign=function t(i){return arguments.length?(this._verticalAlign=typeof i==="function"?i:n.constant(i),this):this._verticalAlign};h.prototype.x=function t(i){return arguments.length?(this._x=typeof i==="function"?i:n.constant(i),this):this._x};h.prototype.y=function t(i){return arguments.length?(this._y=typeof i==="function"?i:n.constant(i),this):this._y};return h}(n.BaseClass);var d=function(t){function e(){t.call(this);this._curve="linear";this._defined=function(){return true};this._name="Area";this._x=n.accessor("x");this._x0=n.accessor("x");this._x1=null;this._y=n.constant(0);this._y0=n.constant(0);this._y1=n.accessor("y")}if(t)e.__proto__=t;e.prototype=Object.create(t&&t.prototype);e.prototype.constructor=e;e.prototype._dataFilter=function t(i){var e=this;var s=h.nest().key(this._id).entries(i).map(function(t){t.data=n.merge(t.values);t.i=i.indexOf(t.values[0]);var s=r.extent(t.values.map(e._x).concat(t.values.map(e._x0)).concat(e._x1?t.values.map(e._x1):[]));t.xR=s;t.width=s[1]-s[0];t.x=s[0]+t.width/2;var o=r.extent(t.values.map(e._y).concat(t.values.map(e._y0)).concat(e._y1?t.values.map(e._y1):[]));t.yR=o;t.height=o[1]-o[0];t.y=o[0]+t.height/2;t.nested=true;t.translate=[t.x,t.y];t.__d3plusShape__=true;return t});s.key=function(t){return t.key};return s};e.prototype.render=function e(n){t.prototype.render.call(this,n);var r=this._path=_.area().defined(this._defined).curve(_["curve"+this._curve.charAt(0).toUpperCase()+this._curve.slice(1)]).x(this._x).x0(this._x0).x1(this._x1).y(this._y).y0(this._y0).y1(this._y1);var s=_.area().defined(function(t){return t}).curve(_["curve"+this._curve.charAt(0).toUpperCase()+this._curve.slice(1)]).x(this._x).x0(this._x0).x1(this._x1).y(this._y).y0(this._y0).y1(this._y1);this._enter.append("path").attr("transform",function(t){return"translate("+(-t.xR[0]-t.width/2)+", "+(-t.yR[0]-t.height/2)+")"}).attr("d",function(t){return r(t.values)}).call(this._applyStyle.bind(this));this._update.select("path").transition(this._transition).attr("transform",function(t){return"translate("+(-t.xR[0]-t.width/2)+", "+(-t.yR[0]-t.height/2)+")"}).attrTween("d",function(t){return u.interpolatePath(i.select(this).attr("d"),r(t.values))}).call(this._applyStyle.bind(this));this._exit.select("path").transition(this._transition).attrTween("d",function(t){return u.interpolatePath(i.select(this).attr("d"),s(t.values))});return this};e.prototype._aes=function t(i,e){var n=this;return{points:i.values.map(function(t){return[n._x(t,e),n._y(t,e)]})}};e.prototype.curve=function t(i){return arguments.length?(this._curve=i,this):this._curve};e.prototype.defined=function t(i){return arguments.length?(this._defined=i,this):this._defined};e.prototype.x0=function t(i){if(!arguments.length){return this._x0}this._x0=typeof i==="function"?i:n.constant(i);this._x=this._x0;return this};e.prototype.x1=function t(i){return arguments.length?(this._x1=typeof i==="function"||i===null?i:n.constant(i),this):this._x1};e.prototype.y0=function t(i){if(!arguments.length){return this._y0}this._y0=typeof i==="function"?i:n.constant(i);this._y=this._y0;return this};e.prototype.y1=function t(i){return arguments.length?(this._y1=typeof i==="function"||i===null?i:n.constant(i),this):this._y1};return e}(l);var f=function(t){function i(){t.call(this,"rect");this._name="Bar";this._height=n.constant(10);this._labelBounds=function(t,i,e){return{width:e.width,height:e.height,x:-e.width/2,y:-e.height/2}};this._width=n.constant(10);this._x=n.accessor("x");this._x0=n.accessor("x");this._x1=null;this._y=n.constant(0);this._y0=n.constant(0);this._y1=n.accessor("y")}if(t)i.__proto__=t;i.prototype=Object.create(t&&t.prototype);i.prototype.constructor=i;i.prototype.render=function i(e){var n=this;t.prototype.render.call(this,e);this._enter.attr("width",function(t,i){return n._x1===null?n._getWidth(t,i):0}).attr("height",function(t,i){return n._x1!==null?n._getHeight(t,i):0}).attr("x",function(t,i){return n._x1===null?-n._getWidth(t,i)/2:0}).attr("y",function(t,i){return n._x1!==null?-n._getHeight(t,i)/2:0}).call(this._applyStyle.bind(this)).transition(this._transition).call(this._applyPosition.bind(this));this._update.transition(this._transition).call(this._applyStyle.bind(this)).call(this._applyPosition.bind(this));this._exit.transition(this._transition).attr("width",function(t,i){return n._x1===null?n._getWidth(t,i):0}).attr("height",function(t,i){return n._x1!==null?n._getHeight(t,i):0}).attr("x",function(t,i){return n._x1===null?-n._getWidth(t,i)/2:0}).attr("y",function(t,i){return n._x1!==null?-n._getHeight(t,i)/2:0});return this};i.prototype._aes=function t(i,e){return{height:this._getHeight(i,e),width:this._getWidth(i,e),x:this._x1!==null?this._getX(i,e)+this._getWidth(i,e)/2:this._getX(i,e),y:this._x1===null?this._getY(i,e)+this._getHeight(i,e)/2:this._getY(i,e)}};i.prototype._applyPosition=function t(i){var e=this;i.attr("width",function(t,i){return e._getWidth(t,i)}).attr("height",function(t,i){return e._getHeight(t,i)}).attr("x",function(t,i){return e._x1!==null?e._getX(t,i):-e._getWidth(t,i)/2}).attr("y",function(t,i){return e._x1===null?e._getY(t,i):-e._getHeight(t,i)/2})};i.prototype._getHeight=function t(i,e){if(this._x1!==null){return this._height(i,e)}return Math.abs(this._y1(i,e)-this._y(i,e))};i.prototype._getWidth=function t(i,e){if(this._x1===null){return this._width(i,e)}return Math.abs(this._x1(i,e)-this._x(i,e))};i.prototype._getX=function t(i,e){var n=this._x1===null?this._width(i,e):this._x1(i,e)-this._x(i,e);if(n<0){return n}else{return 0}};i.prototype._getY=function t(i,e){var n=this._x1!==null?this._height(i,e):this._y1(i,e)-this._y(i,e);if(n<0){return n}else{return 0}};i.prototype.height=function t(i){return arguments.length?(this._height=typeof i==="function"?i:n.constant(i),this):this._height};i.prototype.width=function t(i){return arguments.length?(this._width=typeof i==="function"?i:n.constant(i),this):this._width};i.prototype.x0=function t(i){if(!arguments.length){return this._x0}this._x0=typeof i==="function"?i:n.constant(i);this._x=this._x0;return this};i.prototype.x1=function t(i){return arguments.length?(this._x1=typeof i==="function"||i===null?i:n.constant(i),this):this._x1};i.prototype.y0=function t(i){if(!arguments.length){return this._y0}this._y0=typeof i==="function"?i:n.constant(i);this._y=this._y0;return this};i.prototype.y1=function t(i){return arguments.length?(this._y1=typeof i==="function"||i===null?i:n.constant(i),this):this._y1};return i}(l);var y=function(t){function i(){t.call(this,"circle");this._name="Circle";this._r=n.accessor("r")}if(t)i.__proto__=t;i.prototype=Object.create(t&&t.prototype);i.prototype.constructor=i;i.prototype._applyPosition=function t(i){var e=this;i.attr("r",function(t,i){return e._r(t,i)}).attr("x",function(t,i){return-e._r(t,i)/2}).attr("y",function(t,i){return-e._r(t,i)/2})};i.prototype.render=function i(e){t.prototype.render.call(this,e);this._enter.attr("r",0).attr("x",0).attr("y",0).call(this._applyStyle.bind(this)).transition(this._transition).call(this._applyPosition.bind(this));this._update.transition(this._transition).call(this._applyStyle.bind(this)).call(this._applyPosition.bind(this));this._exit.transition(this._transition).attr("r",0).attr("x",0).attr("y",0);return this};i.prototype._aes=function t(i,e){return{r:this._r(i,e)}};i.prototype.r=function t(i){return arguments.length?(this._r=typeof i==="function"?i:n.constant(i),this):this._r};return i}(l);var g=function(t){function e(){t.call(this);this._curve="linear";this._defined=function(t){return t};this._fill=n.constant("none");this._name="Line";this._path=_.line();this._strokeWidth=n.constant(1)}if(t)e.__proto__=t;e.prototype=Object.create(t&&t.prototype);e.prototype.constructor=e;e.prototype._dataFilter=function t(i){var e=this;var s=h.nest().key(this._id).entries(i).map(function(t){t.data=n.merge(t.values);t.i=i.indexOf(t.values[0]);var s=r.extent(t.values,e._x);t.xR=s;t.width=s[1]-s[0];t.x=s[0]+t.width/2;var o=r.extent(t.values,e._y);t.yR=o;t.height=o[1]-o[0];t.y=o[0]+t.height/2;t.nested=true;t.translate=[t.x,t.y];t.__d3plusShape__=true;return t});s.key=function(t){return t.key};return s};e.prototype.render=function e(n){var r=this;t.prototype.render.call(this,n);var s=this;this._path.curve(_["curve"+this._curve.charAt(0).toUpperCase()+this._curve.slice(1)]).defined(this._defined).x(this._x).y(this._y);this._enter.append("path").attr("transform",function(t){return"translate("+(-t.xR[0]-t.width/2)+", "+(-t.yR[0]-t.height/2)+")"}).attr("d",function(t){return r._path(t.values)}).call(this._applyStyle.bind(this));this._update.select("path").transition(this._transition).attr("transform",function(t){return"translate("+(-t.xR[0]-t.width/2)+", "+(-t.yR[0]-t.height/2)+")"}).attrTween("d",function(t){return u.interpolatePath(i.select(this).attr("d"),s._path(t.values))}).call(this._applyStyle.bind(this));return this};e.prototype._aes=function t(i,e){var n=this;return{points:i.values.map(function(t){return[n._x(t,e),n._y(t,e)]})}};e.prototype.curve=function t(i){return arguments.length?(this._curve=i,this):this._curve};e.prototype.defined=function t(i){return arguments.length?(this._defined=i,this):this._defined};return e}(l);var v=function(t){function i(){t.call(this,"path");this._d=n.accessor("path");this._name="Path"}if(t)i.__proto__=t;i.prototype=Object.create(t&&t.prototype);i.prototype.constructor=i;i.prototype.render=function i(e){t.prototype.render.call(this,e);this._enter.attr("opacity",0).attr("d",this._d).call(this._applyStyle.bind(this)).transition(this._transition).attr("opacity",1);this._update.transition(this._transition).call(this._applyStyle.bind(this)).attr("opacity",1).attr("d",this._d);this._exit.transition(this._transition).attr("opacity",0);return this};i.prototype.d=function t(i){return arguments.length?(this._d=typeof i==="function"?i:n.constant(i),this):this._d};return i}(l);var x=function(t){function i(){t.call(this,"rect");this._height=n.accessor("height");this._labelBounds=function(t,i,e){return{width:e.width,height:e.height,x:-e.width/2,y:-e.height/2}};this._name="Rect";this._width=n.accessor("width")}if(t)i.__proto__=t;i.prototype=Object.create(t&&t.prototype);i.prototype.constructor=i;i.prototype.render=function i(e){t.prototype.render.call(this,e);this._enter.attr("width",0).attr("height",0).attr("x",0).attr("y",0).call(this._applyStyle.bind(this)).transition(this._transition).call(this._applyPosition.bind(this));this._update.transition(this._transition).call(this._applyStyle.bind(this)).call(this._applyPosition.bind(this));this._exit.transition(this._transition).attr("width",0).attr("height",0).attr("x",0).attr("y",0);return this};i.prototype._aes=function t(i,e){return{width:this._width(i,e),height:this._height(i,e)}};i.prototype._applyPosition=function t(i){var e=this;i.attr("width",function(t,i){return e._width(t,i)}).attr("height",function(t,i){return e._height(t,i)}).attr("x",function(t,i){return-e._width(t,i)/2}).attr("y",function(t,i){return-e._height(t,i)/2})};i.prototype.height=function t(i){return arguments.length?(this._height=typeof i==="function"?i:n.constant(i),this):this._height};i.prototype.width=function t(i){return arguments.length?(this._width=typeof i==="function"?i:n.constant(i),this):this._width};return i}(l);t.pointDistance=c;t.Image=p;t.Shape=l;t.Area=d;t.Bar=f;t.Circle=y;t.Line=g;t.Path=v;t.Rect=x;Object.defineProperty(t,"__esModule",{value:true})});