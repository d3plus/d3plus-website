function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){if(t)_defineProperties(e.prototype,t);if(n)_defineProperties(e,n);return e}function _get(e,t,n){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get}else{_get=function e(t,n,r){var i=_superPropBase(t,n);if(!i)return;var a=Object.getOwnPropertyDescriptor(i,n);if(a.get){return a.get.call(r)}return a.value}}return _get(e,t,n||e)}function _superPropBase(e,t){while(!Object.prototype.hasOwnProperty.call(e,t)){e=_getPrototypeOf(e);if(e===null)break}return e}function _inherits(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});if(t)_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){_setPrototypeOf=Object.setPrototypeOf||function e(t,n){t.__proto__=n;return t};return _setPrototypeOf(e,t)}function _createSuper(i){var a=_isNativeReflectConstruct();return function e(){var t=_getPrototypeOf(i),n;if(a){var r=_getPrototypeOf(this).constructor;n=Reflect.construct(t,arguments,r)}else{n=t.apply(this,arguments)}return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){if(t&&(_typeof(t)==="object"||typeof t==="function")){return t}return _assertThisInitialized(e)}function _assertThisInitialized(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true}catch(e){return false}}function _getPrototypeOf(e){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)};return _getPrototypeOf(e)}function _typeof(e){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function e(t){return typeof t}}else{_typeof=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return _typeof(e)}
/*
  d3plus-network v0.6.3
  Javascript network visualizations built upon d3 modules.
  Copyright (c) 2021 D3plus - https://d3plus.org
  @license MIT
*/
(function(e){typeof define==="function"&&define.amd?define(e):e()})(function(){"use strict";var e=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function t(e,t,r){return r={path:t,exports:{},require:function e(t,n){return i(t,n===undefined||n===null?r.path:n)}},e(r,r.exports),r.exports}function i(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var n=function e(t){return t&&t.Math==Math&&t};var d=n((typeof globalThis==="undefined"?"undefined":_typeof(globalThis))=="object"&&globalThis)||n((typeof window==="undefined"?"undefined":_typeof(window))=="object"&&window)||n((typeof self==="undefined"?"undefined":_typeof(self))=="object"&&self)||n(_typeof(e)=="object"&&e)||Function("return this")();var s=function e(t){try{return!!t()}catch(e){return true}};var h=!s(function(){return Object.defineProperty({},1,{get:function e(){return 7}})[1]!=7});var r={}.propertyIsEnumerable;var a=Object.getOwnPropertyDescriptor;var o=a&&!r.call({1:2},1);var u=o?function e(t){var n=a(this,t);return!!n&&n.enumerable}:r;var v={f:u};var c=function e(t,n){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:n}};var f={}.toString;var l=function e(t){return f.call(t).slice(8,-1)};var p="".split;var k=s(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return l(e)=="String"?p.call(e,""):Object(e)}:Object;var _=function e(t){if(t==undefined)throw TypeError("Can't call method on "+t);return t};var g=function e(t){return k(_(t))};var y=function e(t){return _typeof(t)==="object"?t!==null:typeof t==="function"};var m=function e(t,n){if(!y(t))return t;var r,i;if(n&&typeof(r=t.toString)=="function"&&!y(i=r.call(t)))return i;if(typeof(r=t.valueOf)=="function"&&!y(i=r.call(t)))return i;if(!n&&typeof(r=t.toString)=="function"&&!y(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")};var b={}.hasOwnProperty;var z=function e(t,n){return b.call(t,n)};var S=d.document;var w=y(S)&&y(S.createElement);var x=function e(t){return w?S.createElement(t):{}};var O=!h&&!s(function(){return Object.defineProperty(x("div"),"a",{get:function e(){return 7}}).a!=7});var M=Object.getOwnPropertyDescriptor;var P=h?M:function e(t,n){t=g(t);n=m(n,true);if(O)try{return M(t,n)}catch(e){}if(z(t,n))return c(!v.f.call(t,n),t[n])};var C={f:P};var E=function e(t){if(!y(t)){throw TypeError(String(t)+" is not an object")}return t};var j=Object.defineProperty;var T=h?j:function e(t,n,r){E(t);n=m(n,true);E(r);if(O)try{return j(t,n,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");if("value"in r)t[n]=r.value;return t};var A={f:T};var L=h?function(e,t,n){return A.f(e,t,c(1,n))}:function(e,t,n){e[t]=n;return e};var B=function e(t,n){try{L(d,t,n)}catch(e){d[t]=n}return n};var D="__core-js_shared__";var G=d[D]||B(D,{});var R=G;var I=Function.toString;if(typeof R.inspectSource!="function"){R.inspectSource=function(e){return I.call(e)}}var q=R.inspectSource;var N=d.WeakMap;var W=typeof N==="function"&&/native code/.test(q(N));var V=t(function(e){(e.exports=function(e,t){return R[e]||(R[e]=t!==undefined?t:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})});var F=0;var X=Math.random();var Y=function e(t){return"Symbol("+String(t===undefined?"":t)+")_"+(++F+X).toString(36)};var H=V("keys");var Q=function e(t){return H[t]||(H[t]=Y(t))};var U={};var J=d.WeakMap;var K,Z,$;var ee=function e(t){return $(t)?Z(t):K(t,{})};var te=function e(n){return function(e){var t;if(!y(e)||(t=Z(e)).type!==n){throw TypeError("Incompatible receiver, "+n+" required")}return t}};if(W){var ne=new J;var re=ne.get;var ie=ne.has;var ae=ne.set;K=function e(t,n){ae.call(ne,t,n);return n};Z=function e(t){return re.call(ne,t)||{}};$=function e(t){return ie.call(ne,t)}}else{var oe=Q("state");U[oe]=true;K=function e(t,n){L(t,oe,n);return n};Z=function e(t){return z(t,oe)?t[oe]:{}};$=function e(t){return z(t,oe)}}var se={set:K,get:Z,has:$,enforce:ee,getterFor:te};var ue=t(function(e){var t=se.get;var s=se.enforce;var u=String(String).split("String");(e.exports=function(e,t,n,r){var i=r?!!r.unsafe:false;var a=r?!!r.enumerable:false;var o=r?!!r.noTargetGet:false;if(typeof n=="function"){if(typeof t=="string"&&!z(n,"name"))L(n,"name",t);s(n).source=u.join(typeof t=="string"?t:"")}if(e===d){if(a)e[t]=n;else B(t,n);return}else if(!i){delete e[t]}else if(!o&&e[t]){a=true}if(a)e[t]=n;else L(e,t,n)})(Function.prototype,"toString",function e(){return typeof this=="function"&&t(this).source||q(this)})});var ce=d;var fe=function e(t){return typeof t=="function"?t:undefined};var le=function e(t,n){return arguments.length<2?fe(ce[t])||fe(d[t]):ce[t]&&ce[t][n]||d[t]&&d[t][n]};var de=Math.ceil;var he=Math.floor;var ve=function e(t){return isNaN(t=+t)?0:(t>0?he:de)(t)};var pe=Math.min;var _e=function e(t){return t>0?pe(ve(t),9007199254740991):0};var ge=Math.max;var ye=Math.min;var me=function e(t,n){var r=ve(t);return r<0?ge(r+n,0):ye(r,n)};var ke=function e(s){return function(e,t,n){var r=g(e);var i=_e(r.length);var a=me(n,i);var o;if(s&&t!=t)while(i>a){o=r[a++];if(o!=o)return true}else for(;i>a;a++){if((s||a in r)&&r[a]===t)return s||a||0}return!s&&-1}};var be={includes:ke(true),indexOf:ke(false)};var ze=be.indexOf;var Se=function e(t,n){var r=g(t);var i=0;var a=[];var o;for(o in r){!z(U,o)&&z(r,o)&&a.push(o)}while(n.length>i){if(z(r,o=n[i++])){~ze(a,o)||a.push(o)}}return a};var we=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];var xe=we.concat("length","prototype");var Oe=Object.getOwnPropertyNames||function e(t){return Se(t,xe)};var Me={f:Oe};var Pe=Object.getOwnPropertySymbols;var Ce={f:Pe};var Ee=le("Reflect","ownKeys")||function e(t){var n=Me.f(E(t));var r=Ce.f;return r?n.concat(r(t)):n};var je=function e(t,n){var r=Ee(n);var i=A.f;var a=C.f;for(var o=0;o<r.length;o++){var s=r[o];if(!z(t,s))i(t,s,a(n,s))}};var Te=/#|\.prototype\./;var Ae=function e(t,n){var r=Be[Le(t)];return r==Ge?true:r==De?false:typeof n=="function"?s(n):!!n};var Le=Ae.normalize=function(e){return String(e).replace(Te,".").toLowerCase()};var Be=Ae.data={};var De=Ae.NATIVE="N";var Ge=Ae.POLYFILL="P";var Re=Ae;var Ie=C.f;var qe=function e(t,n){var r=t.target;var i=t.global;var a=t.stat;var o,s,u,c,f,l;if(i){s=d}else if(a){s=d[r]||B(r,{})}else{s=(d[r]||{}).prototype}if(s)for(u in n){f=n[u];if(t.noTargetGet){l=Ie(s,u);c=l&&l.value}else c=s[u];o=Re(i?u:r+(a?".":"#")+u,t.forced);if(!o&&c!==undefined){if(_typeof(f)===_typeof(c))continue;je(f,c)}if(t.sham||c&&c.sham){L(f,"sham",true)}ue(s,u,f,t)}};var Ne=function e(t){if(typeof t!="function"){throw TypeError(String(t)+" is not a function")}return t};var We=function e(r,i,t){Ne(r);if(i===undefined)return r;switch(t){case 0:return function(){return r.call(i)};case 1:return function(e){return r.call(i,e)};case 2:return function(e,t){return r.call(i,e,t)};case 3:return function(e,t,n){return r.call(i,e,t,n)}}return function(){return r.apply(i,arguments)}};var Ve=function e(t){return Object(_(t))};var Fe=Array.isArray||function e(t){return l(t)=="Array"};var Xe=!!Object.getOwnPropertySymbols&&!s(function(){return!String(Symbol())});var Ye=Xe&&!Symbol.sham&&_typeof(Symbol.iterator)=="symbol";var He=V("wks");var Qe=d.Symbol;var Ue=Ye?Qe:Qe&&Qe.withoutSetter||Y;var Je=function e(t){if(!z(He,t)){if(Xe&&z(Qe,t))He[t]=Qe[t];else He[t]=Ue("Symbol."+t)}return He[t]};var Ke=Je("species");var Ze=function e(t,n){var r;if(Fe(t)){r=t.constructor;if(typeof r=="function"&&(r===Array||Fe(r.prototype)))r=undefined;else if(y(r)){r=r[Ke];if(r===null)r=undefined}}return new(r===undefined?Array:r)(n===0?0:n)};var $e=[].push;var et=function e(h){var v=h==1;var p=h==2;var _=h==3;var g=h==4;var y=h==6;var m=h==5||y;return function(e,t,n,r){var i=Ve(e);var a=k(i);var o=We(t,n,3);var s=_e(a.length);var u=0;var c=r||Ze;var f=v?c(e,s):p?c(e,0):undefined;var l,d;for(;s>u;u++){if(m||u in a){l=a[u];d=o(l,u,i);if(h){if(v)f[u]=d;else if(d)switch(h){case 3:return true;case 5:return l;case 6:return u;case 2:$e.call(f,l)}else if(g)return false}}}return y?-1:_||g?g:f}};var tt={forEach:et(0),map:et(1),filter:et(2),some:et(3),every:et(4),find:et(5),findIndex:et(6)};var nt=Object.keys||function e(t){return Se(t,we)};var rt=h?Object.defineProperties:function e(t,n){E(t);var r=nt(n);var i=r.length;var a=0;var o;while(i>a){A.f(t,o=r[a++],n[o])}return t};var it=le("document","documentElement");var at=">";var ot="<";var st="prototype";var ut="script";var ct=Q("IE_PROTO");var ft=function e(){};var lt=function e(t){return ot+ut+at+t+ot+"/"+ut+at};var dt=function e(t){t.write(lt(""));t.close();var n=t.parentWindow.Object;t=null;return n};var ht=function e(){var t=x("iframe");var n="java"+ut+":";var r;t.style.display="none";it.appendChild(t);t.src=String(n);r=t.contentWindow.document;r.open();r.write(lt("document.F=Object"));r.close();return r.F};var vt;var pt=function e(){try{vt=document.domain&&new ActiveXObject("htmlfile")}catch(e){}pt=vt?dt(vt):ht();var t=we.length;while(t--){delete pt[st][we[t]]}return pt()};U[ct]=true;var _t=Object.create||function e(t,n){var r;if(t!==null){ft[st]=E(t);r=new ft;ft[st]=null;r[ct]=t}else r=pt();return n===undefined?r:rt(r,n)};var gt=Je("unscopables");var yt=Array.prototype;if(yt[gt]==undefined){A.f(yt,gt,{configurable:true,value:_t(null)})}var mt=function e(t){yt[gt][t]=true};var kt=Object.defineProperty;var bt={};var zt=function e(t){throw t};var St=function e(t,n){if(z(bt,t))return bt[t];if(!n)n={};var r=[][t];var i=z(n,"ACCESSORS")?n.ACCESSORS:false;var a=z(n,0)?n[0]:zt;var o=z(n,1)?n[1]:undefined;return bt[t]=!!r&&!s(function(){if(i&&!h)return true;var e={length:-1};if(i)kt(e,1,{enumerable:true,get:zt});else e[1]=1;r.call(e,a,o)})};var wt=tt.find;var xt="find";var Ot=true;var Mt=St(xt);if(xt in[])Array(1)[xt](function(){Ot=false});qe({target:"Array",proto:true,forced:Ot||!Mt},{find:function e(t){return wt(this,t,arguments.length>1?arguments[1]:undefined)}});mt(xt);var Pt=be.includes;var Ct=St("indexOf",{ACCESSORS:true,1:0});qe({target:"Array",proto:true,forced:!Ct},{includes:function e(t){return Pt(this,t,arguments.length>1?arguments[1]:undefined)}});mt("includes");var Et=Object.assign;var jt=Object.defineProperty;var Tt=!Et||s(function(){if(h&&Et({b:1},Et(jt({},"a",{enumerable:true,get:function e(){jt(this,"b",{value:3,enumerable:false})}}),{b:2})).b!==1)return true;var e={};var t={};var n=Symbol();var r="abcdefghijklmnopqrst";e[n]=7;r.split("").forEach(function(e){t[e]=e});return Et({},e)[n]!=7||nt(Et({},t)).join("")!=r})?function e(t,n){var r=Ve(t);var i=arguments.length;var a=1;var o=Ce.f;var s=v.f;while(i>a){var u=k(arguments[a++]);var c=o?nt(u).concat(o(u)):nt(u);var f=c.length;var l=0;var d;while(f>l){d=c[l++];if(!h||s.call(u,d))r[d]=u[d]}}return r}:Et;qe({target:"Object",stat:true,forced:Object.assign!==Tt},{assign:Tt});var At=Je("match");var Lt=function e(t){var n;return y(t)&&((n=t[At])!==undefined?!!n:l(t)=="RegExp")};var Bt=function e(t){if(Lt(t)){throw TypeError("The method doesn't accept regular expressions")}return t};var Dt=Je("match");var Gt=function e(t){var n=/./;try{"/./"[t](n)}catch(e){try{n[Dt]=false;return"/./"[t](n)}catch(e){}}return false};qe({target:"String",proto:true,forced:!Gt("includes")},{includes:function e(t){return!!~String(_(this)).indexOf(Bt(t),arguments.length>1?arguments[1]:undefined)}});var Rt=C.f;var It="".startsWith;var qt=Math.min;var Nt=Gt("startsWith");var Wt=!Nt&&!!function(){var e=Rt(String.prototype,"startsWith");return e&&!e.writable}();qe({target:"String",proto:true,forced:!Wt&&!Nt},{startsWith:function e(t){var n=String(_(this));Bt(t);var r=_e(qt(arguments.length>1?arguments[1]:undefined,n.length));var i=String(t);return It?It.call(n,i,r):n.slice(r,r+i.length)===i}});if(typeof window!=="undefined"){(function(){try{if(typeof SVGElement==="undefined"||Boolean(SVGElement.prototype.innerHTML)){return}}catch(e){return}function n(e){switch(e.nodeType){case 1:return i(e);case 3:return t(e);case 8:return r(e)}}function t(e){return e.textContent.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function r(e){return"\x3c!--"+e.nodeValue+"--\x3e"}function i(e){var t="";t+="<"+e.tagName;if(e.hasAttributes()){[].forEach.call(e.attributes,function(e){t+=" "+e.name+'="'+e.value+'"'})}t+=">";if(e.hasChildNodes()){[].forEach.call(e.childNodes,function(e){t+=n(e)})}t+="</"+e.tagName+">";return t}Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function e(){var t="";[].forEach.call(this.childNodes,function(e){t+=n(e)});return t},set:function e(t){while(this.firstChild){this.removeChild(this.firstChild)}try{var n=new DOMParser;n.async=false;var r="<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>"+t+"</svg>";var i=n.parseFromString(r,"text/xml").documentElement;[].forEach.call(i.childNodes,function(e){this.appendChild(this.ownerDocument.importNode(e,true))}.bind(this))}catch(e){throw new Error("Error parsing markup string")}}});Object.defineProperty(SVGElement.prototype,"innerSVG",{get:function e(){return this.innerHTML},set:function e(t){this.innerHTML=t}})})()}});(function(e,t){(typeof exports==="undefined"?"undefined":_typeof(exports))==="object"&&typeof module!=="undefined"?t(exports,require("d3-array"),require("d3-collection"),require("d3-force"),require("d3-polygon"),require("d3-scale"),require("d3-zoom"),require("d3plus-common"),require("d3plus-shape"),require("d3plus-viz"),require("d3plus-color"),require("d3-sankey")):typeof define==="function"&&define.amd?define("d3plus-network",["exports","d3-array","d3-collection","d3-force","d3-polygon","d3-scale","d3-zoom","d3plus-common","d3plus-shape","d3plus-viz","d3plus-color","d3-sankey"],t):(e=typeof globalThis!=="undefined"?globalThis:e||self,t(e.d3plus={},e.d3Array,e.d3Collection,e.d3Force,e.d3Polygon,e.scales,e.d3Zoom,e.d3plusCommon,e.shapes,e.d3plusViz,e.d3plusColor,e.d3Sankey))})(this,function(e,U,J,K,Z,$,f,ee,te,a,I,n){"use strict";function t(n){if(n&&n.__esModule)return n;var r=Object.create(null);if(n){Object.keys(n).forEach(function(t){if(t!=="default"){var e=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(r,t,e.get?e:{enumerable:true,get:function e(){return n[t]}})}})}r["default"]=n;return Object.freeze(r)}var ne=t($);var re=t(te);var r=function(e){_inherits(Q,e);var t=_createSuper(Q);function Q(){var c;_classCallCheck(this,Q);c=t.call(this);c._links=[];c._linkSize=ee.constant(1);c._linkSizeMin=1;c._linkSizeScale="sqrt";c._noDataMessage=false;c._nodes=[];c._on["click.shape"]=function(e,t){c._tooltipClass.data([]).render();if(c._hover&&c._drawDepth>=c._groupBy.length-1){var n="".concat(c._nodeGroupBy&&c._nodeGroupBy[c._drawDepth](e,t)?c._nodeGroupBy[c._drawDepth](e,t):c._id(e,t));if(c._focus&&c._focus===n){c.active(false);c._on.mouseenter.bind(_assertThisInitialized(c))(e,t);c._focus=undefined;c._zoomToBounds(null)}else{c.hover(false);var r=c._linkLookup[n],i=c._nodeLookup[n];var a=[n];var o=[i.x-i.r,i.x+i.r],s=[i.y-i.r,i.y+i.r];r.forEach(function(e){a.push(e.id);if(e.x-e.r<o[0])o[0]=e.x-e.r;if(e.x+e.r>o[1])o[1]=e.x+e.r;if(e.y-e.r<s[0])s[0]=e.y-e.r;if(e.y+e.r>s[1])s[1]=e.y+e.r});c.active(function(e,t){if(e.source&&e.target)return e.source.id===n||e.target.id===n;else return a.includes("".concat(c._ids(e,t)[c._drawDepth]))});c._focus=n;var u=f.zoomTransform(c._container.node());o=o.map(function(e){return e*u.k+u.x});s=s.map(function(e){return e*u.k+u.y});c._zoomToBounds([[o[0],s[0]],[o[1],s[1]]])}}};c._on["click.legend"]=function(e,t){var n=c._id(e);var r=c._ids(e);r=r[r.length-1];if(c._hover&&c._drawDepth>=c._groupBy.length-1){if(c._focus&&c._focus===n){c.active(false);c._focus=undefined;c._zoomToBounds(null)}else{c.hover(false);var i=n.map(function(e){return c._nodeLookup[e]});var a=["".concat(r)];var o=[i[0].x-i[0].r,i[0].x+i[0].r],s=[i[0].y-i[0].r,i[0].y+i[0].r];i.forEach(function(e){a.push(e.id);if(e.x-e.r<o[0])o[0]=e.x-e.r;if(e.x+e.r>o[1])o[1]=e.x+e.r;if(e.y-e.r<s[0])s[0]=e.y-e.r;if(e.y+e.r>s[1])s[1]=e.y+e.r});c.active(function(e,t){if(e.source&&e.target)return a.includes(e.source.id)&&a.includes(e.target.id);else{var n=c._ids(e,t);return a.includes("".concat(n[n.length-1]))}});c._focus=n;var u=f.zoomTransform(c._container.node());o=o.map(function(e){return e*u.k+u.x});s=s.map(function(e){return e*u.k+u.y});c._zoomToBounds([[o[0],s[0]],[o[1],s[1]]])}c._on.mouseenter.bind(_assertThisInitialized(c))(e,t);c._on["mousemove.legend"].bind(_assertThisInitialized(c))(e,t)}};c._on.mouseenter=function(){};c._on["mouseleave.shape"]=function(){c.hover(false)};var u=c._on["mousemove.shape"];c._on["mousemove.shape"]=function(e,t){u(e,t);var n="".concat(c._nodeGroupBy&&c._nodeGroupBy[c._drawDepth](e,t)?c._nodeGroupBy[c._drawDepth](e,t):c._id(e,t)),r=c._linkLookup[n]||[],i=c._nodeLookup[n];var a=[n];var o=[i.x-i.r,i.x+i.r],s=[i.y-i.r,i.y+i.r];r.forEach(function(e){a.push(e.id);if(e.x-e.r<o[0])o[0]=e.x-e.r;if(e.x+e.r>o[1])o[1]=e.x+e.r;if(e.y-e.r<s[0])s[0]=e.y-e.r;if(e.y+e.r>s[1])s[1]=e.y+e.r});c.hover(function(e,t){if(e.source&&e.target)return e.source.id===n||e.target.id===n;else return a.includes("".concat(c._ids(e,t)[c._drawDepth]))})};c._sizeMin=5;c._sizeScale="sqrt";c._shape=ee.constant("Circle");c._shapeConfig=ee.assign(c._shapeConfig,{ariaLabel:function e(t,n){var r=c._size?", ".concat(c._size(t,n)):"";return"".concat(c._drawLabel(t,n)).concat(r,".")},labelConfig:{duration:0,fontMin:1,fontResize:true,labelPadding:0,textAnchor:"middle",verticalAlign:"middle"},Path:{fill:"none",label:false,stroke:"#eee"}});c._x=ee.accessor("x");c._y=ee.accessor("y");c._zoom=true;return c}_createClass(Q,[{key:"_draw",value:function e(t){var i=this;_get(_getPrototypeOf(Q.prototype),"_draw",this).call(this,t);var n=this._height-this._margin.top-this._margin.bottom,r="translate(".concat(this._margin.left,", ").concat(this._margin.top,")"),a=this._transition,o=this._width-this._margin.left-this._margin.right;var s=this._filteredData.reduce(function(e,t,n){e[i._id(t,n)]=t;return e},{});var u=this._nodes.reduce(function(e,t,n){e[i._nodeGroupBy?i._nodeGroupBy[i._drawDepth](t,n):t.id]=t;return e},{});u=Array.from(new Set(Object.keys(s).concat(Object.keys(u)))).map(function(e,t){var n=s[e],r=u[e];if(r===undefined)return false;return{__d3plus__:true,data:n||r,i:t,id:e,fx:n!==undefined&&!isNaN(i._x(n))?i._x(n):i._x(r),fy:n!==undefined&&!isNaN(i._y(n))?i._y(n):i._y(r),node:r,r:i._size?n!==undefined&&i._size(n)!==undefined?i._size(n):i._size(r):i._sizeMin,shape:n!==undefined&&i._shape(n)!==undefined?i._shape(n):i._shape(r)}}).filter(function(e){return e});var c=this._nodeLookup=u.reduce(function(e,t){e[t.id]=t;return e},{});var f=u.map(function(e){return e.node});var l=this._links.map(function(e){var t=_typeof(e.source);return{size:i._linkSize(e),source:t==="number"?u[f.indexOf(i._nodes[e.source])]:t==="string"?c[e.source]:c[e.source.id],target:t==="number"?u[f.indexOf(i._nodes[e.target])]:t==="string"?c[e.target]:c[e.target.id]}});this._linkLookup=l.reduce(function(e,t){if(!e[t.source.id])e[t.source.id]=[];e[t.source.id].push(t.target);if(!e[t.target.id])e[t.target.id]=[];e[t.target.id].push(t.source);return e},{});var d=u.some(function(e){return e.fx===undefined||e.fy===undefined});if(d){var h=$.scaleLinear().domain(U.extent(l,function(e){return e.size})).range([.1,.5]);var v=K.forceSimulation().force("link",K.forceLink(l).id(function(e){return e.id}).distance(1).strength(function(e){return h(e.size)}).iterations(4)).force("charge",K.forceManyBody().strength(-1)).stop();var p=300;var _=.001;var g=1-Math.pow(_,1/p);v.velocityDecay(0);v.alphaMin(_);v.alphaDecay(g);v.alphaDecay(0);v.nodes(u);v.tick(p).stop();var y=u.map(function(e){return[e.vx,e.vy]});var m=0,k=0,b=0;if(y.length===2){m=100}else if(y.length>2){var z=Z.polygonHull(y);var S=te.largestRect(z,{verbose:true});m=S.angle;k=S.cx;b=S.cy}u.forEach(function(e){var t=te.pointRotate([e.vx,e.vy],-1*(Math.PI/180*m),[k,b]);e.fx=t[0];e.fy=t[1]})}var w=U.extent(u.map(function(e){return e.fx})),x=U.extent(u.map(function(e){return e.fy}));var O=$.scaleLinear().domain(w).range([0,o]),M=$.scaleLinear().domain(x).range([0,n]);var P=(w[1]-w[0])/(x[1]-x[0])||1,C=o/n;if(P>C){var E=n*C/P;M.range([(n-E)/2,n-(n-E)/2])}else{var j=o*P/C;O.range([(o-j)/2,o-(o-j)/2])}u.forEach(function(e){e.x=O(e.fx);e.y=M(e.fy)});var T=U.extent(u.map(function(e){return e.r}));var A=this._sizeMax||U.max([1,U.min(U.merge(u.map(function(t){return u.map(function(e){return t===e?null:te.pointDistance([t.x,t.y],[e.x,e.y])})})))/2]);var L=ne["scale".concat(this._sizeScale.charAt(0).toUpperCase()).concat(this._sizeScale.slice(1))]().domain(T).range([T[0]===T[1]?A:U.min([A/2,this._sizeMin]),A]),B=O.domain(),D=M.domain();var G=B[1]-B[0],R=D[1]-D[0];u.forEach(function(e){var t=L(e.r);if(B[0]>O.invert(e.x-t))B[0]=O.invert(e.x-t);if(B[1]<O.invert(e.x+t))B[1]=O.invert(e.x+t);if(D[0]>M.invert(e.y-t))D[0]=M.invert(e.y-t);if(D[1]<M.invert(e.y+t))D[1]=M.invert(e.y+t)});var I=B[1]-B[0],q=D[1]-D[0];A*=U.min([G/I,R/q]);L.range([T[0]===T[1]?A:U.min([A/2,this._sizeMin]),A]);O.domain(B);M.domain(D);var N=(P>C?o:n)/2;u.forEach(function(e){e.x=O(e.fx);e.fx=e.x;e.y=M(e.fy);e.fy=e.y;e.r=L(e.r)||N;e.width=e.r*2;e.height=e.r*2});this._container=this._select.selectAll("svg.d3plus-network").data([0]);this._container=this._container.enter().append("svg").attr("class","d3plus-network").attr("opacity",0).attr("width",o).attr("height",n).attr("x",this._margin.left).attr("y",this._margin.top).style("background-color","transparent").merge(this._container);this._container.transition(this._transition).attr("opacity",1).attr("width",o).attr("height",n).attr("x",this._margin.left).attr("y",this._margin.top);var W=this._container.selectAll("rect.d3plus-network-hitArea").data([0]);W.enter().append("rect").attr("class","d3plus-network-hitArea").merge(W).attr("width",o).attr("height",n).attr("fill","transparent").on("click",function(){if(i._focus){i.active(false);i._focus=undefined;i._zoomToBounds(null)}});this._zoomGroup=this._container.selectAll("g.d3plus-network-zoomGroup").data([0]);var V=this._zoomGroup=this._zoomGroup.enter().append("g").attr("class","d3plus-network-zoomGroup").merge(this._zoomGroup);var F=U.extent(l,function(e){return e.size});if(F[0]!==F[1]){var X=ne["scale".concat(this._linkSizeScale.charAt(0).toUpperCase()).concat(this._linkSizeScale.slice(1))]().domain(F).range([this._linkSizeMin,L.range()[0]]);l.forEach(function(e){e.size=X(e.size)})}var Y=ee.configPrep.bind(this)(this._shapeConfig,"edge","Path");delete Y.on;this._shapes.push((new te.Path).config(Y).strokeWidth(function(e){return e.size}).activeStyle({"stroke-width":function e(t){return t.size}}).d(function(e){return"M".concat(e.source.x,",").concat(e.source.y," ").concat(e.target.x,",").concat(e.target.y)}).data(l).select(ee.elem("g.d3plus-network-links",{parent:V,transition:a,enter:{transform:r},update:{transform:r}}).node()).render());var H={label:function e(t){return u.length<=i._dataCutoff||i._hover&&i._hover(t)||i._active&&i._active(t)?i._drawLabel(t.data||t.node,t.i):false},select:ee.elem("g.d3plus-network-nodes",{parent:V,transition:a,enter:{transform:r},update:{transform:r}}).node()};J.nest().key(function(e){return e.shape}).entries(u).forEach(function(e){i._shapes.push((new re[e.key]).config(ee.configPrep.bind(i)(i._shapeConfig,"shape",e.key)).config(H).config(H[e.key]||{}).data(e.values).render())});return this}},{key:"hover",value:function e(t){this._hover=t;if(this._nodes.length<this._dataCutoff){this._shapes.forEach(function(e){return e.hover(t)});if(this._legend)this._legendClass.hover(t)}return this}},{key:"links",value:function e(t,n){if(arguments.length){a.addToQueue.bind(this)(t,n,"links");return this}return this._links}},{key:"linkSize",value:function e(t){return arguments.length?(this._linkSize=typeof t==="function"?t:ee.constant(t),this):this._linkSize}},{key:"linkSizeMin",value:function e(t){return arguments.length?(this._linkSizeMin=t,this):this._linkSizeMin}},{key:"linkSizeScale",value:function e(t){return arguments.length?(this._linkSizeScale=t,this):this._linkSizeScale}},{key:"nodeGroupBy",value:function e(t){var n=this;if(!arguments.length)return this._nodeGroupBy;if(!(t instanceof Array))t=[t];return this._nodeGroupBy=t.map(function(e){if(typeof e==="function")return e;else{if(!n._aggs[e]){n._aggs[e]=function(e,t){var n=Array.from(new Set(e.map(t)));return n.length===1?n[0]:n}}return ee.accessor(e)}}),this}},{key:"nodes",value:function e(t,n){if(arguments.length){a.addToQueue.bind(this)(t,n,"nodes");return this}return this._nodes}},{key:"size",value:function e(t){return arguments.length?(this._size=typeof t==="function"||!t?t:ee.accessor(t),this):this._size}},{key:"sizeMax",value:function e(t){return arguments.length?(this._sizeMax=t,this):this._sizeMax}},{key:"sizeMin",value:function e(t){return arguments.length?(this._sizeMin=t,this):this._sizeMin}},{key:"sizeScale",value:function e(t){return arguments.length?(this._sizeScale=t,this):this._sizeScale}},{key:"x",value:function e(t){if(arguments.length){if(typeof t==="function")this._x=t;else{this._x=ee.accessor(t);if(!this._aggs[t])this._aggs[t]=U.mean}return this}else return this._x}},{key:"y",value:function e(t){if(arguments.length){if(typeof t==="function")this._y=t;else{this._y=ee.accessor(t);if(!this._aggs[t])this._aggs[t]=U.mean}return this}else return this._y}}]);return Q}(a.Viz);var i=function(e){_inherits(R,e);var t=_createSuper(R);function R(){var u;_classCallCheck(this,R);u=t.call(this);u._links=[];u._linkSize=ee.constant(1);u._linkSizeMin=1;u._linkSizeScale="sqrt";u._noDataMessage=false;u._nodes=[];u._on.mouseenter=function(){};u._on["mouseleave.shape"]=function(){u.hover(false)};var c=u._on["mousemove.shape"];u._on["mousemove.shape"]=function(e,t){c(e,t);if(u._focus&&u._focus===e.id){u.hover(false);u._on.mouseenter.bind(_assertThisInitialized(u))(e,t);u._focus=undefined}else{var n=u._nodeGroupBy&&u._nodeGroupBy[u._drawDepth](e,t)?u._nodeGroupBy[u._drawDepth](e,t):u._id(e,t),r=u._linkLookup[n],i=u._nodeLookup[n];var a=[i.id];var o=[i.x-i.r,i.x+i.r],s=[i.y-i.r,i.y+i.r];r.forEach(function(e){a.push(e.id);if(e.x-e.r<o[0])o[0]=e.x-e.r;if(e.x+e.r>o[1])o[1]=e.x+e.r;if(e.y-e.r<s[0])s[0]=e.y-e.r;if(e.y+e.r>s[1])s[1]=e.y+e.r});u.hover(function(e,t){if(e.source&&e.target)return e.source.id===i.id||e.target.id===i.id;else return a.includes(u._ids(e,t)[u._drawDepth])})}};u._on["click.shape"]=function(e){u._center=e.id;u._margin={bottom:0,left:0,right:0,top:0};u._padding={bottom:0,left:0,right:0,top:0};u._draw()};u._sizeMin=5;u._sizeScale="sqrt";u._shape=ee.constant("Circle");u._shapeConfig=ee.assign(u._shapeConfig,{ariaLabel:function e(t,n){var r=u._size?", ".concat(u._size(t,n)):"";return"".concat(u._drawLabel(t,n)).concat(r,".")},labelConfig:{duration:0,fontMin:1,fontResize:true,labelPadding:0,textAnchor:"middle",verticalAlign:"middle"},Path:{fill:"none",label:false,stroke:"#eee",strokeWidth:1}});return u}_createClass(R,[{key:"_draw",value:function e(t){var c=this;_get(_getPrototypeOf(R.prototype),"_draw",this).call(this,t);var i=this._filteredData.reduce(function(e,t,n){e[c._id(t,n)]=t;return e},{});var f=this._nodes;if(!this._nodes.length&&this._links.length){var n=Array.from(new Set(this._links.reduce(function(e,t){return e.concat([t.source,t.target])},[])));f=n.map(function(e){return _typeof(e)==="object"?e:{id:e}})}f=f.reduce(function(e,t,n){e[c._nodeGroupBy?c._nodeGroupBy[c._drawDepth](t,n):c._id(t,n)]=t;return e},{});f=Array.from(new Set(Object.keys(i).concat(Object.keys(f)))).map(function(e,t){var n=i[e],r=f[e];if(r===undefined)return false;return{__d3plus__:true,data:n||r,i:t,id:e,node:r,shape:n!==undefined&&c._shape(n)!==undefined?c._shape(n):c._shape(r)}}).filter(function(e){return e});var r=this._nodeLookup=f.reduce(function(e,t){e[t.id]=t;return e},{});var a=this._links.map(function(n){var e=["source","target"];var t=e.reduce(function(e,t){e[t]=typeof n[t]==="number"?f[n[t]]:r[n[t].id||n[t]];return e},{});t.size=c._linkSize(n);return t});var o=a.reduce(function(e,t){if(!e[t.source.id]){e[t.source.id]=[]}e[t.source.id].push(t);if(!e[t.target.id]){e[t.target.id]=[]}e[t.target.id].push(t);return e},{});var l=this._height-this._margin.top-this._margin.bottom,s="translate(".concat(this._margin.left,", ").concat(this._margin.top,")"),u=this._transition,d=this._width-this._margin.left-this._margin.right;var h=[],v=U.min([l,d])/2,p=v/3;var _=p,g=p*2;var y=r[this._center];y.x=d/2;y.y=l/2;y.r=this._sizeMin?U.max([this._sizeMin,_*.65]):this._sizeMax?U.min([this._sizeMax,_*.65]):_*.65;var m=[y],k=[];o[this._center].forEach(function(e){var t=e.source.id===c._center?e.target:e.source;t.edges=o[t.id].filter(function(e){return e.source.id!==c._center||e.target.id!==c._center});t.edge=e;m.push(t);k.push(t)});k.sort(function(e,t){return e.edges.length-t.edges.length});var b=[];var z=0;k.forEach(function(e){var i=e.id;e.edges=e.edges.filter(function(e){return!m.includes(e.source)&&e.target.id===i||!m.includes(e.target)&&e.source.id===i});z+=e.edges.length||1;e.edges.forEach(function(e){var t=e.source,n=e.target;var r=n.id===i?t:n;m.push(r)})});var S=Math.PI*2;var w=0;k.forEach(function(a,e){var o=a.edges.length||1;var t=S/z*o;if(e===0){w-=t/2}var s=w+t/2-S/4;a.radians=s;a.x=d/2+_*Math.cos(s);a.y=l/2+_*Math.sin(s);w+=t;a.edges.forEach(function(e,t){var n=e.source.id===a.id?e.target:e.source;var r=S/z;var i=s-r*o/2+r/2+r*t;n.radians=i;n.x=d/2+g*Math.cos(i);n.y=l/2+g*Math.sin(i);b.push(n)})});var x=p/2;var O=p/4;var M=x/2-4;if(x/2-4<8){M=U.min([x/2,8])}var P=O/2-4;if(O/2-4<4){P=U.min([O/2,4])}if(P>p/10){P=p/10}if(P>M&&P>10){P=M*.75}if(M>P*1.5){M=P*1.5}M=Math.floor(M);P=Math.floor(P);var C;if(this._size){var E=U.extent(i,function(e){return e.size});if(E[0]===E[1]){E[0]=0}C=$.scaleLinear().domain(E).rangeRound([3,U.min([M,P])]);var j=y.size;y.r=C(j)}else{C=$.scaleLinear().domain([1,2]).rangeRound([M,P])}b.forEach(function(e){e.ring=2;var t=c._size?e.size:2;e.r=c._sizeMin?U.max([c._sizeMin,C(t)]):c._sizeMax?U.min([c._sizeMax,C(t)]):C(t)});k.forEach(function(e){e.ring=1;var t=c._size?e.size:1;e.r=c._sizeMin?U.max([c._sizeMin,C(t)]):c._sizeMax?U.min([c._sizeMax,C(t)]):C(t)});f=[y].concat(k).concat(b);k.forEach(function(u){var e=["source","target"];var n=u.edge;e.forEach(function(t){n[t]=f.find(function(e){return e.id===n[t].id})});h.push(n);o[u.id].forEach(function(r){var t=r.source.id===u.id?r.target:r.source;if(t.id!==y.id){var i=b.find(function(e){return e.id===t.id});if(!i){i=k.find(function(e){return e.id===t.id})}if(i){r.spline=true;var a=d/2;var o=l/2;var s=_+(g-_)*.5;var e=["source","target"];e.forEach(function(t,e){r["".concat(t,"X")]=r[t].x+Math.cos(r[t].ring===2?r[t].radians+Math.PI:r[t].radians)*r[t].r;r["".concat(t,"Y")]=r[t].y+Math.sin(r[t].ring===2?r[t].radians+Math.PI:r[t].radians)*r[t].r;r["".concat(t,"BisectX")]=a+s*Math.cos(r[t].radians);r["".concat(t,"BisectY")]=o+s*Math.sin(r[t].radians);r[t]=f.find(function(e){return e.id===r[t].id});if(r[t].edges===undefined)r[t].edges={};var n=e===0?r.target.id:r.source.id;if(r[t].id===u.id){r[t].edges[n]={angle:u.radians+Math.PI,radius:p/2}}else{r[t].edges[n]={angle:i.radians,radius:p/2}}});h.push(r)}}})});f.forEach(function(e){if(e.id!==c._center){var t=c._shapeConfig.labelConfig.fontSize&&c._shapeConfig.labelConfig.fontSize(e)||11;var n=t*1.4;var r=n*2;var i=5;var a=p-e.r;var o=e.radians*(180/Math.PI);var s=e.r+i;var u="start";if(o<-90||o>90){s=-e.r-a-i;u="end";o+=180}e.labelBounds={x:s,y:-n/2,width:a,height:r};e.rotate=o;e.textAnchor=u}else{e.labelBounds={x:-_/2,y:-_/2,width:_,height:_}}});this._linkLookup=a.reduce(function(e,t){if(!e[t.source.id])e[t.source.id]=[];e[t.source.id].push(t.target);if(!e[t.target.id])e[t.target.id]=[];e[t.target.id].push(t.source);return e},{});var T=U.extent(a,function(e){return e.size});if(T[0]!==T[1]){var A=U.min(f,function(e){return e.r});var L=ne["scale".concat(this._linkSizeScale.charAt(0).toUpperCase()).concat(this._linkSizeScale.slice(1))]().domain(T).range([this._linkSizeMin,A]);a.forEach(function(e){e.size=L(e.size)})}var B=ee.configPrep.bind(this)(this._shapeConfig,"edge","Path");delete B.on;this._shapes.push((new te.Path).config(B).strokeWidth(function(e){return e.size}).id(function(e){return"".concat(e.source.id,"_").concat(e.target.id)}).d(function(e){return e.spline?"M".concat(e.sourceX,",").concat(e.sourceY,"C").concat(e.sourceBisectX,",").concat(e.sourceBisectY," ").concat(e.targetBisectX,",").concat(e.targetBisectY," ").concat(e.targetX,",").concat(e.targetY):"M".concat(e.source.x,",").concat(e.source.y," ").concat(e.target.x,",").concat(e.target.y)}).data(h).select(ee.elem("g.d3plus-rings-links",{parent:this._select,transition:u,enter:{transform:s},update:{transform:s}}).node()).render());var D=this;var G={label:function e(t){return f.length<=c._dataCutoff||c._hover&&c._hover(t)||c._active&&c._active(t)?c._drawLabel(t.data||t.node,t.i):false},labelBounds:function e(t){return t.labelBounds},labelConfig:{fontColor:function e(t){return t.id===c._center?ee.configPrep.bind(D)(D._shapeConfig,"shape",t.key).labelConfig.fontColor(t):I.colorLegible(ee.configPrep.bind(D)(D._shapeConfig,"shape",t.key).fill(t))},fontResize:function e(t){return t.id===c._center},padding:0,textAnchor:function e(t){return r[t.id].textAnchor||ee.configPrep.bind(D)(D._shapeConfig,"shape",t.key).labelConfig.textAnchor},verticalAlign:function e(t){return t.id===c._center?"middle":"top"}},rotate:function e(t){return r[t.id].rotate||0},select:ee.elem("g.d3plus-rings-nodes",{parent:this._select,transition:u,enter:{transform:s},update:{transform:s}}).node()};J.nest().key(function(e){return e.shape}).entries(f).forEach(function(e){c._shapes.push((new re[e.key]).config(ee.configPrep.bind(c)(c._shapeConfig,"shape",e.key)).config(G).data(e.values).render())});return this}},{key:"center",value:function e(t){return arguments.length?(this._center=t,this):this._center}},{key:"hover",value:function e(t){this._hover=t;this._shapes.forEach(function(e){return e.hover(t)});if(this._legend)this._legendClass.hover(t);return this}},{key:"links",value:function e(t,n){if(arguments.length){a.addToQueue.bind(this)(t,n,"links");return this}return this._links}},{key:"linkSize",value:function e(t){return arguments.length?(this._linkSize=typeof t==="function"?t:ee.constant(t),this):this._linkSize}},{key:"linkSizeMin",value:function e(t){return arguments.length?(this._linkSizeMin=t,this):this._linkSizeMin}},{key:"linkSizeScale",value:function e(t){return arguments.length?(this._linkSizeScale=t,this):this._linkSizeScale}},{key:"nodeGroupBy",value:function e(t){var n=this;if(!arguments.length)return this._nodeGroupBy;if(!(t instanceof Array))t=[t];return this._nodeGroupBy=t.map(function(e){if(typeof e==="function")return e;else{if(!n._aggs[e]){n._aggs[e]=function(e,t){var n=Array.from(new Set(e.map(t)));return n.length===1?n[0]:n}}return ee.accessor(e)}}),this}},{key:"nodes",value:function e(t,n){if(arguments.length){a.addToQueue.bind(this)(t,n,"nodes");return this}return this._nodes}},{key:"size",value:function e(t){return arguments.length?(this._size=typeof t==="function"||!t?t:ee.accessor(t),this):this._size}},{key:"sizeMax",value:function e(t){return arguments.length?(this._sizeMax=t,this):this._sizeMax}},{key:"sizeMin",value:function e(t){return arguments.length?(this._sizeMin=t,this):this._sizeMin}},{key:"sizeScale",value:function e(t){return arguments.length?(this._sizeScale=t,this):this._sizeScale}}]);return R}(a.Viz);var o={center:n.sankeyCenter,justify:n.sankeyJustify,left:n.sankeyLeft,right:n.sankeyRight};var s=function(e){_inherits(f,e);var t=_createSuper(f);function f(){var s;_classCallCheck(this,f);s=t.call(this);s._nodeId=ee.accessor("id");s._links=ee.accessor("links");s._linksSource="source";s._linksTarget="target";s._noDataMessage=false;s._nodes=ee.accessor("nodes");s._nodeAlign=o.justify;s._nodePadding=8;s._nodeWidth=30;s._on.mouseenter=function(){};s._on["mouseleave.shape"]=function(){s.hover(false)};var u=s._on["mousemove.shape"];s._on["mousemove.shape"]=function(e,t){u(e,t);if(s._focus&&s._focus===e.id){s.hover(false);s._on.mouseenter.bind(_assertThisInitialized(s))(e,t);s._focus=undefined}else{var n=s._nodeId(e,t),r=s._nodeLookup[n],i=Object.keys(s._nodeLookup).reduce(function(e,t){e[s._nodeLookup[t]]=!isNaN(t)?parseInt(t,10):t;return e},{});var a=s._linkLookup[r];var o=[n];a.forEach(function(e){o.push(i[e])});s.hover(function(e,t){if(e.source&&e.target){return e.source.id===n||e.target.id===n}else{return o.includes(s._nodeId(e,t))}})}};s._path=n.sankeyLinkHorizontal();s._sankey=n.sankey();s._shape=ee.constant("Rect");s._shapeConfig=ee.assign(s._shapeConfig,{Path:{fill:"none",hoverStyle:{"stroke-width":function e(t){return Math.max(1,Math.abs(t.source.y1-t.source.y0)*(t.value/t.source.value)-2)}},label:false,stroke:"#DBDBDB",strokeOpacity:.5,strokeWidth:function e(t){return Math.max(1,Math.abs(t.source.y1-t.source.y0)*(t.value/t.source.value)-2)}},Rect:{}});s._value=ee.constant(1);return s}_createClass(f,[{key:"_draw",value:function e(t){var i=this;_get(_getPrototypeOf(f.prototype),"_draw",this).call(this,t);var n=this._height-this._margin.top-this._margin.bottom,r=this._width-this._margin.left-this._margin.right;var a=Array.isArray(this._nodes)?this._nodes:this._links.reduce(function(e,t){if(!e.includes(t[i._linksSource]))e.push(t[i._linksSource]);if(!e.includes(t[i._linksTarget]))e.push(t[i._linksTarget]);return e},[]).map(function(e){return{id:e}});var o=a.map(function(e,t){return{__d3plus__:true,data:e,i:t,id:i._nodeId(e,t),node:e,shape:"Rect"}});var s=this._nodeLookup=o.reduce(function(e,t,n){e[t.id]=n;return e},{});var u=this._links.map(function(n,e){var t=[i._linksSource,i._linksTarget];var r=t.reduce(function(e,t){e[t]=s[n[t]];return e},{});return{source:r[i._linksSource],target:r[i._linksTarget],value:i._value(n,e)}});this._linkLookup=u.reduce(function(e,t){if(!e[t.source])e[t.source]=[];e[t.source].push(t.target);if(!e[t.target])e[t.target]=[];e[t.target].push(t.source);return e},{});var c="translate(".concat(this._margin.left,", ").concat(this._margin.top,")");this._sankey.nodeAlign(this._nodeAlign).nodePadding(this._nodePadding).nodeWidth(this._nodeWidth).nodes(o).links(u).size([r,n])();this._shapes.push((new te.Path).config(this._shapeConfig.Path).data(u).d(this._path).select(ee.elem("g.d3plus-Links",{parent:this._select,enter:{transform:c},update:{transform:c}}).node()).render());J.nest().key(function(e){return e.shape}).entries(o).forEach(function(e){i._shapes.push((new re[e.key]).data(e.values).height(function(e){return e.y1-e.y0}).width(function(e){return e.x1-e.x0}).x(function(e){return(e.x1+e.x0)/2}).y(function(e){return(e.y1+e.y0)/2}).select(ee.elem("g.d3plus-sankey-nodes",{parent:i._select,enter:{transform:c},update:{transform:c}}).node()).config(ee.configPrep.bind(i)(i._shapeConfig,"shape",e.key)).render())});return this}},{key:"hover",value:function e(t){this._hover=t;this._shapes.forEach(function(e){return e.hover(t)});if(this._legend)this._legendClass.hover(t);return this}},{key:"links",value:function e(t,n){if(arguments.length){var r=this._queue.find(function(e){return e[3]==="links"});var i=[a.dataLoad.bind(this),t,n,"links"];if(r)this._queue[this._queue.indexOf(r)]=i;else this._queue.push(i);return this}return this._links}},{key:"linksSource",value:function e(t){return arguments.length?(this._linksSource=t,this):this._linksSource}},{key:"linksTarget",value:function e(t){return arguments.length?(this._linksTarget=t,this):this._linksTarget}},{key:"nodeAlign",value:function e(t){return arguments.length?(this._nodeAlign=typeof t==="function"?t:o[t],this):this._nodeAlign}},{key:"nodeId",value:function e(t){return arguments.length?(this._nodeId=typeof t==="function"?t:ee.accessor(t),this):this._nodeId}},{key:"nodes",value:function e(t,n){if(arguments.length){var r=this._queue.find(function(e){return e[3]==="nodes"});var i=[a.dataLoad.bind(this),t,n,"nodes"];if(r)this._queue[this._queue.indexOf(r)]=i;else this._queue.push(i);return this}return this._nodes}},{key:"nodePadding",value:function e(t){return arguments.length?(this._nodePadding=t,this):this._nodePadding}},{key:"nodeWidth",value:function e(t){return arguments.length?(this._nodeWidth=t,this):this._nodeWidth}},{key:"value",value:function e(t){return arguments.length?(this._value=typeof t==="function"?t:ee.accessor(t),this):this._value}}]);return f}(a.Viz);e.Network=r;e.Rings=i;e.Sankey=s;Object.defineProperty(e,"__esModule",{value:true})});