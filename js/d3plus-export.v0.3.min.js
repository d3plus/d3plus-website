/*
  d3plus-export v0.3.19
  Export methods for transforming and downloading SVG.
  Copyright (c) 2020 D3plus - https://d3plus.org
  @license MIT
*/
(function(e){typeof define==="function"&&define.amd?define(e):e()})(function(){"use strict";var e=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function t(e,t){return t={exports:{}},e(t,t.exports),t.exports}var r=function(e){return e&&e.Math==Math&&e};var f=r(typeof globalThis=="object"&&globalThis)||r(typeof window=="object"&&window)||r(typeof self=="object"&&self)||r(typeof e=="object"&&e)||Function("return this")();var o=function(e){try{return!!e()}catch(e){return true}};var d=!o(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7});var n={}.propertyIsEnumerable;var a=Object.getOwnPropertyDescriptor;var i=a&&!n.call({1:2},1);var c=i?function e(t){var r=a(this,t);return!!r&&r.enumerable}:n;var h={f:c};var l=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}};var s={}.toString;var u=function(e){return s.call(e).slice(8,-1)};var v="".split;var w=o(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return u(e)=="String"?v.call(e,""):Object(e)}:Object;var p=function(e){if(e==undefined)throw TypeError("Can't call method on "+e);return e};var g=function(e){return w(p(e))};var y=function(e){return typeof e==="object"?e!==null:typeof e==="function"};var m=function(e,t){if(!y(e))return e;var r,n;if(t&&typeof(r=e.toString)=="function"&&!y(n=r.call(e)))return n;if(typeof(r=e.valueOf)=="function"&&!y(n=r.call(e)))return n;if(!t&&typeof(r=e.toString)=="function"&&!y(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")};var b={}.hasOwnProperty;var x=function(e,t){return b.call(e,t)};var O=f.document;var S=y(O)&&y(O.createElement);var j=function(e){return S?O.createElement(e):{}};var E=!d&&!o(function(){return Object.defineProperty(j("div"),"a",{get:function(){return 7}}).a!=7});var A=Object.getOwnPropertyDescriptor;var T=d?A:function e(t,r){t=g(t);r=m(r,true);if(E)try{return A(t,r)}catch(e){}if(x(t,r))return l(!h.f.call(t,r),t[r])};var k={f:T};var C=function(e){if(!y(e)){throw TypeError(String(e)+" is not an object")}return e};var F=Object.defineProperty;var M=d?F:function e(t,r,n){C(t);r=m(r,true);C(n);if(E)try{return F(t,r,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");if("value"in n)t[r]=n.value;return t};var P={f:M};var N=d?function(e,t,r){return P.f(e,t,l(1,r))}:function(e,t,r){e[t]=r;return e};var L=function(t,r){try{N(f,t,r)}catch(e){f[t]=r}return r};var I="__core-js_shared__";var z=f[I]||L(I,{});var R=z;var _=Function.toString;if(typeof R.inspectSource!="function"){R.inspectSource=function(e){return _.call(e)}}var q=R.inspectSource;var B=f.WeakMap;var V=typeof B==="function"&&/native code/.test(q(B));var W=t(function(e){(e.exports=function(e,t){return R[e]||(R[e]=t!==undefined?t:{})})("versions",[]).push({version:"3.6.5",mode:"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})});var D=0;var G=Math.random();var H=function(e){return"Symbol("+String(e===undefined?"":e)+")_"+(++D+G).toString(36)};var $=W("keys");var X=function(e){return $[e]||($[e]=H(e))};var Y={};var U=f.WeakMap;var K,J,Q;var Z=function(e){return Q(e)?J(e):K(e,{})};var ee=function(r){return function(e){var t;if(!y(e)||(t=J(e)).type!==r){throw TypeError("Incompatible receiver, "+r+" required")}return t}};if(V){var te=new U;var re=te.get;var ne=te.has;var ae=te.set;K=function(e,t){ae.call(te,e,t);return t};J=function(e){return re.call(te,e)||{}};Q=function(e){return ne.call(te,e)}}else{var ie=X("state");Y[ie]=true;K=function(e,t){N(e,ie,t);return t};J=function(e){return x(e,ie)?e[ie]:{}};Q=function(e){return x(e,ie)}}var oe={set:K,get:J,has:Q,enforce:Z,getterFor:ee};var ce=t(function(e){var t=oe.get;var c=oe.enforce;var l=String(String).split("String");(e.exports=function(e,t,r,n){var a=n?!!n.unsafe:false;var i=n?!!n.enumerable:false;var o=n?!!n.noTargetGet:false;if(typeof r=="function"){if(typeof t=="string"&&!x(r,"name"))N(r,"name",t);c(r).source=l.join(typeof t=="string"?t:"")}if(e===f){if(i)e[t]=r;else L(t,r);return}else if(!a){delete e[t]}else if(!o&&e[t]){i=true}if(i)e[t]=r;else N(e,t,r)})(Function.prototype,"toString",function e(){return typeof this=="function"&&t(this).source||q(this)})});var le=f;var se=function(e){return typeof e=="function"?e:undefined};var ue=function(e,t){return arguments.length<2?se(le[e])||se(f[e]):le[e]&&le[e][t]||f[e]&&f[e][t]};var fe=Math.ceil;var ve=Math.floor;var de=function(e){return isNaN(e=+e)?0:(e>0?ve:fe)(e)};var he=Math.min;var pe=function(e){return e>0?he(de(e),9007199254740991):0};var ge=Math.max;var ye=Math.min;var me=function(e,t){var r=de(e);return r<0?ge(r+t,0):ye(r,t)};var be=function(c){return function(e,t,r){var n=g(e);var a=pe(n.length);var i=me(r,a);var o;if(c&&t!=t)while(a>i){o=n[i++];if(o!=o)return true}else for(;a>i;i++){if((c||i in n)&&n[i]===t)return c||i||0}return!c&&-1}};var we={includes:be(true),indexOf:be(false)};var xe=we.indexOf;var Oe=function(e,t){var r=g(e);var n=0;var a=[];var i;for(i in r)!x(Y,i)&&x(r,i)&&a.push(i);while(t.length>n)if(x(r,i=t[n++])){~xe(a,i)||a.push(i)}return a};var Se=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];var je=Se.concat("length","prototype");var Ee=Object.getOwnPropertyNames||function e(t){return Oe(t,je)};var Ae={f:Ee};var Te=Object.getOwnPropertySymbols;var ke={f:Te};var Ce=ue("Reflect","ownKeys")||function e(t){var r=Ae.f(C(t));var n=ke.f;return n?r.concat(n(t)):r};var Fe=function(e,t){var r=Ce(t);var n=P.f;var a=k.f;for(var i=0;i<r.length;i++){var o=r[i];if(!x(e,o))n(e,o,a(t,o))}};var Me=/#|\.prototype\./;var Pe=function(e,t){var r=Le[Ne(e)];return r==ze?true:r==Ie?false:typeof t=="function"?o(t):!!t};var Ne=Pe.normalize=function(e){return String(e).replace(Me,".").toLowerCase()};var Le=Pe.data={};var Ie=Pe.NATIVE="N";var ze=Pe.POLYFILL="P";var Re=Pe;var _e=k.f;var qe=function(e,t){var r=e.target;var n=e.global;var a=e.stat;var i,o,c,l,s,u;if(n){o=f}else if(a){o=f[r]||L(r,{})}else{o=(f[r]||{}).prototype}if(o)for(c in t){s=t[c];if(e.noTargetGet){u=_e(o,c);l=u&&u.value}else l=o[c];i=Re(n?c:r+(a?".":"#")+c,e.forced);if(!i&&l!==undefined){if(typeof s===typeof l)continue;Fe(s,l)}if(e.sham||l&&l.sham){N(s,"sham",true)}ce(o,c,s,e)}};var Be=function(e){if(typeof e!="function"){throw TypeError(String(e)+" is not a function")}return e};var Ve=function(n,a,e){Be(n);if(a===undefined)return n;switch(e){case 0:return function(){return n.call(a)};case 1:return function(e){return n.call(a,e)};case 2:return function(e,t){return n.call(a,e,t)};case 3:return function(e,t,r){return n.call(a,e,t,r)}}return function(){return n.apply(a,arguments)}};var We=function(e){return Object(p(e))};var De=Array.isArray||function e(t){return u(t)=="Array"};var Ge=!!Object.getOwnPropertySymbols&&!o(function(){return!String(Symbol())});var He=Ge&&!Symbol.sham&&typeof Symbol.iterator=="symbol";var $e=W("wks");var Xe=f.Symbol;var Ye=He?Xe:Xe&&Xe.withoutSetter||H;var Ue=function(e){if(!x($e,e)){if(Ge&&x(Xe,e))$e[e]=Xe[e];else $e[e]=Ye("Symbol."+e)}return $e[e]};var Ke=Ue("species");var Je=function(e,t){var r;if(De(e)){r=e.constructor;if(typeof r=="function"&&(r===Array||De(r.prototype)))r=undefined;else if(y(r)){r=r[Ke];if(r===null)r=undefined}}return new(r===undefined?Array:r)(t===0?0:t)};var Qe=[].push;var Ze=function(d){var h=d==1;var p=d==2;var g=d==3;var y=d==4;var m=d==6;var b=d==5||m;return function(e,t,r,n){var a=We(e);var i=w(a);var o=Ve(t,r,3);var c=pe(i.length);var l=0;var s=n||Je;var u=h?s(e,c):p?s(e,0):undefined;var f,v;for(;c>l;l++)if(b||l in i){f=i[l];v=o(f,l,a);if(d){if(h)u[l]=v;else if(v)switch(d){case 3:return true;case 5:return f;case 6:return l;case 2:Qe.call(u,f)}else if(y)return false}}return m?-1:g||y?y:u}};var et={forEach:Ze(0),map:Ze(1),filter:Ze(2),some:Ze(3),every:Ze(4),find:Ze(5),findIndex:Ze(6)};var tt=Object.keys||function e(t){return Oe(t,Se)};var rt=d?Object.defineProperties:function e(t,r){C(t);var n=tt(r);var a=n.length;var i=0;var o;while(a>i)P.f(t,o=n[i++],r[o]);return t};var nt=ue("document","documentElement");var at=">";var it="<";var ot="prototype";var ct="script";var lt=X("IE_PROTO");var st=function(){};var ut=function(e){return it+ct+at+e+it+"/"+ct+at};var ft=function(e){e.write(ut(""));e.close();var t=e.parentWindow.Object;e=null;return t};var vt=function(){var e=j("iframe");var t="java"+ct+":";var r;e.style.display="none";nt.appendChild(e);e.src=String(t);r=e.contentWindow.document;r.open();r.write(ut("document.F=Object"));r.close();return r.F};var dt;var ht=function(){try{dt=document.domain&&new ActiveXObject("htmlfile")}catch(e){}ht=dt?ft(dt):vt();var e=Se.length;while(e--)delete ht[ot][Se[e]];return ht()};Y[lt]=true;var pt=Object.create||function e(t,r){var n;if(t!==null){st[ot]=C(t);n=new st;st[ot]=null;n[lt]=t}else n=ht();return r===undefined?n:rt(n,r)};var gt=Ue("unscopables");var yt=Array.prototype;if(yt[gt]==undefined){P.f(yt,gt,{configurable:true,value:pt(null)})}var mt=function(e){yt[gt][e]=true};var bt=Object.defineProperty;var wt={};var xt=function(e){throw e};var Ot=function(e,t){if(x(wt,e))return wt[e];if(!t)t={};var r=[][e];var n=x(t,"ACCESSORS")?t.ACCESSORS:false;var a=x(t,0)?t[0]:xt;var i=x(t,1)?t[1]:undefined;return wt[e]=!!r&&!o(function(){if(n&&!d)return true;var e={length:-1};if(n)bt(e,1,{enumerable:true,get:xt});else e[1]=1;r.call(e,a,i)})};var St=et.find;var jt="find";var Et=true;var At=Ot(jt);if(jt in[])Array(1)[jt](function(){Et=false});qe({target:"Array",proto:true,forced:Et||!At},{find:function e(t){return St(this,t,arguments.length>1?arguments[1]:undefined)}});mt(jt);var Tt=we.includes;var kt=Ot("indexOf",{ACCESSORS:true,1:0});qe({target:"Array",proto:true,forced:!kt},{includes:function e(t){return Tt(this,t,arguments.length>1?arguments[1]:undefined)}});mt("includes");var Ct=Object.assign;var Ft=Object.defineProperty;var Mt=!Ct||o(function(){if(d&&Ct({b:1},Ct(Ft({},"a",{enumerable:true,get:function(){Ft(this,"b",{value:3,enumerable:false})}}),{b:2})).b!==1)return true;var e={};var t={};var r=Symbol();var n="abcdefghijklmnopqrst";e[r]=7;n.split("").forEach(function(e){t[e]=e});return Ct({},e)[r]!=7||tt(Ct({},t)).join("")!=n})?function e(t,r){var n=We(t);var a=arguments.length;var i=1;var o=ke.f;var c=h.f;while(a>i){var l=w(arguments[i++]);var s=o?tt(l).concat(o(l)):tt(l);var u=s.length;var f=0;var v;while(u>f){v=s[f++];if(!d||c.call(l,v))n[v]=l[v]}}return n}:Ct;qe({target:"Object",stat:true,forced:Object.assign!==Mt},{assign:Mt});var Pt=Ue("match");var Nt=function(e){var t;return y(e)&&((t=e[Pt])!==undefined?!!t:u(e)=="RegExp")};var Lt=function(e){if(Nt(e)){throw TypeError("The method doesn't accept regular expressions")}return e};var It=Ue("match");var zt=function(t){var r=/./;try{"/./"[t](r)}catch(e){try{r[It]=false;return"/./"[t](r)}catch(e){}}return false};qe({target:"String",proto:true,forced:!zt("includes")},{includes:function e(t){return!!~String(p(this)).indexOf(Lt(t),arguments.length>1?arguments[1]:undefined)}});var Rt=k.f;var _t="".startsWith;var qt=Math.min;var Bt=zt("startsWith");var Vt=!Bt&&!!function(){var e=Rt(String.prototype,"startsWith");return e&&!e.writable}();qe({target:"String",proto:true,forced:!Vt&&!Bt},{startsWith:function e(t){var r=String(p(this));Lt(t);var n=pe(qt(arguments.length>1?arguments[1]:undefined,r.length));var a=String(t);return _t?_t.call(r,a,n):r.slice(n,n+a.length)===a}});if(typeof window!=="undefined"){(function(){try{if(typeof SVGElement==="undefined"||Boolean(SVGElement.prototype.innerHTML)){return}}catch(e){return}function r(e){switch(e.nodeType){case 1:return a(e);case 3:return t(e);case 8:return n(e)}}function t(e){return e.textContent.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function n(e){return"\x3c!--"+e.nodeValue+"--\x3e"}function a(e){var t="";t+="<"+e.tagName;if(e.hasAttributes()){[].forEach.call(e.attributes,function(e){t+=" "+e.name+'="'+e.value+'"'})}t+=">";if(e.hasChildNodes()){[].forEach.call(e.childNodes,function(e){t+=r(e)})}t+="</"+e.tagName+">";return t}Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){var t="";[].forEach.call(this.childNodes,function(e){t+=r(e)});return t},set:function(e){while(this.firstChild){this.removeChild(this.firstChild)}try{var t=new DOMParser;t.async=false;var r="<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>"+e+"</svg>";var n=t.parseFromString(r,"text/xml").documentElement;[].forEach.call(n.childNodes,function(e){this.appendChild(this.ownerDocument.importNode(e,true))}.bind(this))}catch(e){throw new Error("Error parsing markup string")}}});Object.defineProperty(SVGElement.prototype,"innerSVG",{get:function(){return this.innerHTML},set:function(e){this.innerHTML=e}})})()}});(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?t(exports,require("html2canvas"),require("canvg-browser"),require("d3-selection"),require("canvas-toBlob"),require("file-saver")):typeof define==="function"&&define.amd?define("d3plus-export",["exports","html2canvas","canvg-browser","d3-selection","canvas-toBlob","file-saver"],t):(e=e||self,t(e.d3plus={},e.html2canvas,e.canvg,e.d3Selection,null,e.fileSaver))})(this,function(e,ne,d,ae,t,i){"use strict";ne=ne&&Object.prototype.hasOwnProperty.call(ne,"default")?ne["default"]:ne;d=d&&Object.prototype.hasOwnProperty.call(d,"default")?d["default"]:d;function ie(e,t){return r(e)||n(e,t)||a(e,t)||c()}function r(e){if(Array.isArray(e))return e}function n(e,t){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(e)))return;var r=[];var n=true;var a=false;var i=undefined;try{for(var o=e[Symbol.iterator](),c;!(n=(c=o.next()).done);n=true){r.push(c.value);if(t&&r.length===t)break}}catch(e){a=true;i=e}finally{try{if(!n&&o["return"]!=null)o["return"]()}finally{if(a)throw i}}return r}function a(e,t){if(!e)return;if(typeof e==="string")return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor)r=e.constructor.name;if(r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}function o(e,t){if(t==null||t>e.length)t=e.length;for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function oe(e){var t=e.attr("stroke-width");e.attr("stroke-width",!t?0:t);if(!t)e.attr("stroke","transparent");var r=["none","transparent"].includes(e.attr("fill"));var n=e.attr("fill-opacity");e.attr("fill-opacity",r?0:n);e.attr("aria-label",null)}function ce(e){e.selectAll("*").each(function(){var e=this.tagName.toLowerCase();if(!["option"].includes(e)){var t=ae.select(this);var r=t.style("letter-spacing");t.style("letter-spacing",r==="normal"?"0.1px":r)}})}var s={background:false,callback:function e(){},exclude:[],padding:0,scale:1};var h={ignoreMouse:true,ignoreAnimation:true,ignoreDimensions:true,ignoreClear:true};function le(e){var t=ae.select(e).attr("transform");var r=1,n=0,a=0;if(t){r=t.match(/scale\(([^a-z]+)\)/i);if(r)r=parseFloat(r[1]);else r=1;var i=t.match(/translate\(([^a-z]+)\)/i);if(i){var o=i[1].replace(", ",",").replace(/([^a-z]),*\s([^a-z])/gi,"$1,$2").split(",").map(function(e){return parseFloat(e)*r});var c=ie(o,2);n=c[0];a=c[1]}}return[r,n,a]}function l(e,X){if(!e)return;if(!(e instanceof Array))e=[e];X=Object.assign({},s,X);var u=new RegExp(/(MSIE|Trident\/|Edge\/)/i).test(navigator.userAgent);var Y=window?window.devicePixelRatio||1:1;var t=e[0];if(t.constructor===Object)t=t.element;var U=X.height||parseFloat(ae.select(t).style("height"))+parseFloat(ae.select(t).style("padding-top"))+parseFloat(ae.select(t).style("padding-bottom")),K=X.width||parseFloat(ae.select(t).style("width"))+parseFloat(ae.select(t).style("padding-left"))+parseFloat(ae.select(t).style("padding-right"));var J,Q,Z=0,ee=0;if(t.getBoundingClientRect){var r=t.getBoundingClientRect();Z=r.left;ee=r.top}else{Z=t.offsetLeft;ee=t.offsetTop}var f=X.canvas||document.createElement("canvas");f.width=(K+X.padding*2)*X.scale*Y;f.height=(U+X.padding*2)*X.scale*Y;f.style.width=(K+X.padding*2)*X.scale;f.style.height=(U+X.padding*2)*X.scale;var v=f.getContext("2d");v.scale(X.scale*Y,X.scale*Y);v.clearRect(0,0,f.width/Y,f.height/Y);if(X.background){v.beginPath();v.rect(0,0,f.width/Y,f.height/Y);v.fillStyle=X.background;v.fill()}var te=[];function n(e){var t=(this.tagName||"").toLowerCase();if(X.exclude.includes(this)||t==="foreignobject")return;var r=Object.assign({},e);if(this.tagName){var n=ae.select(this).attr("opacity")||ae.select(this).style("opacity");var a=ae.select(this).style("display");var i=ae.select(this).style("visibility");if(a==="none"||i==="hidden"||n&&parseFloat(n)===0)return;var o=this.tagName.toLowerCase();if(o.length&&["defs","title","desc"].includes(o))return;if(o==="svg"){if(!r.svg){var c=this.getBoundingClientRect(),l=c.left,s=c.top;r.x+=l-Z;r.y+=s-ee;r.svg=true}var u=ae.select(this).attr("x");u=u?parseFloat(u)*r.scale:0;r.x+=u;var f=ae.select(this).attr("y");f=f?parseFloat(f)*r.scale:0;r.y+=f;r.clip={height:parseFloat(ae.select(this).attr("height")||ae.select(this).style("height")),width:parseFloat(ae.select(this).attr("width")||ae.select(this).style("width")),x:u,y:f}}else{var v=ae.select(this).attr("x");if(v)r.x+=parseFloat(v)*r.scale;var d=ae.select(this).attr("y");if(d)r.y+=parseFloat(d)*r.scale}}if(!t.length){var h=(this.wholeText||"").replace(/\s/g,"");if(h.length){var p=this.nodeValue.replace(/^\s*/,"").replace(/^\n/,"").replace(/^\s*/,"").replace(/\n$/,"").replace(/\s*$/,"").replace(/\n$/,"");te.push({type:"text",style:this.parentNode,value:p,x:r.x,y:r.y})}}else if(t==="text"){var g=this.cloneNode(true);ae.select(g).call(oe);te.push(Object.assign({},r,{type:"svg",value:g}))}else if(["image","img"].includes(t)){var y=ae.select(this).attr("href")||ae.select(this).attr("xlink:href");if(y.length){var m=parseFloat(ae.select(this).attr("height"))*r.scale,b=parseFloat(ae.select(this).attr("width"))*r.scale;var w={clip:r.clip,height:m,loaded:false,type:"img",width:b,x:r.x,y:r.y};te.push(w);var x=new Image;x.crossOrigin="Anonymous";x.onload=function(){var e=document.createElement("canvas");var t=e.getContext("2d");e.height=m*Y;e.width=b*Y;t.drawImage(this,0,0,b*Y,m*Y);var r=document.createElement("img");r.src=e.toDataURL("image/png");w.value=r;w.loaded=true};x.onerror=function(){w.loaded=true;w.value=false};x.src=y}}else if(!["svg","g","text"].includes(t)&&!ae.select(this).selectAll("svg").size()){var O=X.scale*Y;var S={height:Math.floor(U+X.padding*2+ee),loaded:false,type:"html",width:Math.floor(K+X.padding*2+Z),x:Math.floor(J-Z),y:Math.floor(Q-ee)};var j=document.createElement("canvas");j.width=S.width*O;j.height=S.height*O;j.style.width="".concat(S.width*O,"px");j.style.height="".concat(S.height*O,"px");var E=j.getContext("2d");E.scale(O,O);te.push(S);ce(ae.select(this));ne(this,{allowTaint:true,canvas:j,letterRendering:true}).then(function(e){S.value=e;S.loaded=true})}else if(t!=="svg"&&this.childNodes.length>0&&!ae.select(this).selectAll("image, img, svg").size()){var A=this.cloneNode(true);ae.select(A).selectAll("*").each(function(){ae.select(this).call(oe);if(ae.select(this).attr("opacity")==="0")this.parentNode.removeChild(this)});te.push(Object.assign({},r,{type:"svg",value:A,tag:t}))}else if(this.childNodes.length>0){var T=le(this),k=ie(T,3),C=k[0],F=k[1],M=k[2];r.scale*=C;r.x+=F;r.y+=M;re(this,r)}else{var P=this.cloneNode(true);ae.select(P).selectAll("*").each(function(){if(ae.select(this).attr("opacity")==="0")this.parentNode.removeChild(this)});if(t==="line"){ae.select(P).attr("x1",parseFloat(ae.select(P).attr("x1"))+r.x);ae.select(P).attr("x2",parseFloat(ae.select(P).attr("x2"))+r.x);ae.select(P).attr("y1",parseFloat(ae.select(P).attr("y1"))+r.y);ae.select(P).attr("y2",parseFloat(ae.select(P).attr("y2"))+r.y)}else if(t==="path"){var N=le(P),L=ie(N,3),I=L[0],z=L[1],R=L[2];if(ae.select(P).attr("transform"))ae.select(P).attr("transform","scale(".concat(I,")translate(").concat(z+r.x,",").concat(R+r.y,")"))}ae.select(P).call(oe);var _=ae.select(P).attr("fill");var q=_&&_.indexOf("url")===0;te.push(Object.assign({},r,{type:"svg",value:P,tag:t}));if(q){var B=ae.select(_.slice(4,-1)).node().cloneNode(true);var V=(B.tagName||"").toLowerCase();if(V==="pattern"){var W=le(P),D=ie(W,3),G=D[0],H=D[1],$=D[2];r.scale*=G;r.x+=H;r.y+=$;re(B,r)}}}}function re(e,t){ae.selectAll(e.childNodes).each(function(){n.bind(this)(t)})}for(var a=0;a<e.length;a++){var i=e[a],o={scale:1,x:0,y:0,svg:false};if(i.constructor===Object){o=Object.assign(o,i);i=i.element}J=o.x;Q=o.y;n.bind(i)(o)}function c(){var e=true;for(var t=0;t<te.length;t++){if(te[t].loaded===false){e=false;break}}if(e)l();else setTimeout(c,500)}c();function l(){for(var e=0;e<te.length;e++){var t=te[e];var r=t.clip||{height:U,width:K,x:0,y:0};switch(t.type){case"img":if(t.value){v.save();v.beginPath();v.translate(X.padding+r.x,X.padding+r.y);v.rect(0,0,r.width,r.height);v.clip();v.drawImage(t.value,t.x+r.x,t.y+r.y,t.width,t.height);v.restore()}break;case"html":v.save();v.beginPath();v.translate(X.padding,X.padding);v.drawImage(t.value,t.x,t.y,t.width,t.height);v.restore();break;case"text":var n=ae.select(t.style);var a=t.value.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");var i=n.style("color"),o=n.style("font-size");var c=n.style("font-family").split(",")[0];if(c.indexOf("'")!==0)c="'".concat(c,"'");var l="<text stroke='none' dy='".concat(o,"' fill='").concat(i,"' font-family=").concat(c," font-size='").concat(o,"'>").concat(a,"</text>");v.save();v.translate(X.padding,X.padding);d(f,l,Object.assign({},h,{offsetX:t.x,offsetY:t.y}));v.restore();break;case"svg":var s=u?(new XMLSerializer).serializeToString(t.value):t.value.outerHTML;v.save();v.translate(X.padding+r.x+t.x,X.padding+r.y+t.y);v.rect(0,0,r.width,r.height);v.clip();d(f,s,Object.assign({},h,{offsetX:t.x+r.x,offsetY:t.y+r.y}));v.restore();break;default:console.warn("uncaught",t);break}}X.callback(f)}}var u={filename:"download",type:"png"};function f(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!e)return;r=Object.assign({},u,r);var t=new RegExp(/(MSIE|Trident\/|Edge\/)/i).test(navigator.userAgent);if(!(e instanceof Array)&&r.type==="svg"){var a=t?(new XMLSerializer).serializeToString(e):e.outerHTML;i.saveAs(new Blob([a],{type:"application/svg+xml"}),"".concat(r.filename,".svg"))}l(e,Object.assign({},n,{callback:function e(t){if(n.callback)n.callback(t);if(["jpg","png"].includes(r.type)){t.toBlob(function(e){return i.saveAs(e,"".concat(r.filename,".").concat(r.type))})}}}))}e.dom2canvas=l;e.saveElement=f;Object.defineProperty(e,"__esModule",{value:true})});