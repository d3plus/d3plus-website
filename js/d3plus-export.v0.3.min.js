/*
  d3plus-export v0.3.17
  Export methods for transforming and downloading SVG.
  Copyright (c) 2019 D3plus - https://d3plus.org
  @license MIT
*/
(function(e){typeof define==="function"&&define.amd?define(e):e()})(function(){"use strict";var e=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function t(e,t){return t={exports:{}},e(t,t.exports),t.exports}var r=function(e){return e&&e.Math==Math&&e};var f=r(typeof globalThis=="object"&&globalThis)||r(typeof window=="object"&&window)||r(typeof self=="object"&&self)||r(typeof e=="object"&&e)||Function("return this")();var n=function(e){try{return!!e()}catch(e){return true}};var h=!n(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7});var a={}.propertyIsEnumerable;var i=Object.getOwnPropertyDescriptor;var o=i&&!a.call({1:2},1);var l=o?function e(t){var r=i(this,t);return!!r&&r.enumerable}:a;var d={f:l};var s=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}};var c={}.toString;var u=function(e){return c.call(e).slice(8,-1)};var v="".split;var w=n(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return u(e)=="String"?v.call(e,""):Object(e)}:Object;var p=function(e){if(e==undefined)throw TypeError("Can't call method on "+e);return e};var g=function(e){return w(p(e))};var y=function(e){return typeof e==="object"?e!==null:typeof e==="function"};var m=function(e,t){if(!y(e))return e;var r,n;if(t&&typeof(r=e.toString)=="function"&&!y(n=r.call(e)))return n;if(typeof(r=e.valueOf)=="function"&&!y(n=r.call(e)))return n;if(!t&&typeof(r=e.toString)=="function"&&!y(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")};var b={}.hasOwnProperty;var x=function(e,t){return b.call(e,t)};var O=f.document;var j=y(O)&&y(O.createElement);var S=function(e){return j?O.createElement(e):{}};var E=!h&&!n(function(){return Object.defineProperty(S("div"),"a",{get:function(){return 7}}).a!=7});var T=Object.getOwnPropertyDescriptor;var k=h?T:function e(t,r){t=g(t);r=m(r,true);if(E)try{return T(t,r)}catch(e){}if(x(t,r))return s(!d.f.call(t,r),t[r])};var A={f:k};var F=function(e){if(!y(e)){throw TypeError(String(e)+" is not an object")}return e};var M=Object.defineProperty;var P=h?M:function e(t,r,n){F(t);r=m(r,true);F(n);if(E)try{return M(t,r,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");if("value"in n)t[r]=n.value;return t};var C={f:P};var N=h?function(e,t,r){return C.f(e,t,s(1,r))}:function(e,t,r){e[t]=r;return e};var L=function(t,r){try{N(f,t,r)}catch(e){f[t]=r}return r};var z="__core-js_shared__";var I=f[z]||L(z,{});var R=I;var _=t(function(e){(e.exports=function(e,t){return R[e]||(R[e]=t!==undefined?t:{})})("versions",[]).push({version:"3.4.7",mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})});var q=Function.toString;var B=_("inspectSource",function(e){return q.call(e)});var D=f.WeakMap;var W=typeof D==="function"&&/native code/.test(B(D));var V=0;var G=Math.random();var H=function(e){return"Symbol("+String(e===undefined?"":e)+")_"+(++V+G).toString(36)};var $=_("keys");var X=function(e){return $[e]||($[e]=H(e))};var Y={};var K=f.WeakMap;var U,J,Q;var Z=function(e){return Q(e)?J(e):U(e,{})};var ee=function(r){return function(e){var t;if(!y(e)||(t=J(e)).type!==r){throw TypeError("Incompatible receiver, "+r+" required")}return t}};if(W){var te=new K;var re=te.get;var ne=te.has;var ae=te.set;U=function(e,t){ae.call(te,e,t);return t};J=function(e){return re.call(te,e)||{}};Q=function(e){return ne.call(te,e)}}else{var ie=X("state");Y[ie]=true;U=function(e,t){N(e,ie,t);return t};J=function(e){return x(e,ie)?e[ie]:{}};Q=function(e){return x(e,ie)}}var oe={set:U,get:J,has:Q,enforce:Z,getterFor:ee};var le=t(function(e){var t=oe.get;var l=oe.enforce;var s=String(String).split("String");(e.exports=function(e,t,r,n){var a=n?!!n.unsafe:false;var i=n?!!n.enumerable:false;var o=n?!!n.noTargetGet:false;if(typeof r=="function"){if(typeof t=="string"&&!x(r,"name"))N(r,"name",t);l(r).source=s.join(typeof t=="string"?t:"")}if(e===f){if(i)e[t]=r;else L(t,r);return}else if(!a){delete e[t]}else if(!o&&e[t]){i=true}if(i)e[t]=r;else N(e,t,r)})(Function.prototype,"toString",function e(){return typeof this=="function"&&t(this).source||B(this)})});var se=f;var ce=function(e){return typeof e=="function"?e:undefined};var ue=function(e,t){return arguments.length<2?ce(se[e])||ce(f[e]):se[e]&&se[e][t]||f[e]&&f[e][t]};var fe=Math.ceil;var ve=Math.floor;var he=function(e){return isNaN(e=+e)?0:(e>0?ve:fe)(e)};var de=Math.min;var pe=function(e){return e>0?de(he(e),9007199254740991):0};var ge=Math.max;var ye=Math.min;var me=function(e,t){var r=he(e);return r<0?ge(r+t,0):ye(r,t)};var be=function(l){return function(e,t,r){var n=g(e);var a=pe(n.length);var i=me(r,a);var o;if(l&&t!=t)while(a>i){o=n[i++];if(o!=o)return true}else for(;a>i;i++){if((l||i in n)&&n[i]===t)return l||i||0}return!l&&-1}};var we={includes:be(true),indexOf:be(false)};var xe=we.indexOf;var Oe=function(e,t){var r=g(e);var n=0;var a=[];var i;for(i in r)!x(Y,i)&&x(r,i)&&a.push(i);while(t.length>n)if(x(r,i=t[n++])){~xe(a,i)||a.push(i)}return a};var je=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];var Se=je.concat("length","prototype");var Ee=Object.getOwnPropertyNames||function e(t){return Oe(t,Se)};var Te={f:Ee};var ke=Object.getOwnPropertySymbols;var Ae={f:ke};var Fe=ue("Reflect","ownKeys")||function e(t){var r=Te.f(F(t));var n=Ae.f;return n?r.concat(n(t)):r};var Me=function(e,t){var r=Fe(t);var n=C.f;var a=A.f;for(var i=0;i<r.length;i++){var o=r[i];if(!x(e,o))n(e,o,a(t,o))}};var Pe=/#|\.prototype\./;var Ce=function(e,t){var r=Le[Ne(e)];return r==Ie?true:r==ze?false:typeof t=="function"?n(t):!!t};var Ne=Ce.normalize=function(e){return String(e).replace(Pe,".").toLowerCase()};var Le=Ce.data={};var ze=Ce.NATIVE="N";var Ie=Ce.POLYFILL="P";var Re=Ce;var _e=A.f;var qe=function(e,t){var r=e.target;var n=e.global;var a=e.stat;var i,o,l,s,c,u;if(n){o=f}else if(a){o=f[r]||L(r,{})}else{o=(f[r]||{}).prototype}if(o)for(l in t){c=t[l];if(e.noTargetGet){u=_e(o,l);s=u&&u.value}else s=o[l];i=Re(n?l:r+(a?".":"#")+l,e.forced);if(!i&&s!==undefined){if(typeof c===typeof s)continue;Me(c,s)}if(e.sham||s&&s.sham){N(c,"sham",true)}le(o,l,c,e)}};var Be=function(e){if(typeof e!="function"){throw TypeError(String(e)+" is not a function")}return e};var De=function(n,a,e){Be(n);if(a===undefined)return n;switch(e){case 0:return function(){return n.call(a)};case 1:return function(e){return n.call(a,e)};case 2:return function(e,t){return n.call(a,e,t)};case 3:return function(e,t,r){return n.call(a,e,t,r)}}return function(){return n.apply(a,arguments)}};var We=function(e){return Object(p(e))};var Ve=Array.isArray||function e(t){return u(t)=="Array"};var Ge=!!Object.getOwnPropertySymbols&&!n(function(){return!String(Symbol())});var He=Ge&&!Symbol.sham&&typeof Symbol()=="symbol";var $e=_("wks");var Xe=f.Symbol;var Ye=He?Xe:H;var Ke=function(e){if(!x($e,e)){if(Ge&&x(Xe,e))$e[e]=Xe[e];else $e[e]=Ye("Symbol."+e)}return $e[e]};var Ue=Ke("species");var Je=function(e,t){var r;if(Ve(e)){r=e.constructor;if(typeof r=="function"&&(r===Array||Ve(r.prototype)))r=undefined;else if(y(r)){r=r[Ue];if(r===null)r=undefined}}return new(r===undefined?Array:r)(t===0?0:t)};var Qe=[].push;var Ze=function(h){var d=h==1;var p=h==2;var g=h==3;var y=h==4;var m=h==6;var b=h==5||m;return function(e,t,r,n){var a=We(e);var i=w(a);var o=De(t,r,3);var l=pe(i.length);var s=0;var c=n||Je;var u=d?c(e,l):p?c(e,0):undefined;var f,v;for(;l>s;s++)if(b||s in i){f=i[s];v=o(f,s,a);if(h){if(d)u[s]=v;else if(v)switch(h){case 3:return true;case 5:return f;case 6:return s;case 2:Qe.call(u,f)}else if(y)return false}}return m?-1:g||y?y:u}};var et={forEach:Ze(0),map:Ze(1),filter:Ze(2),some:Ze(3),every:Ze(4),find:Ze(5),findIndex:Ze(6)};var tt=Object.keys||function e(t){return Oe(t,je)};var rt=h?Object.defineProperties:function e(t,r){F(t);var n=tt(r);var a=n.length;var i=0;var o;while(a>i)C.f(t,o=n[i++],r[o]);return t};var nt=ue("document","documentElement");var at=X("IE_PROTO");var it="prototype";var ot=function(){};var lt=function(){var e=S("iframe");var t=je.length;var r="<";var n="script";var a=">";var i="java"+n+":";var o;e.style.display="none";nt.appendChild(e);e.src=String(i);o=e.contentWindow.document;o.open();o.write(r+n+a+"document.F=Object"+r+"/"+n+a);o.close();lt=o.F;while(t--)delete lt[it][je[t]];return lt()};var st=Object.create||function e(t,r){var n;if(t!==null){ot[it]=F(t);n=new ot;ot[it]=null;n[at]=t}else n=lt();return r===undefined?n:rt(n,r)};Y[at]=true;var ct=Ke("unscopables");var ut=Array.prototype;if(ut[ct]==undefined){N(ut,ct,st(null))}var ft=function(e){ut[ct][e]=true};var vt=et.find;var ht="find";var dt=true;if(ht in[])Array(1)[ht](function(){dt=false});qe({target:"Array",proto:true,forced:dt},{find:function e(t){return vt(this,t,arguments.length>1?arguments[1]:undefined)}});ft(ht);var pt=we.includes;qe({target:"Array",proto:true},{includes:function e(t){return pt(this,t,arguments.length>1?arguments[1]:undefined)}});ft("includes");var gt=Object.assign;var yt=Object.defineProperty;var mt=!gt||n(function(){if(h&&gt({b:1},gt(yt({},"a",{enumerable:true,get:function(){yt(this,"b",{value:3,enumerable:false})}}),{b:2})).b!==1)return true;var e={};var t={};var r=Symbol();var n="abcdefghijklmnopqrst";e[r]=7;n.split("").forEach(function(e){t[e]=e});return gt({},e)[r]!=7||tt(gt({},t)).join("")!=n})?function e(t,r){var n=We(t);var a=arguments.length;var i=1;var o=Ae.f;var l=d.f;while(a>i){var s=w(arguments[i++]);var c=o?tt(s).concat(o(s)):tt(s);var u=c.length;var f=0;var v;while(u>f){v=c[f++];if(!h||l.call(s,v))n[v]=s[v]}}return n}:gt;qe({target:"Object",stat:true,forced:Object.assign!==mt},{assign:mt});var bt=Ke("match");var wt=function(e){var t;return y(e)&&((t=e[bt])!==undefined?!!t:u(e)=="RegExp")};var xt=function(e){if(wt(e)){throw TypeError("The method doesn't accept regular expressions")}return e};var Ot=Ke("match");var jt=function(t){var r=/./;try{"/./"[t](r)}catch(e){try{r[Ot]=false;return"/./"[t](r)}catch(e){}}return false};qe({target:"String",proto:true,forced:!jt("includes")},{includes:function e(t){return!!~String(p(this)).indexOf(xt(t),arguments.length>1?arguments[1]:undefined)}});var St=A.f;var Et="".startsWith;var Tt=Math.min;var kt=jt("startsWith");var At=!kt&&!!function(){var e=St(String.prototype,"startsWith");return e&&!e.writable}();qe({target:"String",proto:true,forced:!At&&!kt},{startsWith:function e(t){var r=String(p(this));xt(t);var n=pe(Tt(arguments.length>1?arguments[1]:undefined,r.length));var a=String(t);return Et?Et.call(r,a,n):r.slice(n,n+a.length)===a}});if(typeof window!=="undefined"){(function(){var n=function(e,t){var r=e.nodeType;if(r===3){t.push(e.textContent.replace(/&/,"&amp;").replace(/</,"&lt;").replace(">","&gt;"))}else if(r===1){t.push("<",e.tagName);if(e.hasAttributes()){[].forEach.call(e.attributes,function(e){t.push(" ",e.item.name,"='",e.item.value,"'")})}if(e.hasChildNodes()){t.push(">");[].forEach.call(e.childNodes,function(e){n(e,t)});t.push("</",e.tagName,">")}else{t.push("/>")}}else if(r==8){t.push("\x3c!--",e.nodeValue,"--\x3e")}};Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){var e=[];var t=this.firstChild;while(t){n(t,e);t=t.nextSibling}return e.join("")},set:function(e){while(this.firstChild){this.removeChild(this.firstChild)}try{var t=new DOMParser;t.async=false;var r="<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>"+e+"</svg>";var n=t.parseFromString(r,"text/xml").documentElement;var a=n.firstChild;while(a){this.appendChild(this.ownerDocument.importNode(a,true));a=a.nextSibling}}catch(e){}}});Object.defineProperty(SVGElement.prototype,"innerSVG",{get:function(){return this.innerHTML},set:function(e){this.innerHTML=e}})})()}});(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?t(exports,require("html2canvas"),require("canvg-browser"),require("d3-selection"),require("canvas-toBlob"),require("file-saver")):typeof define==="function"&&define.amd?define("d3plus-export",["exports","html2canvas","canvg-browser","d3-selection","canvas-toBlob","file-saver"],t):(e=e||self,t(e.d3plus={},e.html2canvas,e.canvg,e.d3Selection,null,e.fileSaver))})(this,function(e,ne,h,ae,t,i){"use strict";ne=ne&&ne.hasOwnProperty("default")?ne["default"]:ne;h=h&&h.hasOwnProperty("default")?h["default"]:h;function ie(e,t){return r(e)||n(e,t)||a()}function r(e){if(Array.isArray(e))return e}function n(e,t){if(!(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")){return}var r=[];var n=true;var a=false;var i=undefined;try{for(var o=e[Symbol.iterator](),l;!(n=(l=o.next()).done);n=true){r.push(l.value);if(t&&r.length===t)break}}catch(e){a=true;i=e}finally{try{if(!n&&o["return"]!=null)o["return"]()}finally{if(a)throw i}}return r}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function oe(e){var t=e.attr("stroke-width");e.attr("stroke-width",!t?0:t);if(!t)e.attr("stroke","transparent");var r=["none","transparent"].includes(e.attr("fill"));var n=e.attr("fill-opacity");e.attr("fill-opacity",r?0:n);e.attr("aria-label",null)}function le(e){e.selectAll("*").each(function(){var e=this.tagName.toLowerCase();if(!["option"].includes(e)){var t=ae.select(this);var r=t.style("letter-spacing");t.style("letter-spacing",r==="normal"?"0.1px":r)}})}var c={background:false,callback:function e(){},exclude:[],padding:0,scale:1};var d={ignoreMouse:true,ignoreAnimation:true,ignoreDimensions:true,ignoreClear:true};function se(e){var t=ae.select(e).attr("transform");var r=1,n=0,a=0;if(t){r=t.match(/scale\(([^a-z]+)\)/i);if(r)r=parseFloat(r[1]);else r=1;var i=t.match(/translate\(([^a-z]+)\)/i);if(i){var o=i[1].replace(", ",",").replace(/([^a-z]),*\s([^a-z])/gi,"$1,$2").split(",").map(function(e){return parseFloat(e)*r});var l=ie(o,2);n=l[0];a=l[1]}}return[r,n,a]}function o(e,X){if(!e)return;if(!(e instanceof Array))e=[e];X=Object.assign({},c,X);var u=new RegExp(/(MSIE|Trident\/|Edge\/)/i).test(navigator.userAgent);var Y=window?window.devicePixelRatio||1:1;var t=e[0];if(t.constructor===Object)t=t.element;var K=X.height||parseFloat(ae.select(t).style("height"))+parseFloat(ae.select(t).style("padding-top"))+parseFloat(ae.select(t).style("padding-bottom")),U=X.width||parseFloat(ae.select(t).style("width"))+parseFloat(ae.select(t).style("padding-left"))+parseFloat(ae.select(t).style("padding-right"));var J,Q,Z=0,ee=0;if(t.getBoundingClientRect){var r=t.getBoundingClientRect();Z=r.left;ee=r.top}else{Z=t.offsetLeft;ee=t.offsetTop}var f=document.createElement("canvas");f.width=(U+X.padding*2)*X.scale*Y;f.height=(K+X.padding*2)*X.scale*Y;f.style.width=(U+X.padding*2)*X.scale;f.style.height=(K+X.padding*2)*X.scale;var v=f.getContext("2d");v.scale(X.scale*Y,X.scale*Y);v.clearRect(0,0,f.width/Y,f.height/Y);if(X.background){v.beginPath();v.rect(0,0,f.width/Y,f.height/Y);v.fillStyle=X.background;v.fill()}var te=[];function n(e){var t=(this.tagName||"").toLowerCase();if(X.exclude.includes(this)||t==="foreignobject")return;var r=Object.assign({},e);if(this.tagName){var n=ae.select(this).attr("opacity")||ae.select(this).style("opacity");var a=ae.select(this).style("display");var i=ae.select(this).style("visibility");if(a==="none"||i==="hidden"||n&&parseFloat(n)===0)return;var o=this.tagName.toLowerCase();if(o.length&&["defs","title","desc"].includes(o))return;if(o==="svg"){if(!r.svg){var l=this.getBoundingClientRect(),s=l.left,c=l.top;r.x+=s-Z;r.y+=c-ee;r.svg=true}var u=ae.select(this).attr("x");u=u?parseFloat(u)*r.scale:0;r.x+=u;var f=ae.select(this).attr("y");f=f?parseFloat(f)*r.scale:0;r.y+=f;r.clip={height:parseFloat(ae.select(this).attr("height")||ae.select(this).style("height")),width:parseFloat(ae.select(this).attr("width")||ae.select(this).style("width")),x:u,y:f}}else{var v=ae.select(this).attr("x");if(v)r.x+=parseFloat(v)*r.scale;var h=ae.select(this).attr("y");if(h)r.y+=parseFloat(h)*r.scale}}if(!t.length){var d=(this.wholeText||"").replace(/\s/g,"");if(d.length){var p=this.nodeValue.replace(/^\s*/,"").replace(/^\n/,"").replace(/^\s*/,"").replace(/\n$/,"").replace(/\s*$/,"").replace(/\n$/,"");te.push({type:"text",style:this.parentNode,value:p,x:r.x,y:r.y})}}else if(t==="text"){var g=this.cloneNode(true);ae.select(g).call(oe);te.push(Object.assign({},r,{type:"svg",value:g}))}else if(["image","img"].includes(t)){var y=ae.select(this).attr("href")||ae.select(this).attr("xlink:href");if(y.length){var m=parseFloat(ae.select(this).attr("height"))*r.scale,b=parseFloat(ae.select(this).attr("width"))*r.scale;var w={clip:r.clip,height:m,loaded:false,type:"img",width:b,x:r.x,y:r.y};te.push(w);var x=new Image;x.crossOrigin="Anonymous";x.onload=function(){var e=document.createElement("canvas");var t=e.getContext("2d");e.height=m*Y;e.width=b*Y;t.drawImage(this,0,0,b*Y,m*Y);var r=document.createElement("img");r.src=e.toDataURL("image/png");w.value=r;w.loaded=true};x.onerror=function(){w.loaded=true;w.value=false};x.src=y}}else if(!["svg","g","text"].includes(t)&&!ae.select(this).selectAll("svg").size()){var O=X.scale*Y;var j={height:Math.floor(K+X.padding*2+ee),loaded:false,type:"html",width:Math.floor(U+X.padding*2+Z),x:Math.floor(J-Z),y:Math.floor(Q-ee)};var S=document.createElement("canvas");S.width=j.width*O;S.height=j.height*O;S.style.width="".concat(j.width*O,"px");S.style.height="".concat(j.height*O,"px");var E=S.getContext("2d");E.scale(O,O);te.push(j);le(ae.select(this));ne(this,{allowTaint:true,canvas:S,letterRendering:true}).then(function(e){j.value=e;j.loaded=true})}else if(t!=="svg"&&this.childNodes.length>0&&!ae.select(this).selectAll("image, img, svg").size()){var T=this.cloneNode(true);ae.select(T).selectAll("*").each(function(){ae.select(this).call(oe);if(ae.select(this).attr("opacity")==="0")this.parentNode.removeChild(this)});te.push(Object.assign({},r,{type:"svg",value:T,tag:t}))}else if(this.childNodes.length>0){var k=se(this),A=ie(k,3),F=A[0],M=A[1],P=A[2];r.scale*=F;r.x+=M;r.y+=P;re(this,r)}else{var C=this.cloneNode(true);ae.select(C).selectAll("*").each(function(){if(ae.select(this).attr("opacity")==="0")this.parentNode.removeChild(this)});if(t==="line"){ae.select(C).attr("x1",parseFloat(ae.select(C).attr("x1"))+r.x);ae.select(C).attr("x2",parseFloat(ae.select(C).attr("x2"))+r.x);ae.select(C).attr("y1",parseFloat(ae.select(C).attr("y1"))+r.y);ae.select(C).attr("y2",parseFloat(ae.select(C).attr("y2"))+r.y)}else if(t==="path"){var N=se(C),L=ie(N,3),z=L[0],I=L[1],R=L[2];if(ae.select(C).attr("transform"))ae.select(C).attr("transform","scale(".concat(z,")translate(").concat(I+r.x,",").concat(R+r.y,")"))}ae.select(C).call(oe);var _=ae.select(C).attr("fill");var q=_&&_.indexOf("url")===0;te.push(Object.assign({},r,{type:"svg",value:C,tag:t}));if(q){var B=ae.select(_.slice(4,-1)).node().cloneNode(true);var D=(B.tagName||"").toLowerCase();if(D==="pattern"){var W=se(C),V=ie(W,3),G=V[0],H=V[1],$=V[2];r.scale*=G;r.x+=H;r.y+=$;re(B,r)}}}}function re(e,t){ae.selectAll(e.childNodes).each(function(){n.bind(this)(t)})}for(var a=0;a<e.length;a++){var i=e[a],o={scale:1,x:0,y:0,svg:false};if(i.constructor===Object){o=Object.assign(o,i);i=i.element}J=o.x;Q=o.y;n.bind(i)(o)}function l(){var e=true;for(var t=0;t<te.length;t++){if(te[t].loaded===false){e=false;break}}if(e)s();else setTimeout(l,500)}l();function s(){for(var e=0;e<te.length;e++){var t=te[e];var r=t.clip||{height:K,width:U,x:0,y:0};switch(t.type){case"img":if(t.value){v.save();v.beginPath();v.translate(X.padding+r.x,X.padding+r.y);v.rect(0,0,r.width,r.height);v.clip();v.drawImage(t.value,t.x+r.x,t.y+r.y,t.width,t.height);v.restore()}break;case"html":v.save();v.beginPath();v.translate(X.padding,X.padding);v.drawImage(t.value,t.x,t.y,t.width,t.height);v.restore();break;case"text":var n=ae.select(t.style);var a=t.value.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");var i=n.style("color"),o=n.style("font-size");var l=n.style("font-family").split(",")[0];if(l.indexOf("'")!==0)l="'".concat(l,"'");var s="<text stroke='none' dy='".concat(o,"' fill='").concat(i,"' font-family=").concat(l," font-size='").concat(o,"'>").concat(a,"</text>");v.save();v.translate(X.padding,X.padding);h(f,s,Object.assign({},d,{offsetX:t.x,offsetY:t.y}));v.restore();break;case"svg":var c=u?(new XMLSerializer).serializeToString(t.value):t.value.outerHTML;v.save();v.translate(X.padding+r.x+t.x,X.padding+r.y+t.y);v.rect(0,0,r.width,r.height);v.clip();h(f,c,Object.assign({},d,{offsetX:t.x+r.x,offsetY:t.y+r.y}));v.restore();break;default:console.warn("uncaught",t);break}}X.callback(f)}}var l={filename:"download",type:"png"};function s(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!e)return;r=Object.assign({},l,r);var t=new RegExp(/(MSIE|Trident\/|Edge\/)/i).test(navigator.userAgent);if(!(e instanceof Array)&&r.type==="svg"){var a=t?(new XMLSerializer).serializeToString(e):e.outerHTML;i.saveAs(new Blob([a],{type:"application/svg+xml"}),"".concat(r.filename,".svg"))}o(e,Object.assign({},n,{callback:function e(t){if(n.callback)n.callback(t);if(["jpg","png"].includes(r.type)){t.toBlob(function(e){return i.saveAs(e,"".concat(r.filename,".").concat(r.type))})}}}))}e.dom2canvas=o;e.saveElement=s;Object.defineProperty(e,"__esModule",{value:true})});