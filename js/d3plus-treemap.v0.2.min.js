!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3plus-color"),require("d3plus-common"),require("d3plus-shape"),require("d3plus-legend"),require("d3-collection"),require("d3-hierarchy"),require("d3-selection")):"function"==typeof define&&define.amd?define("d3plus-treemap",["exports","d3plus-color","d3plus-common","d3plus-shape","d3plus-legend","d3-collection","d3-hierarchy","d3-selection"],t):t(e.d3plus_treemap=e.d3plus_treemap||{},e.d3plus_color,e.d3plus_common,e.d3plus_shape,e.d3plus_legend,e.d3_collection,e.d3_hierarchy,e.d3_selection)}(this,function(e,t,n,r,o,u,a,i){"use strict";function l(e){function l(e,t){return t.height-e.height||z(t.data)-z(e.data)}function s(r){function _(e){for(var t=0;t<e.length;t++){var r=e[t];r.depth<m.length?_(r.children):(r.id=m.length+r.data.key,r.data=n.merge(r.data.values),N.push(r))}}void 0===f?(s.size(n.getSize(i.select("body").node())),s.select(i.select("body").append("svg").style("width",h[0]+"px").style("height",h[1]+"px").style("display","block").node())):void 0===h&&s.size(n.getSize(f.node())),c=m[m.length-1];var q=p||c,A=d||function(e,n){return t.assign(c(e,n))},k=n.colorNest(e,A,m),w=f.selectAll("g.d3plus-treemap-legend").data(x?[0]:[]);w=w.enter().append("g").attr("class","d3plus-treemap-legend").attr("transform","translate(0,"+h[1]/2+")").merge(w),w.transition().duration(y).attr("transform","translate(0,"+h[1]/2+")");for(var B=o.shape().duration(y).data(k.data).fill(A).id(k.id).height(h[1]/2).label(k.id).select(w.node()).verticalAlign("bottom").width(h[0])(),P=h[1]-B.outerBounds().height-4*B.padding(),R=u.nest(),S=0;S<m.length;S++)R.key(m[S]);R=R.entries(e);var j=a.treemap().round(!0).size([h[0],P])(a.hierarchy({values:R},function(e){return e.values}).sort(l).sum(z)).children,N=[];j&&_(j);var T=f.selectAll("g.d3plus-treemap-shapes").data([0]);return T=T.enter().append("g").attr("class","d3plus-treemap-shapes").merge(T),g.data(N).duration(y).fill(function(e,t){return A(e.data,t)}).fontResize(function(e,t){return b(e.data,t)}).label(function(e,t){return q(e.data,t)}).labelPadding(function(e,t){return v(e.data,t)}).select(T.node())(),r&&setTimeout(r,y+100),s}void 0===e&&(e=[]);var d,c,p,f,h,g=r.rect().height(function(e){return e.y1-e.y0}).width(function(e){return e.x1-e.x0}).x(function(e){return e.x0+(e.x1-e.x0)/2}).y(function(e){return e.y0+(e.y1-e.y0)/2}),y=600,m=[n.accessor("id")],v=n.constant(5),b=n.constant(!0),x=!0,_=l,z=n.accessor("value");return s.data=function(t){return arguments.length?(e=t,s):e},s.duration=function(e){return arguments.length?(y=e,s):y},s.fill=function(e){return arguments.length?(d="function"==typeof e?e:n.constant(e),s):d},s.groupBy=function(e){return arguments.length?(e instanceof Array||(e=[e]),m=e.map(function(e){return"function"==typeof e?e:n.accessor(e)}),s):m},s.label=function(e){return arguments.length?(p="function"==typeof e?e:n.constant(e),s):p},s.labelPadding=function(e){return arguments.length?(v="function"==typeof e?e:n.constant(e),s):v},s.labelResize=function(e){return arguments.length?(b="function"==typeof e?e:n.constant(e),s):b},s.legend=function(e){return arguments.length?(x=e,s):x},s.select=function(e){return arguments.length?(f=i.select(e),s):f},s.sort=function(e){return arguments.length?(_=e,s):_},s.size=function(e){return arguments.length?(h=e,s):h},s.sum=function(e){return arguments.length?(z="function"==typeof e?e:n.constant(e),s):z},e.length?s():s}var s="0.2.0";e.version=s,e.layout=l});