/*
  d3plus-timeline v0.1.3
  An easy-to-use javascript timeline.
  Copyright (c) 2016 D3plus - https://d3plus.org
  @license MIT
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-brush"),require("d3-selection"),require("d3plus-axis"),require("d3plus-common")):"function"==typeof define&&define.amd?define("d3plus-timeline",["exports","d3-brush","d3-selection","d3plus-axis","d3plus-common"],e):e(t.d3plus=t.d3plus||{},t.d3Brush,t.d3Selection,t.d3plusAxis,t.d3plusCommon)}(this,function(t,e,i,n,s){"use strict";var o=function(t){function o(){var e=this;t.call(this),this._domain=[2001,2010],this._gridSize=0,this._handleConfig={fill:"#444"},this._handleSize=6,this._height=100,this._on={},this.orient("bottom"),this._scale="time",this._shape="Rect",this._shapeConfig=Object.assign({},this._shapeConfig,{height:10,on:{click:function(t){e._on.end&&e._on.end(t.id),e.selection(t.id).render()}},width:function(t){return e._domain.map(function(t){return n.date(t).getTime()}).includes(t.id)?2:1}})}return t&&(o.__proto__=t),o.prototype=Object.create(t&&t.prototype),o.prototype.constructor=o,o.prototype._brushEnd=function(){if(i.event.sourceEvent){var t=(i.event.selection?i.event.selection:[i.event.sourceEvent.offsetX,i.event.sourceEvent.offsetX]).map(this._d3Scale.invert).map(Number),e=this._visibleTicks.map(Number);t[0]=n.date(s.closest(t[0],e)),t[1]=n.date(s.closest(t[1],e));var o=t.map(this._d3Scale),h=o[0]===o[1];h&&(o[0]--,o[1]++),this._brushGroup.transition(this._transition).call(this._brush.move,o),this._on.end&&this._on.end(h?t[0]:t)}},o.prototype.render=function(i){t.prototype.render.call(this,i);var o=this._position,h=o.height,r=o.y,l="Circle"===this._shape?2*this._shapeConfig.r:"Rect"===this._shape?this._shapeConfig[h]:this._tickSize,c=this._outerBounds[r],a=this._d3Scale.range(),u=this._brush=e.brushX().extent([[a[0],c],[a[1],c+l]]).handleSize(this._handleSize).on("start",this._on.start||null).on("brush",this._on.brush||null).on("end",this._brushEnd.bind(this)),_=this._visibleTicks[this._visibleTicks.length-1],d=(void 0===this._selection?[_,_]:this._selection instanceof Array?this._selection.slice():[this._selection,this._selection]).map(n.date).map(this._d3Scale);d[0]===d[1]&&(d[0]--,d[1]++);var p=this._brushGroup=s.elem("g.brushGroup",{parent:this._group});return p.call(u).transition(this._transition).call(u.move,d),p.selectAll(".handle").transition(this._transition).call(s.attrize,this._handleConfig),this},o.prototype.handleConfig=function(t){return arguments.length?(this._handleConfig=Object.assign(this._handleConfig,t),this):this._handleConfig},o.prototype.handleSize=function(t){return arguments.length?(this._handleSize=t,this):this._handleSize},o.prototype.on=function(t,e){return 2===arguments.length?(this._on[t]=e,this):arguments.length?"string"==typeof t?this._on[t]:(this._on=Object.assign({},this._on,t),this):this._on},o.prototype.selectionConfig=function(t){return arguments.length?(this._selectionConfig=Object.assign(this._selectionConfig,t),this):this._selectionConfig},o.prototype.selection=function(t){return arguments.length?(this._selection=t,this):this._selection},o}(n.Axis);t.Timeline=o,Object.defineProperty(t,"__esModule",{value:!0})});