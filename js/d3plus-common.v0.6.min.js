/*
  d3plus-common v0.6.52
  Common functions and methods used across D3plus modules.
  Copyright (c) 2019 D3plus - https://d3plus.org
  @license MIT
*/
(function(r,n){typeof exports==="object"&&typeof module!=="undefined"?n(exports,require("d3-selection"),require("d3-transition"),require("d3-array"),require("d3-collection")):typeof define==="function"&&define.amd?define("d3plus-common",["exports","d3-selection","d3-transition","d3-array","d3-collection"],n):(r=r||self,n(r.d3plus={},r.d3Selection,r.d3Transition,r.d3Array,r.d3Collection))})(this,function(r,f,c,u,n){"use strict";function e(n,e){if(e===void 0)return function(r){return r[n]};return function(r){return r[n]===void 0?e:r[n]}}function l(r){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){l=function(r){return typeof r}}else{l=function(r){return r&&typeof Symbol==="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r}}return l(r)}function t(r,n){if(!(r instanceof n)){throw new TypeError("Cannot call a class as a function")}}function i(r,n){for(var e=0;e<n.length;e++){var t=n[e];t.enumerable=t.enumerable||false;t.configurable=true;if("value"in t)t.writable=true;Object.defineProperty(r,t.key,t)}}function a(r,n,e){if(n)i(r.prototype,n);if(e)i(r,e);return r}function s(r){return r&&l(r)==="object"&&(typeof window==="undefined"||r!==window&&r!==window.document&&!(r instanceof Element))&&!Array.isArray(r)?true:false}function o(r){if(typeof window==="undefined")return true;else return r!==window&&r!==document}function v(){var t=arguments;var i=arguments.length<=0?undefined:arguments[0];var r=function r(n){var e=n<0||t.length<=n?undefined:t[n];Object.keys(e).forEach(function(r){var n=e[r];if(s(n)&&o(n)){if(i.hasOwnProperty(r)&&s(i[r]))i[r]=v({},i[r],n);else i[r]=v({},n)}else if(Array.isArray(n))i[r]=n.slice();else i[r]=n})};for(var n=1;n<arguments.length;n++){r(n)}return i}function d(r){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};for(var e in n){if({}.hasOwnProperty.call(n,e))r.attr(e,n[e])}}function h(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}function p(){return"".concat(h()).concat(h(),"-").concat(h(),"-").concat(h(),"-").concat(h(),"-").concat(h()).concat(h()).concat(h())}var y="D3PLUS-COMMON-RESET";function g(r,n){if(s(r)){for(var e in r){if({}.hasOwnProperty.call(r,e)&&!e.startsWith("_")){var t=n&&s(n)?n[e]:undefined;if(r[e]===y){r[e]=t}else if(s(r[e])){g(r[e],t)}}}}}var m=function(){function r(){t(this,r);this._locale="en-US";this._on={};this._uuid=p()}a(r,[{key:"config",value:function r(n){if(!this._configDefault){var r={};for(var e in this.__proto__){if(e.indexOf("_")!==0&&!["config","constructor","render"].includes(e)){var t=this[e]();r[e]=s(t)?v({},t):t}}this._configDefault=r}if(arguments.length){for(var i in n){if({}.hasOwnProperty.call(n,i)&&i in this){var a=n[i];if(a===y){if(i==="on")this._on=this._configDefault[i];else this[i](this._configDefault[i])}else{g(a,this._configDefault[i]);this[i](a)}}}return this}else{var o={};for(var u in this.__proto__){if(u.indexOf("_")!==0&&!["config","constructor","render"].includes(u))o[u]=this[u]()}return o}}},{key:"locale",value:function r(n){return arguments.length?(this._locale=n,this):this._locale}},{key:"on",value:function r(n,e){return arguments.length===2?(this._on[n]=e,this):arguments.length?typeof n==="string"?this._on[n]:(this._on=Object.assign({},this._on,n),this):this._on}}]);return r}();function b(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(!r||!(r instanceof Array)||!r.length)return undefined;return r.reduce(function(r,n){return Math.abs(n-e)<Math.abs(r-e)?n:r})}function w(){var a=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this._shapeConfig;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"shape";var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var e={duration:this._duration,on:{}};var o=function r(i){return function(r,n,e){var t;while(r.__d3plus__){if(t)r.__d3plusParent__=t;t=r;n=r.i;r=r.data||r.feature}return i.bind(a)(r,n,e||t)}};var u=function r(n,e){for(var t in e){if({}.hasOwnProperty.call(e,t)&&!t.includes(".")||t.includes(".".concat(i))){n.on[t]=o(e[t])}}};var f=function n(r){return r.map(function(r){if(r instanceof Array)return n(r);else if(l(r)==="object")return t({},r);else if(typeof r==="function")return o(r);else return r})};var t=function r(n,e){for(var t in e){if({}.hasOwnProperty.call(e,t)){if(t==="on")u(n,e[t]);else if(typeof e[t]==="function"){n[t]=o(e[t])}else if(e[t]instanceof Array){n[t]=f(e[t])}else if(l(e[t])==="object"){n[t]={on:{}};r(n[t],e[t])}else n[t]=e[t]}}};t(e,r);if(this._on)u(e,this._on);if(n&&r[n]){t(e,r[n]);if(r[n].on)u(e,r[n].on)}return e}function O(n){return function r(){return n}}function _(r,n){n=Object.assign({},{condition:true,enter:{},exit:{},parent:f.select("body"),transition:c.transition().duration(0),update:{}},n);var e=/\.([^#]+)/g.exec(r),t=/#([^\.]+)/g.exec(r),i=/^([^.^#]+)/g.exec(r)[1];var a=n.parent.selectAll(r.includes(":")?r.split(":")[1]:r).data(n.condition?[null]:[]);var o=a.enter().append(i).call(d,n.enter);if(t)o.attr("id",t[1]);if(e)o.attr("class",e[1]);a.exit().transition(n.transition).call(d,n.exit).remove();var u=o.merge(a);u.transition(n.transition).call(d,n.update);return u}function S(r){return r.filter(function(r,n,e){return e.indexOf(r)===n})}function j(i){var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=S(u.merge(i.map(function(r){return n.keys(r)}))),o={};r.forEach(function(n){var r=i.map(function(r){return r[n]});var e;if(a[n])e=a[n](r);else{var t=r.map(function(r){return r||r===false?r.constructor:r}).filter(function(r){return r!==void 0});if(!t.length)e=undefined;else if(t.indexOf(Array)>=0){e=u.merge(r.map(function(r){return r instanceof Array?r:[r]}));e=S(e);if(e.length===1)e=e[0]}else if(t.indexOf(String)>=0){e=S(r);if(e.length===1)e=e[0]}else if(t.indexOf(Number)>=0)e=u.sum(r);else if(t.indexOf(Object)>=0)e=j(r.filter(function(r){return r}));else{e=S(r.filter(function(r){return r!==void 0}));if(e.length===1)e=e[0]}}o[n]=e});return o}function x(r){var i;if(typeof r==="number")i=[r];else i=r.split(/\s+/);if(i.length===1)i=[i[0],i[0],i[0],i[0]];else if(i.length===2)i=i.concat(i);else if(i.length===3)i.push(i[1]);return["top","right","bottom","left"].reduce(function(r,n,e){var t=parseFloat(i[e]);r[n]=t||0;return r},{})}function E(){if("-webkit-transform"in document.body.style)return"-webkit-";else if("-moz-transform"in document.body.style)return"-moz-";else if("-ms-transform"in document.body.style)return"-ms-";else if("-o-transform"in document.body.style)return"-o-";else return""}function P(r){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};for(var e in n){if({}.hasOwnProperty.call(n,e))r.style(e,n[e])}}r.BaseClass=m;r.RESET=y;r.accessor=e;r.assign=v;r.attrize=d;r.closest=b;r.configPrep=w;r.constant=O;r.elem=_;r.isObject=s;r.merge=j;r.parseSides=x;r.prefix=E;r.stylize=P;r.unique=S;r.uuid=p;Object.defineProperty(r,"__esModule",{value:true})});(function(r){typeof define==="function"&&define.amd?define(r):r()})(function(){"use strict";var r=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function n(r,n){return n={exports:{}},r(n,n.exports),n.exports}var e="object";var t=function(r){return r&&r.Math==Math&&r};var s=t(typeof globalThis==e&&globalThis)||t(typeof window==e&&window)||t(typeof self==e&&self)||t(typeof r==e&&r)||Function("return this")();var i=function(r){try{return!!r()}catch(r){return true}};var d=!i(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7});var a={}.propertyIsEnumerable;var o=Object.getOwnPropertyDescriptor;var u=o&&!a.call({1:2},1);var f=u?function r(n){var e=o(this,n);return!!e&&e.enumerable}:a;var h={f:f};var c=function(r,n){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:n}};var l={}.toString;var v=function(r){return l.call(r).slice(8,-1)};var p="".split;var w=i(function(){return!Object("z").propertyIsEnumerable(0)})?function(r){return v(r)=="String"?p.call(r,""):Object(r)}:Object;var y=function(r){if(r==undefined)throw TypeError("Can't call method on "+r);return r};var g=function(r){return w(y(r))};var m=function(r){return typeof r==="object"?r!==null:typeof r==="function"};var b=function(r,n){if(!m(r))return r;var e,t;if(n&&typeof(e=r.toString)=="function"&&!m(t=e.call(r)))return t;if(typeof(e=r.valueOf)=="function"&&!m(t=e.call(r)))return t;if(!n&&typeof(e=r.toString)=="function"&&!m(t=e.call(r)))return t;throw TypeError("Can't convert object to primitive value")};var O={}.hasOwnProperty;var _=function(r,n){return O.call(r,n)};var S=s.document;var j=m(S)&&m(S.createElement);var x=function(r){return j?S.createElement(r):{}};var E=!d&&!i(function(){return Object.defineProperty(x("div"),"a",{get:function(){return 7}}).a!=7});var P=Object.getOwnPropertyDescriptor;var T=d?P:function r(n,e){n=g(n);e=b(e,true);if(E)try{return P(n,e)}catch(r){}if(_(n,e))return c(!h.f.call(n,e),n[e])};var A={f:T};var M=function(r){if(!m(r)){throw TypeError(String(r)+" is not an object")}return r};var k=Object.defineProperty;var C=d?k:function r(n,e,t){M(n);e=b(e,true);M(t);if(E)try{return k(n,e,t)}catch(r){}if("get"in t||"set"in t)throw TypeError("Accessors not supported");if("value"in t)n[e]=t.value;return n};var N={f:C};var D=d?function(r,n,e){return N.f(r,n,c(1,e))}:function(r,n,e){r[n]=e;return r};var F=function(n,e){try{D(s,n,e)}catch(r){s[n]=e}return e};var L=n(function(r){var n="__core-js_shared__";var e=s[n]||F(n,{});(r.exports=function(r,n){return e[r]||(e[r]=n!==undefined?n:{})})("versions",[]).push({version:"3.1.3",mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})});var I=L("native-function-to-string",Function.toString);var q=s.WeakMap;var z=typeof q==="function"&&/native code/.test(I.call(q));var W=0;var G=Math.random();var R=function(r){return"Symbol("+String(r===undefined?"":r)+")_"+(++W+G).toString(36)};var V=L("keys");var H=function(r){return V[r]||(V[r]=R(r))};var U={};var B=s.WeakMap;var K,Y,J;var Q=function(r){return J(r)?Y(r):K(r,{})};var X=function(e){return function(r){var n;if(!m(r)||(n=Y(r)).type!==e){throw TypeError("Incompatible receiver, "+e+" required")}return n}};if(z){var Z=new B;var $=Z.get;var rr=Z.has;var nr=Z.set;K=function(r,n){nr.call(Z,r,n);return n};Y=function(r){return $.call(Z,r)||{}};J=function(r){return rr.call(Z,r)}}else{var er=H("state");U[er]=true;K=function(r,n){D(r,er,n);return n};Y=function(r){return _(r,er)?r[er]:{}};J=function(r){return _(r,er)}}var tr={set:K,get:Y,has:J,enforce:Q,getterFor:X};var ir=n(function(r){var n=tr.get;var u=tr.enforce;var f=String(I).split("toString");L("inspectSource",function(r){return I.call(r)});(r.exports=function(r,n,e,t){var i=t?!!t.unsafe:false;var a=t?!!t.enumerable:false;var o=t?!!t.noTargetGet:false;if(typeof e=="function"){if(typeof n=="string"&&!_(e,"name"))D(e,"name",n);u(e).source=f.join(typeof n=="string"?n:"")}if(r===s){if(a)r[n]=e;else F(n,e);return}else if(!i){delete r[n]}else if(!o&&r[n]){a=true}if(a)r[n]=e;else D(r,n,e)})(Function.prototype,"toString",function r(){return typeof this=="function"&&n(this).source||I.call(this)})});var ar=s;var or=function(r){return typeof r=="function"?r:undefined};var ur=function(r,n){return arguments.length<2?or(ar[r])||or(s[r]):ar[r]&&ar[r][n]||s[r]&&s[r][n]};var fr=Math.ceil;var cr=Math.floor;var lr=function(r){return isNaN(r=+r)?0:(r>0?cr:fr)(r)};var sr=Math.min;var vr=function(r){return r>0?sr(lr(r),9007199254740991):0};var dr=Math.max;var hr=Math.min;var pr=function(r,n){var e=lr(r);return e<0?dr(e+n,0):hr(e,n)};var yr=function(u){return function(r,n,e){var t=g(r);var i=vr(t.length);var a=pr(e,i);var o;if(u&&n!=n)while(i>a){o=t[a++];if(o!=o)return true}else for(;i>a;a++){if((u||a in t)&&t[a]===n)return u||a||0}return!u&&-1}};var gr={includes:yr(true),indexOf:yr(false)};var mr=gr.indexOf;var br=function(r,n){var e=g(r);var t=0;var i=[];var a;for(a in e)!_(U,a)&&_(e,a)&&i.push(a);while(n.length>t)if(_(e,a=n[t++])){~mr(i,a)||i.push(a)}return i};var wr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];var Or=wr.concat("length","prototype");var _r=Object.getOwnPropertyNames||function r(n){return br(n,Or)};var Sr={f:_r};var jr=Object.getOwnPropertySymbols;var xr={f:jr};var Er=ur("Reflect","ownKeys")||function r(n){var e=Sr.f(M(n));var t=xr.f;return t?e.concat(t(n)):e};var Pr=function(r,n){var e=Er(n);var t=N.f;var i=A.f;for(var a=0;a<e.length;a++){var o=e[a];if(!_(r,o))t(r,o,i(n,o))}};var Tr=/#|\.prototype\./;var Ar=function(r,n){var e=kr[Mr(r)];return e==Nr?true:e==Cr?false:typeof n=="function"?i(n):!!n};var Mr=Ar.normalize=function(r){return String(r).replace(Tr,".").toLowerCase()};var kr=Ar.data={};var Cr=Ar.NATIVE="N";var Nr=Ar.POLYFILL="P";var Dr=Ar;var Fr=A.f;var Lr=function(r,n){var e=r.target;var t=r.global;var i=r.stat;var a,o,u,f,c,l;if(t){o=s}else if(i){o=s[e]||F(e,{})}else{o=(s[e]||{}).prototype}if(o)for(u in n){c=n[u];if(r.noTargetGet){l=Fr(o,u);f=l&&l.value}else f=o[u];a=Dr(t?u:e+(i?".":"#")+u,r.forced);if(!a&&f!==undefined){if(typeof c===typeof f)continue;Pr(c,f)}if(r.sham||f&&f.sham){D(c,"sham",true)}ir(o,u,c,r)}};var Ir=function(r){if(typeof r!="function"){throw TypeError(String(r)+" is not a function")}return r};var qr=function(t,i,r){Ir(t);if(i===undefined)return t;switch(r){case 0:return function(){return t.call(i)};case 1:return function(r){return t.call(i,r)};case 2:return function(r,n){return t.call(i,r,n)};case 3:return function(r,n,e){return t.call(i,r,n,e)}}return function(){return t.apply(i,arguments)}};var zr=function(r){return Object(y(r))};var Wr=Array.isArray||function r(n){return v(n)=="Array"};var Gr=!!Object.getOwnPropertySymbols&&!i(function(){return!String(Symbol())});var Rr=s.Symbol;var Vr=L("wks");var Hr=function(r){return Vr[r]||(Vr[r]=Gr&&Rr[r]||(Gr?Rr:R)("Symbol."+r))};var Ur=Hr("species");var Br=function(r,n){var e;if(Wr(r)){e=r.constructor;if(typeof e=="function"&&(e===Array||Wr(e.prototype)))e=undefined;else if(m(e)){e=e[Ur];if(e===null)e=undefined}}return new(e===undefined?Array:e)(n===0?0:n)};var Kr=[].push;var Yr=function(d){var h=d==1;var p=d==2;var y=d==3;var g=d==4;var m=d==6;var b=d==5||m;return function(r,n,e,t){var i=zr(r);var a=w(i);var o=qr(n,e,3);var u=vr(a.length);var f=0;var c=t||Br;var l=h?c(r,u):p?c(r,0):undefined;var s,v;for(;u>f;f++)if(b||f in a){s=a[f];v=o(s,f,i);if(d){if(h)l[f]=v;else if(v)switch(d){case 3:return true;case 5:return s;case 6:return f;case 2:Kr.call(l,s)}else if(g)return false}}return m?-1:y||g?g:l}};var Jr={forEach:Yr(0),map:Yr(1),filter:Yr(2),some:Yr(3),every:Yr(4),find:Yr(5),findIndex:Yr(6)};var Qr=Object.keys||function r(n){return br(n,wr)};var Xr=d?Object.defineProperties:function r(n,e){M(n);var t=Qr(e);var i=t.length;var a=0;var o;while(i>a)N.f(n,o=t[a++],e[o]);return n};var Zr=ur("document","documentElement");var $r=H("IE_PROTO");var rn="prototype";var nn=function(){};var en=function(){var r=x("iframe");var n=wr.length;var e="<";var t="script";var i=">";var a="java"+t+":";var o;r.style.display="none";Zr.appendChild(r);r.src=String(a);o=r.contentWindow.document;o.open();o.write(e+t+i+"document.F=Object"+e+"/"+t+i);o.close();en=o.F;while(n--)delete en[rn][wr[n]];return en()};var tn=Object.create||function r(n,e){var t;if(n!==null){nn[rn]=M(n);t=new nn;nn[rn]=null;t[$r]=n}else t=en();return e===undefined?t:Xr(t,e)};U[$r]=true;var an=Hr("unscopables");var on=Array.prototype;if(on[an]==undefined){D(on,an,tn(null))}var un=function(r){on[an][r]=true};var fn=Jr.find;var cn="find";var ln=true;if(cn in[])Array(1)[cn](function(){ln=false});Lr({target:"Array",proto:true,forced:ln},{find:function r(n){return fn(this,n,arguments.length>1?arguments[1]:undefined)}});un(cn);var sn=gr.includes;Lr({target:"Array",proto:true},{includes:function r(n){return sn(this,n,arguments.length>1?arguments[1]:undefined)}});un("includes");var vn=Object.assign;var dn=!vn||i(function(){var r={};var n={};var e=Symbol();var t="abcdefghijklmnopqrst";r[e]=7;t.split("").forEach(function(r){n[r]=r});return vn({},r)[e]!=7||Qr(vn({},n)).join("")!=t})?function r(n,e){var t=zr(n);var i=arguments.length;var a=1;var o=xr.f;var u=h.f;while(i>a){var f=w(arguments[a++]);var c=o?Qr(f).concat(o(f)):Qr(f);var l=c.length;var s=0;var v;while(l>s){v=c[s++];if(!d||u.call(f,v))t[v]=f[v]}}return t}:vn;Lr({target:"Object",stat:true,forced:Object.assign!==dn},{assign:dn});var hn=Hr("match");var pn=function(r){var n;return m(r)&&((n=r[hn])!==undefined?!!n:v(r)=="RegExp")};var yn=function(r){if(pn(r)){throw TypeError("The method doesn't accept regular expressions")}return r};var gn=Hr("match");var mn=function(n){var e=/./;try{"/./"[n](e)}catch(r){try{e[gn]=false;return"/./"[n](e)}catch(r){}}return false};var bn="".startsWith;var wn=Math.min;Lr({target:"String",proto:true,forced:!mn("startsWith")},{startsWith:function r(n){var e=String(y(this));yn(n);var t=vr(wn(arguments.length>1?arguments[1]:undefined,e.length));var i=String(n);return bn?bn.call(e,i,t):e.slice(t,t+i.length)===i}});if(typeof window!=="undefined"){(function(){var t=function(r,n){var e=r.nodeType;if(e===3){n.push(r.textContent.replace(/&/,"&amp;").replace(/</,"&lt;").replace(">","&gt;"))}else if(e===1){n.push("<",r.tagName);if(r.hasAttributes()){[].forEach.call(r.attributes,function(r){n.push(" ",r.item.name,"='",r.item.value,"'")})}if(r.hasChildNodes()){n.push(">");[].forEach.call(r.childNodes,function(r){t(r,n)});n.push("</",r.tagName,">")}else{n.push("/>")}}else if(e==8){n.push("\x3c!--",r.nodeValue,"--\x3e")}};Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){var r=[];var n=this.firstChild;while(n){t(n,r);n=n.nextSibling}return r.join("")},set:function(r){while(this.firstChild){this.removeChild(this.firstChild)}try{var n=new DOMParser;n.async=false;var e="<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>"+r+"</svg>";var t=n.parseFromString(e,"text/xml").documentElement;var i=t.firstChild;while(i){this.appendChild(this.ownerDocument.importNode(i,true));i=i.nextSibling}}catch(r){}}});Object.defineProperty(SVGElement.prototype,"innerSVG",{get:function(){return this.innerHTML},set:function(r){this.innerHTML=r}})})()}});