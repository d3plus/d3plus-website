/*
  d3plus-common v0.6.24
  Common functions and methods used across D3plus modules.
  Copyright (c) 2017 D3plus - https://d3plus.org
  @license MIT
*/
if(typeof Object.assign!=="function"){Object.defineProperty(Object,"assign",{value:function e(r){"use strict";if(r===null){throw new TypeError("Cannot convert undefined or null to object")}var n=Object(r);for(var t=1;t<arguments.length;t++){var i=arguments[t];if(i!==null){for(var o in i){if(Object.prototype.hasOwnProperty.call(i,o)){n[o]=i[o]}}}}return n},writable:true,configurable:true})}if(!Array.prototype.includes){Object.defineProperty(Array.prototype,"includes",{value:function e(r,n){var t=Object(this);var i=t.length>>>0;if(i===0)return false;var o=n|0;var a=Math.max(o>=0?o:i-Math.abs(o),0);function f(e,r){return e===r||typeof e==="number"&&typeof r==="number"&&isNaN(e)&&isNaN(r)}while(a<i){if(f(t[a],r)){return true}a++}return false}})}(function(e,r){typeof exports==="object"&&typeof module!=="undefined"?r(exports,require("d3-selection"),require("d3-transition"),require("d3-array"),require("d3-collection")):typeof define==="function"&&define.amd?define("d3plus-common",["exports","d3-selection","d3-transition","d3-array","d3-collection"],r):r(e.d3plus={},e.d3Selection,e.d3Transition,e.d3Array,e.d3Collection)})(this,function(e,r,n,t,i){"use strict";var o=function(e,r){if(r===void 0){return function(r){return r[e]}}return function(n){return n[e]===void 0?r:n[e]}};var a=function(e){return e&&typeof e==="object"&&!Array.isArray(e)&&e!==void 0?true:false};function f(){var e=[],r=arguments.length;while(r--)e[r]=arguments[r];var n=e[0];var t=function(r){var t=e[r];Object.keys(t).forEach(function(e){var r=t[e];if(a(r)){if(n.hasOwnProperty(e)&&a(n[e])){n[e]=f({},n[e],r)}else{n[e]=r}}else if(Array.isArray(r)){if(n.hasOwnProperty(e)&&Array.isArray(n[e])){var i=n[e];r.forEach(function(e,r){if(r<i.length){var n=i[r];if(Object.is(n,e)){return}if(a(n)&&a(e)||Array.isArray(n)&&Array.isArray(e)){i[r]=f({},n,e)}else{i[r]=e}}else{i.push(e)}})}else{n[e]=r}}else{n[e]=r}})};for(var i=1;i<e.length;i++)t(i);return n}var u=function(e,r){if(r===void 0)r={};for(var n in r){if({}.hasOwnProperty.call(r,n)){e.attr(n,r[n])}}};function s(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}var c=function(){return""+s()+s()+"-"+s()+"-"+s()+"-"+s()+"-"+s()+s()+s()};var l=function e(){this._on={};this._uuid=c()};l.prototype.config=function e(r){var n=this;if(arguments.length){for(var t in r){if({}.hasOwnProperty.call(r,t)&&t in n){n[t](r[t])}}return this}else{var e={};for(var i in n.__proto__){if(i.indexOf("_")!==0&&!["config","constructor","render"].includes(i)){e[i]=n[i]()}}return e}};l.prototype.on=function e(r,n){return arguments.length===2?(this._on[r]=n,this):arguments.length?typeof r==="string"?this._on[r]:(this._on=Object.assign({},this._on,r),this):this._on};var d=function(e,r){if(r===void 0)r=[];if(!r||!(r instanceof Array)||!r.length){return undefined}return r.reduce(function(r,n){return Math.abs(n-e)<Math.abs(r-e)?n:r})};function v(e,r,n){if(e===void 0)e=this._shapeConfig;if(r===void 0)r="shape";if(n===void 0)n=false;var t={duration:this._duration,on:{}};var i=function(e){return function(r,n,t){while(r.__d3plus__){n=r.i;r=r.data||r.feature}return e(r,n,t)}};var o=function(e,n){for(var t in n){if({}.hasOwnProperty.call(n,t)&&!t.includes(".")||t.includes("."+r)){e.on[t]=i(n[t])}}};var a=function(e,r){for(var n in r){if({}.hasOwnProperty.call(r,n)){if(n==="on"){o(e,r[n])}else if(typeof r[n]==="function"){e[n]=i(r[n])}else if(typeof r[n]==="object"&&!(r instanceof Array)){e[n]={on:{}};a(e[n],r[n])}else{e[n]=r[n]}}}};a(t,e);if(this._on){o(t,this._on)}if(n&&e[n]){a(t,e[n]);if(e[n].on){o(t,e[n].on)}}return t}var y=function(e){return function r(){return e}};var p=function(e,t){t=Object.assign({},{condition:true,enter:{},exit:{},parent:r.select("body"),transition:n.transition().duration(0),update:{}},t);var i=/\.([^#]+)/g.exec(e),o=/#([^\.]+)/g.exec(e),a=/^([^.^#]+)/g.exec(e)[1];var f=t.parent.selectAll(e.includes(":")?e.split(":")[1]:e).data(t.condition?[null]:[]);var s=f.enter().append(a).call(u,t.enter);if(o){s.attr("id",o[1])}if(i){s.attr("class",i[1])}f.exit().transition(t.transition).call(u,t.exit).remove();var c=s.merge(f);c.transition(t.transition).call(u,t.update);return c};function h(e,r){if(r===void 0)r={};var n=new Set(t.merge(e.map(function(e){return i.keys(e)}))),o={};n.forEach(function(n){var i=e.map(function(e){return e[n]});var a;if(r[n]){a=r[n](i)}else{var f=i.map(function(e){return e||e===false?e.constructor:e}).filter(function(e){return e!==void 0});if(!f.length){a=undefined}else if(f.indexOf(Array)>=0){a=t.merge(i.map(function(e){return e instanceof Array?e:[e]}));a=Array.from(new Set(a));if(a.length===1){a=a[0]}}else if(f.indexOf(String)>=0){a=Array.from(new Set(i));if(a.length===1){a=a[0]}}else if(f.indexOf(Number)>=0){a=t.sum(i)}else if(f.indexOf(Object)>=0){a=h(i.filter(function(e){return e}))}else{a=Array.from(new Set(i.filter(function(e){return e!==void 0})));if(a.length===1){a=a[0]}}}o[n]=a});return o}var m=function(){if("-webkit-transform"in document.body.style){return"-webkit-"}else if("-moz-transform"in document.body.style){return"-moz-"}else if("-ms-transform"in document.body.style){return"-ms-"}else if("-o-transform"in document.body.style){return"-o-"}else{return""}};var b=function(e,r){if(r===void 0)r={};for(var n in r){if({}.hasOwnProperty.call(r,n)){e.style(n,r[n])}}};e.accessor=o;e.assign=f;e.attrize=u;e.BaseClass=l;e.closest=d;e.configPrep=v;e.constant=y;e.elem=p;e.isObject=a;e.merge=h;e.prefix=m;e.stylize=b;e.uuid=c;Object.defineProperty(e,"__esModule",{value:true})});