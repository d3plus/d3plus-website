/*
  d3plus-common v0.6.20
  Common functions and methods used across D3plus modules.
  Copyright (c) 2017 D3plus - https://d3plus.org
  @license MIT
*/
(function(r,e){typeof exports==="object"&&typeof module!=="undefined"?e(exports,require("d3-selection"),require("d3-transition"),require("i18next"),require("d3-array"),require("d3-collection")):typeof define==="function"&&define.amd?define("d3plus-common",["exports","d3-selection","d3-transition","i18next","d3-array","d3-collection"],e):e(r.d3plus=r.d3plus||{},r.d3Selection,r.d3Transition,r.i18next,r.d3Array,r.d3Collection)})(this,function(r,e,n,t,i,o){"use strict";t="default"in t?t["default"]:t;var a=function(r,e){if(e===void 0){return function(e){return e[r]}}return function(n){return n[r]===void 0?e:n[r]}};var f=function(r){return r&&typeof r==="object"&&!Array.isArray(r)&&r!==void 0?true:false};function s(){var r=[],e=arguments.length;while(e--)r[e]=arguments[e];var n=r[0];var t=function(e){var t=r[e];Object.keys(t).forEach(function(r){var e=t[r];if(f(e)){if(n.hasOwnProperty(r)&&f(n[r])){n[r]=s({},n[r],e)}else{n[r]=e}}else if(Array.isArray(e)){if(n.hasOwnProperty(r)&&Array.isArray(n[r])){var i=n[r];e.forEach(function(r,e){if(e<i.length){var n=i[e];if(Object.is(n,r)){return}if(f(n)&&f(r)||Array.isArray(n)&&Array.isArray(r)){i[e]=s({},n,r)}else{i[e]=r}}else{i.push(r)}})}else{n[r]=e}}else{n[r]=e}})};for(var i=1;i<r.length;i++)t(i);return n}var u=function(r,e){if(e===void 0)e={};for(var n in e){if({}.hasOwnProperty.call(e,n)){r.attr(n,e[n])}}};function l(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}var c=function(){return""+l()+l()+"-"+l()+"-"+l()+"-"+l()+"-"+l()+l()+l()};var d=function r(){this._on={};this._uuid=c()};d.prototype.config=function r(e){var n=this;if(arguments.length){for(var t in e){if({}.hasOwnProperty.call(e,t)&&t in n){n[t](e[t])}}return this}else{var r={};for(var i in n.__proto__){if(i.indexOf("_")!==0&&!["config","constructor","render"].includes(i)){r[i]=n[i]()}}return r}};d.prototype.on=function r(e,n){return arguments.length===2?(this._on[e]=n,this):arguments.length?typeof e==="string"?this._on[e]:(this._on=Object.assign({},this._on,e),this):this._on};var v=function(r,e){if(e===void 0)e=[];if(!e||!(e instanceof Array)||!e.length){return undefined}return e.reduce(function(e,n){return Math.abs(n-r)<Math.abs(e-r)?n:e})};function y(r,e,n){if(r===void 0)r=this._shapeConfig;if(e===void 0)e="shape";if(n===void 0)n=false;var t={duration:this._duration,on:{}};var i=function(r){return function(e,n,t){while(e.__d3plus__&&e.data){n=e.i;e=e.data}return r(e,n,t)}};var o=function(r,n){for(var t in n){if({}.hasOwnProperty.call(n,t)&&!t.includes(".")||t.includes("."+e)){r.on[t]=i(n[t])}}};var a=function(r,e){for(var n in e){if({}.hasOwnProperty.call(e,n)){if(n==="on"){o(r,e[n])}else if(typeof e[n]==="function"){r[n]=i(e[n])}else if(typeof e[n]==="object"&&!(e instanceof Array)){r[n]={on:{}};a(r[n],e[n])}else{r[n]=e[n]}}}};a(t,r);if(this._on){o(t,this._on)}if(n&&r[n]){a(t,r[n])}return t}var p=function(r){return function e(){return r}};var h=function(r,t){t=Object.assign({},{condition:true,enter:{},exit:{},parent:e.select("body"),transition:n.transition().duration(0),update:{}},t);var i=/\.([^#]+)/g.exec(r),o=/#([^\.]+)/g.exec(r),a=/^([^.^#]+)/g.exec(r)[1];var f=t.parent.selectAll(r.includes(":")?r.split(":")[1]:r).data(t.condition?[null]:[]);var s=f.enter().append(a).call(u,t.enter);if(o){s.attr("id",o[1])}if(i){s.attr("class",i[1])}f.exit().transition(t.transition).call(u,t.exit).remove();var l=s.merge(f);l.transition(t.transition).call(u,t.update);return l};var m="Back";var g="Total";var O={lowercase:["a","an","and","as","at","but","by","for","from","if","in","into","near","nor","of","on","onto","or","per","that","the","to","with","via","vs","vs."],uppercase:["CEO","CFO","CNC","COO","CPU","GDP","HVAC","ID","IT","R&D","TV","UI"]};var b={Back:m,Total:g,array:O};var A="AtrÃ¡s";var _="Total";var w={lowercase:["una","y","en","pero","en","de","o","el","la","los","las","para","a","con"],uppercase:["CEO","CFO","CNC","COO","CPU","PIB","HVAC","ID","TI","I&D","TV","UI"]};var x={Back:A,Total:_,array:w};var C="d3plus";var P=t.init({fallbackLng:"en-US",defaultNS:C,fallbackNS:C,initImmediate:false,ns:C,resources:{"en-US":(S={},S[C]=b,S),"es-ES":(j={},j[C]=x,j)}});var S;var j;function k(r,e){if(e===void 0)e={};var n=new Set(i.merge(r.map(function(r){return o.keys(r)}))),t={};n.forEach(function(n){var o=r.map(function(r){return r[n]});var a;if(e[n]){a=e[n](o)}else{var f=o.map(function(r){return r||r===false?r.constructor:r}).filter(function(r){return r!==void 0});if(!f.length){a=undefined}else if(f.indexOf(Array)>=0){a=i.merge(o.map(function(r){return r instanceof Array?r:[r]}));a=Array.from(new Set(a));if(a.length===1){a=a[0]}}else if(f.indexOf(String)>=0){a=Array.from(new Set(o));if(a.length===1){a=a[0]}}else if(f.indexOf(Number)>=0){a=i.sum(o)}else if(f.indexOf(Object)>=0){a=k(o.filter(function(r){return r}))}else{a=Array.from(new Set(o.filter(function(r){return r!==void 0})));if(a.length===1){a=a[0]}}}t[n]=a});return t}var I=function(){if("-webkit-transform"in document.body.style){return"-webkit-"}else if("-moz-transform"in document.body.style){return"-moz-"}else if("-ms-transform"in document.body.style){return"-ms-"}else if("-o-transform"in document.body.style){return"-o-"}else{return""}};var T=function(r,e){if(e===void 0)e={};for(var n in e){if({}.hasOwnProperty.call(e,n)){r.style(n,e[n])}}};r.accessor=a;r.assign=s;r.attrize=u;r.BaseClass=d;r.closest=v;r.configPrep=y;r.constant=p;r.elem=h;r.isObject=f;r.locale=P;r.merge=k;r.prefix=I;r.stylize=T;Object.defineProperty(r,"__esModule",{value:true})});