/*
  d3plus-common v0.6.11
  Common functions and methods used across D3plus modules.
  Copyright (c) 2016 D3plus - https://d3plus.org
  @license MIT
*/
(function(e,r){typeof exports==="object"&&typeof module!=="undefined"?r(exports,require("d3-selection"),require("d3-transition"),require("i18next"),require("d3-array"),require("d3-collection")):typeof define==="function"&&define.amd?define("d3plus-common",["exports","d3-selection","d3-transition","i18next","d3-array","d3-collection"],r):r(e.d3plus=e.d3plus||{},e.d3Selection,e.d3Transition,e.i18next,e.d3Array,e.d3Collection)})(this,function(e,r,t,n,i,o){"use strict";n="default"in n?n["default"]:n;var a=function(e,r){if(r===void 0)return function(r){return r[e]};return function(t){return t[e]===void 0?r:t[e]}};var s=function(e){return e&&typeof e==="object"&&!Array.isArray(e)&&e!==void 0?true:false};function f(){var e=[],r=arguments.length;while(r--)e[r]=arguments[r];var t=e[0];var n=function(r){var n=e[r];Object.keys(n).forEach(function(e){var r=n[e];if(s(r)){if(t.hasOwnProperty(e)&&s(t[e]))t[e]=f(t[e],r);else t[e]=r}else if(Array.isArray(r)){if(t.hasOwnProperty(e)&&Array.isArray(t[e])){var i=t[e];r.forEach(function(e,r){if(r<i.length){var t=i[r];if(Object.is(t,e))return;if(s(t)&&s(e)||Array.isArray(t)&&Array.isArray(e)){i[r]=f(t,e)}else i[r]=e}else i.push(e)})}else t[e]=r}else t[e]=r})};for(var i=1;i<e.length;i++)n(i);return t}var u=function(e,r){if(r===void 0)r={};for(var t in r)if({}.hasOwnProperty.call(r,t))e.attr(t,r[t])};function l(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}var c=function e(){this._on={};this._uuid=""+l()+l()+"-"+l()+"-"+l()+"-"+l()+"-"+l()+l()+l()};c.prototype.config=function e(r){var t=this;if(arguments.length){for(var n in r)if({}.hasOwnProperty.call(r,n)&&n in t)t[n](r[n]);return this}else{var e={};for(var i in this.__proto__)if(i.indexOf("_")!==0&&i!=="config")e[i]=t[i]();return e}};c.prototype.on=function e(r,t){return arguments.length===2?(this._on[r]=t,this):arguments.length?typeof r==="string"?this._on[r]:(this._on=Object.assign({},this._on,r),this):this._on};c.prototype._private=function e(r,t){return arguments.length===2?(this._on[r]=t,this):arguments.length?typeof r==="string"?this._on[r]:(this._on=Object.assign({},this._on,r),this):this._on};var d=function(e,r){return r.reduce(function(r,t){return Math.abs(t-e)<Math.abs(r-e)?t:r})};var v=function(e){return function r(){return e}};var y=function(e,n){n=Object.assign({},{condition:true,enter:{},exit:{},parent:r.select("body"),transition:t.transition().duration(0),update:{}},n);var i=/\.([^#]+)/g.exec(e),o=/#([^\.]+)/g.exec(e),a=/^([^.^#]+)/g.exec(e)[1];var s=n.parent.selectAll(e).data(n.condition?[null]:[]);var f=s.enter().append(a).call(u,n.enter);if(o)f.attr("id",o[1]);if(i)f.attr("class",i[1]);s.exit().transition(n.transition).call(u,n.exit).remove();var l=f.merge(s);l.transition(n.transition).call(u,n.update);return l};var h="Back";var p="Total";var m={lowercase:["a","an","and","as","at","but","by","for","from","if","in","into","near","nor","of","on","onto","or","per","that","the","to","with","via","vs","vs."],uppercase:["CEO","CFO","CNC","COO","CPU","GDP","HVAC","ID","IT","R&D","TV","UI"]};var g={Back:h,Total:p,array:m};var O="AtrÃ¡s";var b="Total";var A={lowercase:["una","y","en","pero","en","de","o","el","la","los","las","para","a","con"],uppercase:["CEO","CFO","CNC","COO","CPU","PIB","HVAC","ID","TI","I&D","TV","UI"]};var _={Back:O,Total:b,array:A};var x=n.init({fallbackLng:"en-US",initImmediate:false,resources:{"en-US":{translation:g},"es-ES":{translation:_}}});function C(e,r){if(r===void 0)r={};var t=new Set(i.merge(e.map(function(e){return o.keys(e)}))),n={};t.forEach(function(t){var o=e.map(function(e){return e[t]});var a;if(r[t])a=r[t](o);else{var s=o.map(function(e){return e||e===false?e.constructor:e}).filter(function(e){return e!==void 0});if(!s.length)a=undefined;else if(s.indexOf(Array)>=0){a=i.merge(o.map(function(e){return e instanceof Array?e:[e]}));a=Array.from(new Set(a));if(a.length===1)a=a[0]}else if(s.indexOf(String)>=0){a=Array.from(new Set(o));if(a.length===1)a=a[0]}else if(s.indexOf(Number)>=0)a=i.sum(o);else if(s.indexOf(Object)>=0)a=C(o.filter(function(e){return e}));else{a=Array.from(new Set(o.filter(function(e){return e!==void 0})));if(a.length===1)a=a[0]}}n[t]=a});return n}var w=function(){if("-webkit-transform"in document.body.style)return"-webkit-";else if("-moz-transform"in document.body.style)return"-moz-";else if("-ms-transform"in document.body.style)return"-ms-";else if("-o-transform"in document.body.style)return"-o-";else return""};var j=function(e,r){if(r===void 0)r={};for(var t in r)if({}.hasOwnProperty.call(r,t))e.style(t,r[t])};e.accessor=a;e.assign=f;e.attrize=u;e.BaseClass=c;e.closest=d;e.constant=v;e.elem=y;e.isObject=s;e.locale=x;e.merge=C;e.prefix=w;e.stylize=j;Object.defineProperty(e,"__esModule",{value:true})});