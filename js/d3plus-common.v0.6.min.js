/*
  d3plus-common v0.6.51
  Common functions and methods used across D3plus modules.
  Copyright (c) 2019 D3plus - https://d3plus.org
  @license MIT
*/
(function(r,e){typeof exports==="object"&&typeof module!=="undefined"?e(exports,require("d3-selection"),require("d3-transition"),require("d3-array"),require("d3-collection")):typeof define==="function"&&define.amd?define("d3plus-common",["exports","d3-selection","d3-transition","d3-array","d3-collection"],e):(r=r||self,e(r.d3plus={},r.d3Selection,r.d3Transition,r.d3Array,r.d3Collection))})(this,function(r,f,c,u,e){"use strict";function n(e,n){if(n===void 0)return function(r){return r[e]};return function(r){return r[e]===void 0?n:r[e]}}function l(r){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){l=function(r){return typeof r}}else{l=function(r){return r&&typeof Symbol==="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r}}return l(r)}function t(r,e){if(!(r instanceof e)){throw new TypeError("Cannot call a class as a function")}}function i(r,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||false;t.configurable=true;if("value"in t)t.writable=true;Object.defineProperty(r,t.key,t)}}function a(r,e,n){if(e)i(r.prototype,e);if(n)i(r,n);return r}function s(r){return r&&l(r)==="object"&&(typeof window==="undefined"||r!==window&&r!==window.document&&!(r instanceof Element))&&!Array.isArray(r)?true:false}function o(r){if(typeof window==="undefined")return true;else return r!==window&&r!==document}function v(){var t=arguments;var i=arguments.length<=0?undefined:arguments[0];var r=function r(e){var n=e<0||t.length<=e?undefined:t[e];Object.keys(n).forEach(function(r){var e=n[r];if(s(e)&&o(e)){if(i.hasOwnProperty(r)&&s(i[r]))i[r]=v({},i[r],e);else i[r]=v({},e)}else if(Array.isArray(e))i[r]=e.slice();else i[r]=e})};for(var e=1;e<arguments.length;e++){r(e)}return i}function d(r){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};for(var n in e){if({}.hasOwnProperty.call(e,n))r.attr(n,e[n])}}function h(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}function p(){return"".concat(h()).concat(h(),"-").concat(h(),"-").concat(h(),"-").concat(h(),"-").concat(h()).concat(h()).concat(h())}var y="D3PLUS-COMMON-RESET";function g(r,e){if(s(r)){for(var n in r){if({}.hasOwnProperty.call(r,n)&&!n.startsWith("_")){var t=e&&s(e)?e[n]:undefined;if(r[n]===y){r[n]=t}else if(s(r[n])){g(r[n],t)}}}}}var m=function(){function r(){t(this,r);this._locale="en-US";this._on={};this._uuid=p()}a(r,[{key:"config",value:function r(e){if(!this._configDefault){var r={};for(var n in this.__proto__){if(n.indexOf("_")!==0&&!["config","constructor","render"].includes(n)){var t=this[n]();r[n]=s(t)?v({},t):t}}this._configDefault=r}if(arguments.length){for(var i in e){if({}.hasOwnProperty.call(e,i)&&i in this){var a=e[i];if(a===y){if(i==="on")this._on=this._configDefault[i];else this[i](this._configDefault[i])}else{g(a,this._configDefault[i]);this[i](a)}}}return this}else{var o={};for(var u in this.__proto__){if(u.indexOf("_")!==0&&!["config","constructor","render"].includes(u))o[u]=this[u]()}return o}}},{key:"locale",value:function r(e){return arguments.length?(this._locale=e,this):this._locale}},{key:"on",value:function r(e,n){return arguments.length===2?(this._on[e]=n,this):arguments.length?typeof e==="string"?this._on[e]:(this._on=Object.assign({},this._on,e),this):this._on}}]);return r}();function b(n){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(!r||!(r instanceof Array)||!r.length)return undefined;return r.reduce(function(r,e){return Math.abs(e-n)<Math.abs(r-n)?e:r})}function w(){var a=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this._shapeConfig;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"shape";var e=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var n={duration:this._duration,on:{}};var o=function r(i){return function(r,e,n){var t;while(r.__d3plus__){if(t)r.__d3plusParent__=t;t=r;e=r.i;r=r.data||r.feature}return i.bind(a)(r,e,n||t)}};var u=function r(e,n){for(var t in n){if({}.hasOwnProperty.call(n,t)&&!t.includes(".")||t.includes(".".concat(i))){e.on[t]=o(n[t])}}};var f=function e(r){return r.map(function(r){if(r instanceof Array)return e(r);else if(l(r)==="object")return t({},r);else if(typeof r==="function")return o(r);else return r})};var t=function r(e,n){for(var t in n){if({}.hasOwnProperty.call(n,t)){if(t==="on")u(e,n[t]);else if(typeof n[t]==="function"){e[t]=o(n[t])}else if(n[t]instanceof Array){e[t]=f(n[t])}else if(l(n[t])==="object"){e[t]={on:{}};r(e[t],n[t])}else e[t]=n[t]}}};t(n,r);if(this._on)u(n,this._on);if(e&&r[e]){t(n,r[e]);if(r[e].on)u(n,r[e].on)}return n}function O(e){return function r(){return e}}function S(r,e){e=Object.assign({},{condition:true,enter:{},exit:{},parent:f.select("body"),transition:c.transition().duration(0),update:{}},e);var n=/\.([^#]+)/g.exec(r),t=/#([^\.]+)/g.exec(r),i=/^([^.^#]+)/g.exec(r)[1];var a=e.parent.selectAll(r.includes(":")?r.split(":")[1]:r).data(e.condition?[null]:[]);var o=a.enter().append(i).call(d,e.enter);if(t)o.attr("id",t[1]);if(n)o.attr("class",n[1]);a.exit().transition(e.transition).call(d,e.exit).remove();var u=o.merge(a);u.transition(e.transition).call(d,e.update);return u}function _(i){var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=new Set(u.merge(i.map(function(r){return e.keys(r)}))),o={};r.forEach(function(e){var r=i.map(function(r){return r[e]});var n;if(a[e])n=a[e](r);else{var t=r.map(function(r){return r||r===false?r.constructor:r}).filter(function(r){return r!==void 0});if(!t.length)n=undefined;else if(t.indexOf(Array)>=0){n=u.merge(r.map(function(r){return r instanceof Array?r:[r]}));n=Array.from(new Set(n));if(n.length===1)n=n[0]}else if(t.indexOf(String)>=0){n=Array.from(new Set(r));if(n.length===1)n=n[0]}else if(t.indexOf(Number)>=0)n=u.sum(r);else if(t.indexOf(Object)>=0)n=_(r.filter(function(r){return r}));else{n=Array.from(new Set(r.filter(function(r){return r!==void 0})));if(n.length===1)n=n[0]}}o[e]=n});return o}function j(r){var i;if(typeof r==="number")i=[r];else i=r.split(/\s+/);if(i.length===1)i=[i[0],i[0],i[0],i[0]];else if(i.length===2)i=i.concat(i);else if(i.length===3)i.push(i[1]);return["top","right","bottom","left"].reduce(function(r,e,n){var t=parseFloat(i[n]);r[e]=t||0;return r},{})}function x(){if("-webkit-transform"in document.body.style)return"-webkit-";else if("-moz-transform"in document.body.style)return"-moz-";else if("-ms-transform"in document.body.style)return"-ms-";else if("-o-transform"in document.body.style)return"-o-";else return""}function E(r){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};for(var n in e){if({}.hasOwnProperty.call(e,n))r.style(n,e[n])}}r.BaseClass=m;r.RESET=y;r.accessor=n;r.assign=v;r.attrize=d;r.closest=b;r.configPrep=w;r.constant=O;r.elem=S;r.isObject=s;r.merge=_;r.parseSides=j;r.prefix=x;r.stylize=E;r.uuid=p;Object.defineProperty(r,"__esModule",{value:true})});(function(r){typeof define==="function"&&define.amd?define(r):r()})(function(){"use strict";var r=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function e(r,e){return e={exports:{}},r(e,e.exports),e.exports}var n="object";var t=function(r){return r&&r.Math==Math&&r};var s=t(typeof globalThis==n&&globalThis)||t(typeof window==n&&window)||t(typeof self==n&&self)||t(typeof r==n&&r)||Function("return this")();var i=function(r){try{return!!r()}catch(r){return true}};var d=!i(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7});var a={}.propertyIsEnumerable;var o=Object.getOwnPropertyDescriptor;var u=o&&!a.call({1:2},1);var f=u?function r(e){var n=o(this,e);return!!n&&n.enumerable}:a;var h={f:f};var c=function(r,e){return{enumerable:!(r&1),configurable:!(r&2),writable:!(r&4),value:e}};var l={}.toString;var v=function(r){return l.call(r).slice(8,-1)};var p="".split;var w=i(function(){return!Object("z").propertyIsEnumerable(0)})?function(r){return v(r)=="String"?p.call(r,""):Object(r)}:Object;var y=function(r){if(r==undefined)throw TypeError("Can't call method on "+r);return r};var g=function(r){return w(y(r))};var m=function(r){return typeof r==="object"?r!==null:typeof r==="function"};var b=function(r,e){if(!m(r))return r;var n,t;if(e&&typeof(n=r.toString)=="function"&&!m(t=n.call(r)))return t;if(typeof(n=r.valueOf)=="function"&&!m(t=n.call(r)))return t;if(!e&&typeof(n=r.toString)=="function"&&!m(t=n.call(r)))return t;throw TypeError("Can't convert object to primitive value")};var O={}.hasOwnProperty;var S=function(r,e){return O.call(r,e)};var _=s.document;var j=m(_)&&m(_.createElement);var x=function(r){return j?_.createElement(r):{}};var E=!d&&!i(function(){return Object.defineProperty(x("div"),"a",{get:function(){return 7}}).a!=7});var P=Object.getOwnPropertyDescriptor;var A=d?P:function r(e,n){e=g(e);n=b(n,true);if(E)try{return P(e,n)}catch(r){}if(S(e,n))return c(!h.f.call(e,n),e[n])};var T={f:A};var M=function(r){if(!m(r)){throw TypeError(String(r)+" is not an object")}return r};var k=Object.defineProperty;var C=d?k:function r(e,n,t){M(e);n=b(n,true);M(t);if(E)try{return k(e,n,t)}catch(r){}if("get"in t||"set"in t)throw TypeError("Accessors not supported");if("value"in t)e[n]=t.value;return e};var N={f:C};var D=d?function(r,e,n){return N.f(r,e,c(1,n))}:function(r,e,n){r[e]=n;return r};var F=function(e,n){try{D(s,e,n)}catch(r){s[e]=n}return n};var L=e(function(r){var e="__core-js_shared__";var n=s[e]||F(e,{});(r.exports=function(r,e){return n[r]||(n[r]=e!==undefined?e:{})})("versions",[]).push({version:"3.1.3",mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})});var I=L("native-function-to-string",Function.toString);var z=s.WeakMap;var W=typeof z==="function"&&/native code/.test(I.call(z));var q=0;var G=Math.random();var R=function(r){return"Symbol("+String(r===undefined?"":r)+")_"+(++q+G).toString(36)};var V=L("keys");var H=function(r){return V[r]||(V[r]=R(r))};var U={};var B=s.WeakMap;var K,Y,J;var Q=function(r){return J(r)?Y(r):K(r,{})};var X=function(n){return function(r){var e;if(!m(r)||(e=Y(r)).type!==n){throw TypeError("Incompatible receiver, "+n+" required")}return e}};if(W){var Z=new B;var $=Z.get;var rr=Z.has;var er=Z.set;K=function(r,e){er.call(Z,r,e);return e};Y=function(r){return $.call(Z,r)||{}};J=function(r){return rr.call(Z,r)}}else{var nr=H("state");U[nr]=true;K=function(r,e){D(r,nr,e);return e};Y=function(r){return S(r,nr)?r[nr]:{}};J=function(r){return S(r,nr)}}var tr={set:K,get:Y,has:J,enforce:Q,getterFor:X};var ir=e(function(r){var e=tr.get;var u=tr.enforce;var f=String(I).split("toString");L("inspectSource",function(r){return I.call(r)});(r.exports=function(r,e,n,t){var i=t?!!t.unsafe:false;var a=t?!!t.enumerable:false;var o=t?!!t.noTargetGet:false;if(typeof n=="function"){if(typeof e=="string"&&!S(n,"name"))D(n,"name",e);u(n).source=f.join(typeof e=="string"?e:"")}if(r===s){if(a)r[e]=n;else F(e,n);return}else if(!i){delete r[e]}else if(!o&&r[e]){a=true}if(a)r[e]=n;else D(r,e,n)})(Function.prototype,"toString",function r(){return typeof this=="function"&&e(this).source||I.call(this)})});var ar=s;var or=function(r){return typeof r=="function"?r:undefined};var ur=function(r,e){return arguments.length<2?or(ar[r])||or(s[r]):ar[r]&&ar[r][e]||s[r]&&s[r][e]};var fr=Math.ceil;var cr=Math.floor;var lr=function(r){return isNaN(r=+r)?0:(r>0?cr:fr)(r)};var sr=Math.min;var vr=function(r){return r>0?sr(lr(r),9007199254740991):0};var dr=Math.max;var hr=Math.min;var pr=function(r,e){var n=lr(r);return n<0?dr(n+e,0):hr(n,e)};var yr=function(u){return function(r,e,n){var t=g(r);var i=vr(t.length);var a=pr(n,i);var o;if(u&&e!=e)while(i>a){o=t[a++];if(o!=o)return true}else for(;i>a;a++){if((u||a in t)&&t[a]===e)return u||a||0}return!u&&-1}};var gr={includes:yr(true),indexOf:yr(false)};var mr=gr.indexOf;var br=function(r,e){var n=g(r);var t=0;var i=[];var a;for(a in n)!S(U,a)&&S(n,a)&&i.push(a);while(e.length>t)if(S(n,a=e[t++])){~mr(i,a)||i.push(a)}return i};var wr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];var Or=wr.concat("length","prototype");var Sr=Object.getOwnPropertyNames||function r(e){return br(e,Or)};var _r={f:Sr};var jr=Object.getOwnPropertySymbols;var xr={f:jr};var Er=ur("Reflect","ownKeys")||function r(e){var n=_r.f(M(e));var t=xr.f;return t?n.concat(t(e)):n};var Pr=function(r,e){var n=Er(e);var t=N.f;var i=T.f;for(var a=0;a<n.length;a++){var o=n[a];if(!S(r,o))t(r,o,i(e,o))}};var Ar=/#|\.prototype\./;var Tr=function(r,e){var n=kr[Mr(r)];return n==Nr?true:n==Cr?false:typeof e=="function"?i(e):!!e};var Mr=Tr.normalize=function(r){return String(r).replace(Ar,".").toLowerCase()};var kr=Tr.data={};var Cr=Tr.NATIVE="N";var Nr=Tr.POLYFILL="P";var Dr=Tr;var Fr=T.f;var Lr=function(r,e){var n=r.target;var t=r.global;var i=r.stat;var a,o,u,f,c,l;if(t){o=s}else if(i){o=s[n]||F(n,{})}else{o=(s[n]||{}).prototype}if(o)for(u in e){c=e[u];if(r.noTargetGet){l=Fr(o,u);f=l&&l.value}else f=o[u];a=Dr(t?u:n+(i?".":"#")+u,r.forced);if(!a&&f!==undefined){if(typeof c===typeof f)continue;Pr(c,f)}if(r.sham||f&&f.sham){D(c,"sham",true)}ir(o,u,c,r)}};var Ir=function(r){if(typeof r!="function"){throw TypeError(String(r)+" is not a function")}return r};var zr=function(t,i,r){Ir(t);if(i===undefined)return t;switch(r){case 0:return function(){return t.call(i)};case 1:return function(r){return t.call(i,r)};case 2:return function(r,e){return t.call(i,r,e)};case 3:return function(r,e,n){return t.call(i,r,e,n)}}return function(){return t.apply(i,arguments)}};var Wr=function(r){return Object(y(r))};var qr=Array.isArray||function r(e){return v(e)=="Array"};var Gr=!!Object.getOwnPropertySymbols&&!i(function(){return!String(Symbol())});var Rr=s.Symbol;var Vr=L("wks");var Hr=function(r){return Vr[r]||(Vr[r]=Gr&&Rr[r]||(Gr?Rr:R)("Symbol."+r))};var Ur=Hr("species");var Br=function(r,e){var n;if(qr(r)){n=r.constructor;if(typeof n=="function"&&(n===Array||qr(n.prototype)))n=undefined;else if(m(n)){n=n[Ur];if(n===null)n=undefined}}return new(n===undefined?Array:n)(e===0?0:e)};var Kr=[].push;var Yr=function(d){var h=d==1;var p=d==2;var y=d==3;var g=d==4;var m=d==6;var b=d==5||m;return function(r,e,n,t){var i=Wr(r);var a=w(i);var o=zr(e,n,3);var u=vr(a.length);var f=0;var c=t||Br;var l=h?c(r,u):p?c(r,0):undefined;var s,v;for(;u>f;f++)if(b||f in a){s=a[f];v=o(s,f,i);if(d){if(h)l[f]=v;else if(v)switch(d){case 3:return true;case 5:return s;case 6:return f;case 2:Kr.call(l,s)}else if(g)return false}}return m?-1:y||g?g:l}};var Jr={forEach:Yr(0),map:Yr(1),filter:Yr(2),some:Yr(3),every:Yr(4),find:Yr(5),findIndex:Yr(6)};var Qr=Object.keys||function r(e){return br(e,wr)};var Xr=d?Object.defineProperties:function r(e,n){M(e);var t=Qr(n);var i=t.length;var a=0;var o;while(i>a)N.f(e,o=t[a++],n[o]);return e};var Zr=ur("document","documentElement");var $r=H("IE_PROTO");var re="prototype";var ee=function(){};var ne=function(){var r=x("iframe");var e=wr.length;var n="<";var t="script";var i=">";var a="java"+t+":";var o;r.style.display="none";Zr.appendChild(r);r.src=String(a);o=r.contentWindow.document;o.open();o.write(n+t+i+"document.F=Object"+n+"/"+t+i);o.close();ne=o.F;while(e--)delete ne[re][wr[e]];return ne()};var te=Object.create||function r(e,n){var t;if(e!==null){ee[re]=M(e);t=new ee;ee[re]=null;t[$r]=e}else t=ne();return n===undefined?t:Xr(t,n)};U[$r]=true;var ie=Hr("unscopables");var ae=Array.prototype;if(ae[ie]==undefined){D(ae,ie,te(null))}var oe=function(r){ae[ie][r]=true};var ue=Jr.find;var fe="find";var ce=true;if(fe in[])Array(1)[fe](function(){ce=false});Lr({target:"Array",proto:true,forced:ce},{find:function r(e){return ue(this,e,arguments.length>1?arguments[1]:undefined)}});oe(fe);var le=gr.includes;Lr({target:"Array",proto:true},{includes:function r(e){return le(this,e,arguments.length>1?arguments[1]:undefined)}});oe("includes");var se=Object.assign;var ve=!se||i(function(){var r={};var e={};var n=Symbol();var t="abcdefghijklmnopqrst";r[n]=7;t.split("").forEach(function(r){e[r]=r});return se({},r)[n]!=7||Qr(se({},e)).join("")!=t})?function r(e,n){var t=Wr(e);var i=arguments.length;var a=1;var o=xr.f;var u=h.f;while(i>a){var f=w(arguments[a++]);var c=o?Qr(f).concat(o(f)):Qr(f);var l=c.length;var s=0;var v;while(l>s){v=c[s++];if(!d||u.call(f,v))t[v]=f[v]}}return t}:se;Lr({target:"Object",stat:true,forced:Object.assign!==ve},{assign:ve});var de=Hr("match");var he=function(r){var e;return m(r)&&((e=r[de])!==undefined?!!e:v(r)=="RegExp")};var pe=function(r){if(he(r)){throw TypeError("The method doesn't accept regular expressions")}return r};var ye=Hr("match");var ge=function(e){var n=/./;try{"/./"[e](n)}catch(r){try{n[ye]=false;return"/./"[e](n)}catch(r){}}return false};var me="".startsWith;var be=Math.min;Lr({target:"String",proto:true,forced:!ge("startsWith")},{startsWith:function r(e){var n=String(y(this));pe(e);var t=vr(be(arguments.length>1?arguments[1]:undefined,n.length));var i=String(e);return me?me.call(n,i,t):n.slice(t,t+i.length)===i}});if(typeof window!=="undefined"){(function(){var t=function(r,e){var n=r.nodeType;if(n===3){e.push(r.textContent.replace(/&/,"&amp;").replace(/</,"&lt;").replace(">","&gt;"))}else if(n===1){e.push("<",r.tagName);if(r.hasAttributes()){[].forEach.call(r.attributes,function(r){e.push(" ",r.item.name,"='",r.item.value,"'")})}if(r.hasChildNodes()){e.push(">");[].forEach.call(r.childNodes,function(r){t(r,e)});e.push("</",r.tagName,">")}else{e.push("/>")}}else if(n==8){e.push("\x3c!--",r.nodeValue,"--\x3e")}};Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){var r=[];var e=this.firstChild;while(e){t(e,r);e=e.nextSibling}return r.join("")},set:function(r){while(this.firstChild){this.removeChild(this.firstChild)}try{var e=new DOMParser;e.async=false;var n="<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>"+r+"</svg>";var t=e.parseFromString(n,"text/xml").documentElement;var i=t.firstChild;while(i){this.appendChild(this.ownerDocument.importNode(i,true));i=i.nextSibling}}catch(r){}}});Object.defineProperty(SVGElement.prototype,"innerSVG",{get:function(){return this.innerHTML},set:function(r){this.innerHTML=r}})})()}});