/*
  d3plus-viz v0.12.37
  Abstract ES6 class that drives d3plus visualizations.
  Copyright (c) 2019 D3plus - https://d3plus.org
  @license MIT
*/
(function(t,e){typeof exports==="object"&&typeof module!=="undefined"?e(exports,require("d3-request"),require("d3-array"),require("d3-brush"),require("d3-color"),require("d3-collection"),require("d3-queue"),require("d3-selection"),require("d3-transition"),require("d3-zoom"),require("lrucache"),require("d3plus-axis"),require("d3plus-color"),require("d3plus-common"),require("d3plus-form"),require("d3plus-format"),require("d3plus-legend"),require("d3plus-text"),require("d3plus-timeline"),require("d3plus-tooltip"),require("d3plus-export")):typeof define==="function"&&define.amd?define("d3plus-viz",["exports","d3-request","d3-array","d3-brush","d3-color","d3-collection","d3-queue","d3-selection","d3-transition","d3-zoom","lrucache","d3plus-axis","d3plus-color","d3plus-common","d3plus-form","d3plus-format","d3plus-legend","d3plus-text","d3plus-timeline","d3plus-tooltip","d3plus-export"],e):(t=t||self,e(t.d3plus={},t.d3Request,t.d3Array,t.d3Brush,t.d3Color,t.d3Collection,t.d3Queue,t.d3Selection,t.d3Transition,t.d3Zoom,t.lrucache,t.d3plusAxis,t.d3plusColor,t.d3plusCommon,t.d3plusForm,t.d3plusFormat,t.d3plusLegend,t.d3plusText,t.d3plusTimeline,t.d3plusTooltip,t.d3plusExport))})(this,function(t,l,_,i,h,f,u,g,d,v,n,p,c,m,o,y,r,s,b,C,w){"use strict";n=n&&n.hasOwnProperty("default")?n["default"]:n;var k=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"data";var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"headers";return t[e].map(function(n){return t[i].reduce(function(t,e,i){return t[e]=n[i],t},{})})};function a(i,n,o,r){var s=this;if(typeof i!=="string"){var t=n?n(i):i;if(o&&"_".concat(o)in this)this["_".concat(o)]=t;if(r)r(null,t)}else{var a=i.slice(i.length-4)===".csv"?l.csv:i.slice(i.length-4)===".tsv"?l.tsv:i.slice(i.length-4)===".txt"?l.text:l.json;a(i,function(t,e){if(a!==l.json&&!t&&e&&e instanceof Array){e.forEach(function(t){for(var e in t){if(!isNaN(t[e]))t[e]=parseFloat(t[e]);else if(t[e].toLowerCase()==="false")t[e]=false;else if(t[e].toLowerCase()==="true")t[e]=true;else if(t[e].toLowerCase()==="null")t[e]=null;else if(t[e].toLowerCase()==="undefined")t[e]=undefined}})}e=t?[]:n?n(e):e;if(e&&!(e instanceof Array)&&e.data&&e.headers)e=k(e);if(o&&"_".concat(o)in s)s["_".concat(o)]=e;if(s._cache)s._lrucache.set(i,e);if(r)r(t,e)})}}function z(t){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){z=function(t){return typeof t}}else{z=function(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return z(t)}function S(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function x(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(t,n.key,n)}}function P(t,e,i){if(e)x(t.prototype,e);if(i)x(t,i);return t}function O(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});if(e)A(t,e)}function T(t){T=Object.setPrototypeOf?Object.getPrototypeOf:function t(e){return e.__proto__||Object.getPrototypeOf(e)};return T(t)}function A(t,e){A=Object.setPrototypeOf||function t(e,i){e.__proto__=i;return e};return A(t,e)}function B(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function D(t,e){if(e&&(typeof e==="object"||typeof e==="function")){return e}return B(t)}function M(t,e){return j(t)||E(t,e)||L()}function H(t){return e(t)||F(t)||q()}function e(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}function j(t){if(Array.isArray(t))return t}function F(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function E(t,e){var i=[];var n=true;var o=false;var r=undefined;try{for(var s=t[Symbol.iterator](),a;!(n=(a=s.next()).done);n=true){i.push(a.value);if(e&&i.length===e)break}}catch(t){o=true;r=t}finally{try{if(!n&&s["return"]!=null)s["return"]()}finally{if(o)throw r}}return i}function q(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function L(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var N=function(){function t(){S(this,t);this._isVisible=false}P(t,[{key:"exit",value:function t(e,i){e.transition().duration(i).style("opacity",0).transition().remove();this._isVisible=false}},{key:"hide",value:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},i=e.duration,n=i===void 0?600:i,o=e.callback;this.mask.call(this.exit.bind(this),n);this.elem.call(this.exit.bind(this),n);if(o)setTimeout(o,n+100);this._isVisible=false;return this}},{key:"render",value:function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},i=e.callback,n=e.container,o=n===void 0?"body":n,r=e.duration,s=r===void 0?600:r,a=e.html,l=a===void 0?"Please Wait":a,h=e.mask,c=h===void 0?"rgba(0, 0, 0, 0.05)":h,u=e.style,d=u===void 0?{}:u;var f=g.select(o).style("position","relative");this.mask=f.selectAll("div.d3plus-Mask").data(c?[c]:[]);this.mask=this.mask.enter().append("div").attr("class","d3plus-Mask").style("opacity",1).merge(this.mask);this.mask.exit().call(this.exit.bind(this),s);m.stylize(this.mask,{"background-color":String,bottom:"0px",left:"0px",position:"absolute",right:"0px",top:"0px"});this.elem=f.selectAll("div.d3plus-Message").data([l]);this.elem=this.elem.enter().append("div").attr("class","d3plus-Message").style("opacity",1).merge(this.elem).html(String);m.stylize(this.elem,d);if(i)setTimeout(i,100);this._isVisible=true;return this}}]);return t}();function R(){var t=this._history.length;var e=m.elem("g.d3plus-viz-back",{parent:this._select,transition:this._transition,update:{transform:"translate(".concat(this._margin.left,", ").concat(this._margin.top,")")}}).node();this._backClass.data(t?[{text:"Back",x:0,y:0}]:[]).select(e).config(this._backConfig).render();this._margin.top+=t?this._backClass.fontSize()():0}function V(){var n=this;var t=this._data;var e=this._colorScalePosition||"bottom";var i=["top","bottom"].includes(e);var o=this._colorScalePadding()?this._padding:{top:0,right:0,bottom:0,left:0};var r=this._width-(this._margin.left+this._margin.right+o.left+o.right);var s=i?_.min([this._colorScaleMaxSize,r]):this._width-(this._margin.left+this._margin.right);var a=this._height-(this._margin.bottom+this._margin.top+o.bottom+o.top);var l=!i?_.min([this._colorScaleMaxSize,a]):this._height-(this._margin.bottom+this._margin.top);var h={opacity:this._colorScalePosition?1:0,transform:"translate(".concat(i?this._margin.left+o.left+(r-s)/2:this._margin.left,", ").concat(i?this._margin.top:this._margin.top+o.top+(a-l)/2,")")};var c=this._colorScale&&t&&t.length>1;var u=m.elem("g.d3plus-viz-colorScale",{condition:c&&!this._colorScaleConfig.select,enter:h,parent:this._select,transition:this._transition,update:h}).node();if(c){var d=t.filter(function(t,e){var i=n._colorScale(t,e);return i!==undefined&&i!==null});this._colorScaleClass.align({bottom:"end",left:"start",right:"end",top:"start"}[e]||"bottom").duration(this._duration).data(d).height(l).locale(this._locale).orient(e).select(u).value(this._colorScale).width(s).config(this._colorScaleConfig).render();var f=this._colorScaleClass.outerBounds();if(this._colorScalePosition&&!this._colorScaleConfig.select&&f.height){if(i)this._margin[e]+=f.height+this._legendClass.padding()*2;else this._margin[e]+=f.width+this._legendClass.padding()*2}}else{this._colorScaleClass.config(this._colorScaleConfig)}}var I={Button:o.Button,Radio:o.Radio,Select:o.Select};function G(){var u=this;var d=this;var f=this._controlPadding()?this._padding:{top:0,right:0,bottom:0,left:0};var _=["left","right","top","bottom"];var t=function t(e){var l=_[e];var h=(u._controls||[]).filter(function(t){return!t.position&&l==="bottom"||t.position===l});if(u._downloadButton&&u._downloadPosition===l){h.push({data:[{text:"Download",value:1}],label:"downloadButton",on:{click:function t(){var e=u._detectResize;if(e)u.detectResize(false).render();w.saveElement(u._select.node(),Object.assign({title:u._title||undefined},u._downloadConfig),{callback:function t(){setTimeout(function(){if(e)u.detectResize(e).render()},5e3)}})}},type:"Button"})}var i=l==="top"||l==="bottom";var n={height:i?u._height-(u._margin.top+u._margin.bottom):u._height-(u._margin.top+u._margin.bottom+f.top+f.bottom),width:i?u._width-(u._margin.left+u._margin.right+f.left+f.right):u._width-(u._margin.left+u._margin.right)};n.x=(i?u._margin.left+f.left:u._margin.left)+(l==="right"?u._width-u._margin.bottom:0);n.y=(i?u._margin.top:u._margin.top+f.top)+(l==="bottom"?u._height-u._margin.bottom:0);var o=m.elem("foreignObject.d3plus-viz-controls-".concat(l),{condition:h.length,enter:Object.assign({opacity:0},n),exit:Object.assign({opacity:0},n),parent:u._select,transition:u._transition,update:{height:n.height,opacity:1,width:n.width}});var c=o.selectAll("div.d3plus-viz-controls-container").data([null]);c=c.enter().append("xhtml:div").attr("class","d3plus-viz-controls-container").merge(c);if(h.length){var r=function t(e){var i=Object.assign({},h[e]);var n={};if(i.on){var o=function t(e){if({}.hasOwnProperty.call(i.on,e)){n[e]=function(){i.on[e].bind(d)(this.value)}}};for(var r in i.on){o(r)}}var s=i.label||"".concat(l,"-").concat(e);if(!u._controlCache[s]){var a=i.type&&I[i.type]?i.type:"Select";u._controlCache[s]=(new I[a]).container(c.node());if(i.checked)u._controlCache[s].checked(i.checked);if(i.selected)u._controlCache[s].selected(i.selected)}delete i.checked;delete i.selected;u._controlCache[s].config(i).config({on:n}).config(u._controlConfig).render()};for(var s=0;s<h.length;s++){r(s)}c.style("display",["top","bottom"].includes(l)?"block":"inline-block").style("text-align",["top","bottom"].includes(l)?"center":l);var a=c.node().getBoundingClientRect();o.transition(u._transition).attr("x",n.x-(l==="right"?a.width:0)).attr("y",n.y-(l==="bottom"?a.height:0)).attr("height",i?a.height:n.height).attr("width",i?n.width:a.width);u._margin[l]+=["top","bottom"].includes(l)?a.height:a.width}};for(var e=0;e<_.length;e++){t(e)}}function W(t,e){var i=this._drawLabel(t,e);return i instanceof Array?i.join(", "):i}function Y(){var s=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];if(this._legend){var e=this._legendClass.outerBounds();var i=this._legendPosition;var n=["top","bottom"].includes(i);var o=this._legendPadding()?this._padding:{top:0,right:0,bottom:0,left:0};var r={transform:"translate(".concat(n?this._margin.left+o.left:this._margin.left,", ").concat(n?this._margin.top:this._margin.top+o.top,")")};var a=m.elem("g.d3plus-viz-legend",{condition:this._legend&&!this._legendConfig.select,enter:r,parent:this._select,transition:this._transition,update:r}).node();var l=[];var h=function t(e,i){var n=s._shape(e,i);var o=n==="Line"?"stroke":"fill";var r=s._shapeConfig[n]&&s._shapeConfig[n][o]?s._shapeConfig[n][o]:s._shapeConfig[o];return typeof r==="function"?r(e,i):r};var c=function t(e,i){var n=s._shape(e,i);var o=s._shapeConfig[n]&&s._shapeConfig[n].opacity?s._shapeConfig[n].opacity:s._shapeConfig.opacity;return typeof o==="function"?o(e,i):o};var u=function t(e,i){return"".concat(h(e,i),"_").concat(c(e,i))};f.nest().key(u).rollup(function(t){return l.push(m.merge(t,s._aggs))}).entries(this._colorScale?t.filter(function(t,e){return s._colorScale(t,e)===undefined}):t);l.sort(this._legendSort);var d=function t(e,i){var n=s._id(e,i);if(n instanceof Array)n=n[0];return s._hidden.includes(n)||s._solo.length&&!s._solo.includes(n)};this._legendClass.id(u).align(n?"center":i).direction(n?"row":"column").duration(this._duration).data(l.length>this._legendCutoff||this._colorScale?l:[]).height(n?this._height-(this._margin.bottom+this._margin.top):this._height-(this._margin.bottom+this._margin.top+o.bottom+o.top)).locale(this._locale).select(a).verticalAlign(!n?"middle":i).width(n?this._width-(this._margin.left+this._margin.right+o.left+o.right):this._width-(this._margin.left+this._margin.right)).shapeConfig(m.configPrep.bind(this)(this._shapeConfig,"legend")).config(this._legendConfig).shapeConfig({fill:function t(e,i){return d(e,i)?s._hiddenColor(e,i):h(e,i)},labelConfig:{fontOpacity:function t(e,i){return d(e,i)?s._hiddenOpacity(e,i):1}},opacity:c}).render();if(!this._legendConfig.select&&e.height){if(n)this._margin[i]+=e.height+this._legendClass.padding()*2;else this._margin[i]+=e.width+this._legendClass.padding()*2}}}function K(i){var n=this;if(!(i instanceof Array))i=[i,i];if(JSON.stringify(i)!==JSON.stringify(this._timelineSelection)){this._timelineSelection=i;i=i.map(Number);this.timeFilter(function(t){var e=p.date(n._time(t)).getTime();return e>=i[0]&&e<=i[1]}).render()}}function X(){var e=this;var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var i=this._time&&this._timeline;var n=i?m.unique(this._data.map(this._time)).map(p.date):[];i=i&&n.length>1;var o=this._timelinePadding()?this._padding:{top:0,right:0,bottom:0,left:0};var r={transform:"translate(".concat(this._margin.left+o.left,", 0)")};var s=m.elem("g.d3plus-viz-timeline",{condition:i,enter:r,parent:this._select,transition:this._transition,update:r}).node();if(i){var a=this._timelineClass.domain(_.extent(n)).duration(this._duration).height(this._height-this._margin.bottom).locale(this._locale).select(s).ticks(n.sort(function(t,e){return+t-+e})).width(this._width-(this._margin.left+this._margin.right+o.left+o.right));if(a.selection()===undefined){this._timelineSelection=_.extent(t,this._time).map(p.date);a.selection(this._timelineSelection)}var l=this._timelineConfig;a.config(l).on("end",function(t){K.bind(e)(t);if(l.on&&l.on.end)l.on.end(t)}).render();this._margin.bottom+=a.outerBounds().height+a.padding()*2}}function J(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var e=this._title?this._title(t):false;var i=this._titlePadding()?this._padding:{top:0,right:0,bottom:0,left:0};var n={transform:"translate(".concat(this._margin.left+i.left,", ").concat(this._margin.top,")")};var o=m.elem("g.d3plus-viz-title",{enter:n,parent:this._select,transition:this._transition,update:n}).node();this._titleClass.data(e?[{text:e}]:[]).locale(this._locale).select(o).width(this._width-(this._margin.left+this._margin.right+i.left+i.right)).config(this._titleConfig).render();this._margin.top+=e?o.getBBox().height:0}function Q(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var e=typeof this._total==="function"?_.sum(t.map(this._total)):this._total===true&&this._size?_.sum(t.map(this._size)):false;var i=this._totalPadding()?this._padding:{top:0,right:0,bottom:0,left:0};var n={transform:"translate(".concat(this._margin.left+i.left,", ").concat(this._margin.top,")")};var o=m.elem("g.d3plus-viz-total",{enter:n,parent:this._select,transition:this._transition,update:n}).node();var r=typeof e==="number";this._totalClass.data(r?[{text:this._totalFormat(e)}]:[]).locale(this._locale).select(o).width(this._width-(this._margin.left+this._margin.right+i.left+i.right)).config(this._totalConfig).render();this._margin.top+=r?o.getBBox().height+this._totalConfig.padding*2:0}function U(t,e){if(!t)return undefined;if(t.tagName===undefined||["BODY","HTML"].indexOf(t.tagName)>=0){var i=window["inner".concat(e.charAt(0).toUpperCase()+e.slice(1))];var n=g.select(t);if(e==="width"){i-=parseFloat(n.style("margin-left"),10);i-=parseFloat(n.style("margin-right"),10);i-=parseFloat(n.style("padding-left"),10);i-=parseFloat(n.style("padding-right"),10)}else{i-=parseFloat(n.style("margin-top"),10);i-=parseFloat(n.style("margin-bottom"),10);i-=parseFloat(n.style("padding-top"),10);i-=parseFloat(n.style("padding-bottom"),10)}return i}else{var o=parseFloat(g.select(t).style(e),10);if(typeof o==="number"&&o>0)return o;else return U(t.parentNode,e)}}function Z(t){return[U(t,"width"),U(t,"height")]}function $(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var i=window.pageXOffset!==undefined?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft;var n=window.pageYOffset!==undefined?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;var o=t.getBoundingClientRect();var r=o.height,s=o.left+i,a=o.top+n,l=o.width;return n+window.innerHeight>a+e&&n+e<a+r&&i+window.innerWidth>s+e&&i+e<s+l}function tt(t,e){this._select.style("cursor","auto");if(this._drawDepth<this._groupBy.length-1){var n=this._groupBy[this._drawDepth],o=n(t,e);this.hover(false);if(this._tooltip)this._tooltipClass.data([]).render();this._history.push({depth:this._depth,filter:this._filter});this.config({depth:this._drawDepth+1,filter:function t(e,i){return n(e,i)===o}}).render()}}function et(t,e){var n=this;this._select.style("cursor","auto");if(this._tooltip)this._tooltipClass.data([]).render();var i=this._id(t,e);if(!(i instanceof Array))i=[i];var o=this._hidden.indexOf(i[0]);var r=this._solo.indexOf(i[0]);var s=_.merge(this._legendClass.data().map(function(t,e){var i=n._id(t,e);if(!(i instanceof Array))i=[i];return i})).length;if(g.event.shiftKey){if(o<0&&!this._solo.length){this._hidden=this._hidden.concat(i);if(this._solo.length===s)this._solo=[];if(this._hidden.length===s)this._hidden=[];this.render()}else if(r>=0){this._solo=[];this._hidden=[];this.render()}}else{if(r<0&&this._hidden.length<s-1){this._solo=i;this._hidden=[]}else{this._solo=[];this._hidden=[]}this.render()}}function it(t,e){var o=this;if(this._shapeConfig.hoverOpacity!==1){var r=this._ids(t,e);this.hover(function(t,e){var i=o._ids(t,e);var n=_.min([i.length-1,r.length-1,o._drawDepth]);return r.slice(0,n+1).join("_")===i.slice(0,n+1).join("_")})}}function nt(i,n){var o=this;setTimeout(function(){if(o._shapeConfig.hoverOpacity!==1&&o._hover?o._hover(i,n):true){o.hover(false)}var t=o._tooltipClass.data();if(t.length&&o._tooltip){var e=t[0];while(e.__d3plus__&&e.data){e=e.data}if(o._id(e)===o._id(i))o._tooltipClass.data([]).render()}},50);this._select.style("cursor","auto")}function ot(t,e,i){var n=this;var o=g.event.touches?[g.event.touches[0].clientX,g.event.touches[0].clientY]:[g.event.clientX,g.event.clientY];var r=_.merge(this._legendClass.data().map(function(t,e){var i=n._id(t,e);if(!(i instanceof Array))i=[i];return i})).length;if(this._tooltip&&t){var s=this._id(t,e);if(s instanceof Array)s=s[0];this._select.style("cursor","pointer");this._tooltipClass.data([i||t]).footer(this._solo.length&&!this._solo.includes(s)?"Click to Highlight":this._solo.length===1&&this._solo.includes(s)||this._hidden.length===r-1?"Click to Reset":this._solo.includes(s)?"Click to Hide":this._hidden.includes(s)?"Click to Highlight":"Click to Highlight<br />Shift+Click to Hide").title(this._legendConfig.label?this._legendClass.label():W.bind(this)).position(o).config(m.configPrep.bind(this)(this._tooltipConfig)).config(m.configPrep.bind(this)(this._legendTooltip)).render()}}function rt(t,e,i){if(this._tooltip&&t){this._select.style("cursor","pointer");var n=g.event.touches?[g.event.touches[0].clientX,g.event.touches[0].clientY]:[g.event.clientX,g.event.clientY];this._tooltipClass.data([i||t]).footer(this._drawDepth<this._groupBy.length-1?"Click to Expand":"").title(this._drawLabel).position(n).config(m.configPrep.bind(this)(this._tooltipConfig)).render()}}function st(t){g.event.preventDefault();g.event.stopPropagation();if(this._tooltip&&!t)this._tooltipClass.data([]).render()}var at=false;function lt(){if(!this._container||!this._zoomGroup)return;var t=this._zoomHeight||this._height-this._margin.top-this._margin.bottom,e=this,i=this._zoomWidth||this._width-this._margin.left-this._margin.right;this._zoomBehavior.extent([[0,0],[i,t]]).scaleExtent([1,this._zoomMax]).translateExtent([[0,0],[i,t]]).on("zoom",ct.bind(this));this._zoomToBounds=dt.bind(this);var n=g.select(this._select.node().parentNode).selectAll("div.d3plus-zoom-control").data(this._zoom?[0]:[]);var o=n.enter().append("div").attr("class","d3plus-zoom-control");n.exit().remove();n=n.merge(o).style("position","absolute").style("top","".concat(this._margin.top,"px")).style("left","".concat(this._margin.left,"px"));o.append("div").attr("class","zoom-control zoom-in");n.select(".zoom-in").on("click",ut.bind(this,this._zoomFactor)).html("&#65291;");o.append("div").attr("class","zoom-control zoom-out");n.select(".zoom-out").on("click",ut.bind(this,1/this._zoomFactor)).html("&#65293;");o.append("div").attr("class","zoom-control zoom-reset");n.select(".zoom-reset").on("click",ut.bind(this,0)).html("&#8634");o.append("div").attr("class","zoom-control zoom-brush");n.select(".zoom-brush").on("click",function(){g.select(this).classed("active",!at).call(m.stylize,at?e._zoomControlStyle||{}:e._zoomControlStyleActive||{});ht.bind(e)(!at)}).html("&#164");n.selectAll(".zoom-control").call(m.stylize,e._zoomControlStyle).on("mouseenter",function(){g.select(this).call(m.stylize,e._zoomControlStyleHover||{})}).on("mouseleave",function(){g.select(this).call(m.stylize,g.select(this).classed("active")?e._zoomControlStyleActive||{}:e._zoomControlStyle||{})});this._zoomBrush.extent([[0,0],[i,t]]).filter(function(){return!g.event.button&&g.event.detail<2}).handleSize(this._zoomBrushHandleSize).on("start",gt.bind(this)).on("brush",ft.bind(this)).on("end",_t.bind(this));var r=this._container.selectAll("g.brush").data([0]);this._brushGroup=r.enter().append("g").attr("class","brush").merge(r).call(this._zoomBrush);ht.bind(this)();if(this._renderTiles)this._renderTiles(v.zoomTransform(this._container.node()),0)}function ht(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;at=t;if(at)this._brushGroup.style("display","inline");else this._brushGroup.style("display","none");if(!at&&this._zoom){this._container.call(this._zoomBehavior);if(!this._zoomScroll){this._container.on("wheel.zoom",null)}if(!this._zoomPan){this._container.on("mousedown.zoom mousemove.zoom",null).on("touchstart.zoom touchmove.zoom touchend.zoom touchcancel.zoom",null)}}else{this._container.on(".zoom",null)}}function ct(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(this._zoomGroup){if(!e)this._zoomGroup.attr("transform",t||g.event.transform);else this._zoomGroup.transition().duration(e).attr("transform",t||g.event.transform)}if(this._renderTiles)this._renderTiles(v.zoomTransform(this._container.node()),e)}function ut(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;if(!this._container)return;var e=this._zoomBehavior.extent().bind(document)()[1].map(function(t){return t/2}),i=this._zoomBehavior.scaleExtent(),n=v.zoomTransform(this._container.node());if(!t){n.k=i[0];n.x=0;n.y=0}else{var o=[(e[0]-n.x)/n.k,(e[1]-n.y)/n.k];n.k=Math.min(i[1],n.k*t);if(n.k<=i[0]){n.k=i[0];n.x=0;n.y=0}else{n.x+=e[0]-(o[0]*n.k+n.x);n.y+=e[1]-(o[1]*n.k+n.y)}}ct.bind(this)(n,this._duration)}function dt(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this._duration;var i=this._zoomBehavior.scaleExtent(),n=v.zoomTransform(this._container.node());if(t){var o=M(this._zoomBehavior.translateExtent()[1],2),r=o[0],s=o[1],a=t[1][0]-t[0][0],l=t[1][1]-t[0][1];var h=Math.min(i[1],1/Math.max(a/r,l/s));var c,u;if(a/l<r/s){h*=(s-this._zoomPadding*2)/s;c=(r-a*h)/2/h;u=this._zoomPadding/h}else{h*=(r-this._zoomPadding*2)/r;u=(s-l*h)/2/h;c=this._zoomPadding/h}n.x=(n.x-t[0][0]+c)*(n.k*h/n.k);n.y=(n.y-t[0][1]+u)*(n.k*h/n.k);n.k*=h;if(n.x>0)n.x=0;else if(n.x<r*-n.k+r)n.x=r*-n.k+r;if(n.y>0)n.y=0;else if(n.y<s*-n.k+s)n.y=s*-n.k+s}else{n.k=i[0];n.x=0;n.y=0}ct.bind(this)(n,e)}function ft(){vt.bind(this)()}function _t(){if(!g.event.selection)return;this._brushGroup.call(this._zoomBrush.move,null);dt.bind(this)(g.event.selection)}function gt(){vt.bind(this)()}function vt(){this._brushGroup.selectAll(".selection").call(m.attrize,this._zoomBrushSelectionStyle||{});this._brushGroup.selectAll(".handle").call(m.attrize,this._zoomBrushHandleStyle||{})}function pt(){return typeof window!=="undefined"?window.innerWidth>600:true}function mt(n){return n.reduce(function(t,e,i){if(!i)t+=e;else if(i===n.length-1&&i===1)t+=" and ".concat(e);else if(i===n.length-1)t+=", and ".concat(e);else t+=", ".concat(e);return t},"")}var yt=function(t){O(e,t);function e(){var a;S(this,e);a=D(this,T(e).call(this));a._aggs={};a._ariaHidden=true;a._backClass=(new s.TextBox).on("click",function(){if(a._history.length)a.config(a._history.pop()).render();else a.depth(a._drawDepth-1).filter(false).render()}).on("mousemove",function(){return a._backClass.select().style("cursor","pointer")});a._backConfig={fontSize:10,padding:5,resize:false};a._cache=true;a._color=function(t,e){return a._groupBy[0](t,e)};a._colorScaleClass=new r.ColorScale;a._colorScaleConfig={};a._colorScalePadding=pt;a._colorScalePosition="bottom";a._colorScaleMaxSize=600;var t=new o.Select;a._controlCache={};a._controlConfig={selectStyle:Object.assign({margin:"5px"},t.selectStyle())};a._controlPadding=pt;a._data=[];a._dataCutoff=100;a._detectResize=true;a._detectResizeDelay=400;a._detectVisible=true;a._detectVisibleInterval=1e3;a._downloadButton=false;a._downloadConfig={type:"png"};a._downloadPosition="top";a._duration=600;a._hidden=[];a._hiddenColor=m.constant("#aaa");a._hiddenOpacity=m.constant(.5);a._history=[];a._groupBy=[m.accessor("id")];a._legend=true;a._legendClass=new r.Legend;a._legendConfig={label:W.bind(B(a)),shapeConfig:{ariaLabel:W.bind(B(a)),labelConfig:{fontColor:undefined,fontResize:false,padding:0}}};a._legendCutoff=1;a._legendPadding=pt;a._legendPosition="bottom";a._legendSort=function(t,e){return a._drawLabel(t).localeCompare(a._drawLabel(e))};a._legendTooltip={};a._loadingHTML=m.constant('\n    <div style="left: 50%; top: 50%; position: absolute; transform: translate(-50%, -50%); font-family: \'Roboto\', \'Helvetica Neue\', Helvetica, Arial, sans-serif;">\n      <strong>Loading Visualization</strong>\n      <sub style="bottom: 0; display: block; line-height: 1; margin-top: 5px;"><a href="https://d3plus.org" target="_blank">Powered by D3plus</a></sub>\n    </div>');a._loadingMessage=true;a._lrucache=n(10);a._messageClass=new N;a._messageMask="rgba(0, 0, 0, 0.05)";a._messageStyle={bottom:"0",left:"0",position:"absolute",right:"0","text-align":"center",top:"0"};a._noDataHTML=m.constant("\n    <div style=\"left: 50%; top: 50%; position: absolute; transform: translate(-50%, -50%); font-family: 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;\">\n      <strong>No Data Available</strong>\n    </div>");a._noDataMessage=true;a._on={"click.shape":tt.bind(B(a)),"click.legend":et.bind(B(a)),mouseenter:it.bind(B(a)),mouseleave:nt.bind(B(a)),"mousemove.shape":rt.bind(B(a)),"mousemove.legend":ot.bind(B(a))};a._queue=[];a._scrollContainer=(typeof window==="undefined"?"undefined":z(window))===undefined?"":window;a._shape=m.constant("Rect");a._shapes=[];a._shapeConfig={ariaLabel:function t(e,i){return a._drawLabel(e,i)},fill:function t(e,i){while(e.__d3plus__&&e.data){e=e.data;i=e.i}if(a._colorScale){var n=a._colorScale(e,i);if(n!==undefined&&n!==null){var o=a._colorScaleClass._colorScale;var r=a._colorScaleClass.color();if(!o)return r instanceof Array?r[r.length-1]:r;else if(!o.domain().length)return o.range()[o.range().length-1];return o(n)}}var s=a._color(e,i);if(h.color(s))return s;return c.colorAssign(s)},labelConfig:{fontColor:function t(e,i){var n=typeof a._shapeConfig.fill==="function"?a._shapeConfig.fill(e,i):a._shapeConfig.fill;return c.colorContrast(n)}},opacity:m.constant(1),stroke:function t(e,i){var n=typeof a._shapeConfig.fill==="function"?a._shapeConfig.fill(e,i):a._shapeConfig.fill;return h.color(n).darker()},role:"presentation",strokeWidth:m.constant(0)};a._solo=[];a._svgDesc="";a._svgTitle="";a._timeline=true;a._timelineClass=(new b.Timeline).align("end");a._timelineConfig={brushing:false,padding:5};a._timelinePadding=pt;a._threshold=m.constant(1e-4);a._thresholdKey=undefined;a._thresholdName="Values";a._titleClass=new s.TextBox;a._titleConfig={ariaHidden:true,fontSize:12,padding:5,resize:false,textAnchor:"middle"};a._titlePadding=pt;a._tooltip=true;a._tooltipClass=new C.Tooltip;a._tooltipConfig={pointerEvents:"none",titleStyle:{"max-width":"200px"}};a._totalClass=new s.TextBox;a._totalConfig={fontSize:10,padding:5,resize:false,textAnchor:"middle"};a._totalFormat=function(t){return"Total: ".concat(y.formatAbbreviate(t,a._locale))};a._totalPadding=pt;a._zoom=false;a._zoomBehavior=v.zoom();a._zoomBrush=i.brush();a._zoomBrushHandleSize=1;a._zoomBrushHandleStyle={fill:"#444"};a._zoomBrushSelectionStyle={fill:"#777","stroke-width":0};a._zoomControlStyle={background:"rgba(255, 255, 255, 0.75)",border:"1px solid rgba(0, 0, 0, 0.75)",color:"rgba(0, 0, 0, 0.75)",display:"block",font:"900 15px/21px 'Roboto', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",height:"20px",margin:"5px",opacity:.75,padding:0,"text-align":"center",width:"20px"};a._zoomControlStyleActive={background:"rgba(0, 0, 0, 0.75)",color:"rgba(255, 255, 255, 0.75)",opacity:1};a._zoomControlStyleHover={cursor:"pointer",opacity:1};a._zoomFactor=2;a._zoomMax=16;a._zoomPadding=20;a._zoomPan=true;a._zoomScroll=true;return a}P(e,[{key:"_preDraw",value:function t(){var o=this;var r=this;this._drawDepth=this._depth!==void 0?this._depth:this._groupBy.length-1;this._id=this._groupBy[this._drawDepth];this._ids=function(e,i){return o._groupBy.map(function(t){return!e||e.__d3plus__&&!e.data?undefined:t(e.__d3plus__?e.data:e,e.__d3plus__?e.i:i)}).filter(function(t){return t!==undefined&&t!==null})};this._drawLabel=function(t,e){if(!t)return"";if(t._isAggregation){return"".concat(o._thresholdName," < ").concat(y.formatAbbreviate(t._threshold*100,o._locale),"%")}while(t.__d3plus__&&t.data){t=t.data;e=t.i}if(o._label)return o._label(t,e);var i=r._ids(t,e).slice(0,o._drawDepth+1);var n=i.reverse().find(function(t){return!(t instanceof Array)})||i[i.length-1];return n instanceof Array?mt(n):n};if(this._time&&!this._timeFilter&&this._data.length){var e=this._data.map(this._time).map(p.date);var i=this._data[0],n=0;if(this._discrete&&"_".concat(this._discrete)in this&&this["_".concat(this._discrete)](i,n)===this._time(i,n)){this._timeFilter=function(){return true}}else{var s=+_.max(e);this._timeFilter=function(t,e){return+p.date(o._time(t,e))===s}}}this._filteredData=[];this._legendData=[];var a=[];if(this._data.length){a=this._timeFilter?this._data.filter(this._timeFilter):this._data;if(this._filter)a=a.filter(this._filter);var l=f.nest();for(var h=0;h<=this._drawDepth;h++){l.key(this._groupBy[h])}if(this._discrete&&"_".concat(this._discrete)in this)l.key(this["_".concat(this._discrete)]);if(this._discrete&&"_".concat(this._discrete,"2")in this)l.key(this["_".concat(this._discrete,"2")]);var c=l.rollup(function(t){var e=m.merge(t,o._aggs);var i=o._id(e);if(!o._hidden.includes(i)&&(!o._solo.length||o._solo.includes(i)))o._filteredData.push(e);o._legendData.push(e)}).entries(a);this._filteredData=this._thresholdFunction(this._filteredData,c)}var u=f.nest().key(this._id).entries(this._filteredData).length;if(u>this._dataCutoff){if(this._userHover===undefined)this._userHover=this._shapeConfig.hoverOpacity||.5;this._shapeConfig.hoverOpacity=1}else if(this._userHover!==undefined){this._shapeConfig.hoverOpacity=this._userHover}if(this._noDataMessage&&!this._filteredData.length){this._messageClass.render({container:this._select.node().parentNode,html:this._noDataHTML(this),mask:false,style:this._messageStyle})}}},{key:"_draw",value:function t(){if(this._legendPosition==="left"||this._legendPosition==="right")Y.bind(this)(this._filteredData);if(this._colorScalePosition==="left"||this._colorScalePosition==="right"||this._colorScalePosition===false)V.bind(this)(this._filteredData);R.bind(this)();J.bind(this)(this._filteredData);Q.bind(this)(this._filteredData);X.bind(this)(this._filteredData);G.bind(this)(this._filteredData);if(this._legendPosition==="top"||this._legendPosition==="bottom")Y.bind(this)(this._legendData);if(this._colorScalePosition==="top"||this._colorScalePosition==="bottom")V.bind(this)(this._filteredData);this._shapes=[]}},{key:"_thresholdFunction",value:function t(e){return e}},{key:"render",value:function t(r){var s=this;this._margin={bottom:0,left:0,right:0,top:0};this._padding={bottom:0,left:0,right:0,top:0};this._transition=d.transition().duration(this._duration);if(this._select===void 0||this._select.node().tagName.toLowerCase()!=="svg"){var e=this._select===void 0?g.select("body").append("div"):this._select;var i=e.append("svg");this.select(i.node())}function a(){var t=this._select.style("display");this._select.style("display","none");var e=Z(this._select.node().parentNode),i=M(e,2),n=i[0],o=i[1];n-=parseFloat(this._select.style("border-left-width"),10);n-=parseFloat(this._select.style("border-right-width"),10);o-=parseFloat(this._select.style("border-top-width"),10);o-=parseFloat(this._select.style("border-bottom-width"),10);this._select.style("display",t);if(this._autoWidth){this.width(n);this._select.style("width","".concat(this._width,"px")).attr("width","".concat(this._width,"px"))}if(this._autoHeight){this.height(o);this._select.style("height","".concat(this._height,"px")).attr("height","".concat(this._height,"px"))}}if((!this._width||!this._height)&&(!this._detectVisible||$(this._select.node()))){this._autoWidth=this._width===undefined;this._autoHeight=this._height===undefined;a.bind(this)()}this._select.attr("class","d3plus-viz").attr("aria-hidden",this._ariaHidden).attr("aria-labelledby","".concat(this._uuid,"-title ").concat(this._uuid,"-desc")).attr("role","img").transition(d.transition).style("width",this._width!==undefined?"".concat(this._width,"px"):undefined).style("height",this._height!==undefined?"".concat(this._height,"px"):undefined).attr("width",this._width!==undefined?"".concat(this._width,"px"):undefined).attr("height",this._height!==undefined?"".concat(this._height,"px"):undefined);var n=this._select.selectAll("title").data([0]);var o=n.enter().append("title").attr("id","".concat(this._uuid,"-title"));n.merge(o).text(this._svgTitle);var l=this._select.selectAll("desc").data([0]);var h=l.enter().append("desc").attr("id","".concat(this._uuid,"-desc"));l.merge(h).text(this._svgDesc);this._visiblePoll=clearInterval(this._visiblePoll);this._resizePoll=clearTimeout(this._resizePoll);this._scrollPoll=clearTimeout(this._scrollPoll);g.select(this._scrollContainer).on("scroll.".concat(this._uuid),null);g.select(this._scrollContainer).on("resize.".concat(this._uuid),null);if(this._detectVisible&&this._select.style("visibility")==="hidden"){this._visiblePoll=setInterval(function(){if(s._select.style("visibility")!=="hidden"){s._visiblePoll=clearInterval(s._visiblePoll);s.render(r)}},this._detectVisibleInterval)}else if(this._detectVisible&&this._select.style("display")==="none"){this._visiblePoll=setInterval(function(){if(s._select.style("display")!=="none"){s._visiblePoll=clearInterval(s._visiblePoll);s.render(r)}},this._detectVisibleInterval)}else if(this._detectVisible&&!$(this._select.node())){g.select(this._scrollContainer).on("scroll.".concat(this._uuid),function(){if(!s._scrollPoll){s._scrollPoll=setTimeout(function(){if($(s._select.node())){g.select(s._scrollContainer).on("scroll.".concat(s._uuid),null);s.render(r)}s._scrollPoll=clearTimeout(s._scrollPoll)},s._detectVisibleInterval)}})}else{var c=u.queue();if(this._loadingMessage){this._messageClass.render({container:this._select.node().parentNode,html:this._loadingHTML(this),mask:this._filteredData?this._messageMask:false,style:this._messageStyle})}this._queue.forEach(function(t){var e=s._cache?s._lrucache.get(t[1]):undefined;if(!e)c.defer.apply(c,H(t));else s["_".concat(t[3])]=e});this._queue=[];c.awaitAll(function(){var i=s._data instanceof Array&&s._data.length>0?Object.keys(s._data[0]):[];var t=s._select.selectAll("g.data-table").data(!s._ariaHidden&&s._data instanceof Array&&s._data.length?[0]:[]);var e=t.enter().append("g").attr("class","data-table").attr("role","table");t.exit().remove();var n=t.merge(e).selectAll("text").data(s._data instanceof Array?_.range(0,s._data.length+1):[]);n.exit().remove();var o=n.merge(n.enter().append("text").attr("role","row")).selectAll("tspan").data(function(t,e){return i.map(function(t){return{role:e?"cell":"columnheader",text:e?s._data[e-1][t]:t}})});o.exit().remove();o.merge(o.enter().append("tspan")).attr("role",function(t){return t.role}).attr("dy","-1000px").html(function(t){return t.text});s._preDraw();s._draw(r);lt.bind(s)();if(s._messageClass._isVisible&&(!s._noDataMessage||s._filteredData.length))s._messageClass.hide();if(s._detectResize&&(s._autoWidth||s._autoHeight)){g.select(s._scrollContainer).on("resize.".concat(s._uuid),function(){s._resizePoll=clearTimeout(s._resizePoll);s._resizePoll=setTimeout(function(){s._resizePoll=clearTimeout(s._resizePoll);a.bind(s)();s.render(r)},s._detectResizeDelay)})}if(r)setTimeout(r,s._duration+100)})}g.select("body").on("touchstart.".concat(this._uuid),st.bind(this));return this}},{key:"active",value:function t(e){this._active=e;if(this._shapeConfig.activeOpacity!==1){this._shapes.forEach(function(t){return t.active(e)});if(this._legend)this._legendClass.active(e)}return this}},{key:"aggs",value:function t(e){return arguments.length?(this._aggs=m.assign(this._aggs,e),this):this._aggs}},{key:"ariaHidden",value:function t(e){return arguments.length?(this._ariaHidden=e,this):this._ariaHidden}},{key:"backConfig",value:function t(e){return arguments.length?(this._backConfig=m.assign(this._backConfig,e),this):this._backConfig}},{key:"cache",value:function t(e){return arguments.length?(this._cache=e,this):this._cache}},{key:"color",value:function t(e){return arguments.length?(this._color=!e||typeof e==="function"?e:m.accessor(e),this):this._color}},{key:"colorScale",value:function t(e){return arguments.length?(this._colorScale=!e||typeof e==="function"?e:m.accessor(e),this):this._colorScale}},{key:"colorScaleConfig",value:function t(e){return arguments.length?(this._colorScaleConfig=m.assign(this._colorScaleConfig,e),this):this._colorScaleConfig}},{key:"colorScalePadding",value:function t(e){return arguments.length?(this._colorScalePadding=typeof e==="function"?e:m.constant(e),this):this._colorScalePadding}},{key:"colorScalePosition",value:function t(e){return arguments.length?(this._colorScalePosition=e,this):this._colorScalePosition}},{key:"colorScaleMaxSize",value:function t(e){return arguments.length?(this._colorScaleMaxSize=e,this):this._colorScaleMaxSize}},{key:"controls",value:function t(e){return arguments.length?(this._controls=e,this):this._controls}},{key:"controlConfig",value:function t(e){return arguments.length?(this._controlConfig=m.assign(this._controlConfig,e),this):this._controlConfig}},{key:"controlPadding",value:function t(e){return arguments.length?(this._controlPadding=typeof e==="function"?e:m.constant(e),this):this._controlPadding}},{key:"data",value:function t(e,i){if(arguments.length){var n=this._queue.find(function(t){return t[3]==="data"});var o=[a.bind(this),e,i,"data"];if(n)this._queue[this._queue.indexOf(n)]=o;else this._queue.push(o);this._hidden=[];this._solo=[];return this}return this._data}},{key:"dataCutoff",value:function t(e){return arguments.length?(this._dataCutoff=e,this):this._dataCutoff}},{key:"depth",value:function t(e){return arguments.length?(this._depth=e,this):this._depth}},{key:"detectResize",value:function t(e){return arguments.length?(this._detectResize=e,this):this._detectResize}},{key:"detectResizeDelay",value:function t(e){return arguments.length?(this._detectResizeDelay=e,this):this._detectResizeDelay}},{key:"detectVisible",value:function t(e){return arguments.length?(this._detectVisible=e,this):this._detectVisible}},{key:"detectVisibleInterval",value:function t(e){return arguments.length?(this._detectVisibleInterval=e,this):this._detectVisibleInterval}},{key:"discrete",value:function t(e){return arguments.length?(this._discrete=e,this):this._discrete}},{key:"downloadButton",value:function t(e){return arguments.length?(this._downloadButton=e,this):this._downloadButton}},{key:"downloadConfig",value:function t(e){return arguments.length?(this._downloadConfig=m.assign(this._downloadConfig,e),this):this._downloadConfig}},{key:"downloadPosition",value:function t(e){return arguments.length?(this._downloadPosition=e,this):this._downloadPosition}},{key:"duration",value:function t(e){return arguments.length?(this._duration=e,this):this._duration}},{key:"filter",value:function t(e){return arguments.length?(this._filter=e,this):this._filter}},{key:"groupBy",value:function t(e){var i=this;if(!arguments.length)return this._groupBy;if(!(e instanceof Array))e=[e];return this._groupBy=e.map(function(t){if(typeof t==="function")return t;else{if(!i._aggs[t]){i._aggs[t]=function(t){var e=m.unique(t);return e.length===1?e[0]:e}}return m.accessor(t)}}),this}},{key:"height",value:function t(e){return arguments.length?(this._height=e,this):this._height}},{key:"hiddenColor",value:function t(e){return arguments.length?(this._hiddenColor=typeof e==="function"?e:m.constant(e),this):this._hiddenColor}},{key:"hiddenOpacity",value:function t(e){return arguments.length?(this._hiddenOpacity=typeof e==="function"?e:m.constant(e),this):this._hiddenOpacity}},{key:"hover",value:function t(e){var n=this;var i=this._hover=e;if(this._shapeConfig.hoverOpacity!==1){if(typeof e==="function"){var o=_.merge(this._shapes.map(function(t){return t.data()}));o=o.concat(this._legendClass.data());var r=e?o.filter(e):[];var s=[];r.map(this._ids).forEach(function(t){for(var e=1;e<=t.length;e++){s.push(JSON.stringify(t.slice(0,e)))}});s=s.filter(function(t,e){return s.indexOf(t)===e});if(s.length)i=function t(e,i){return s.includes(JSON.stringify(n._ids(e,i)))}}this._shapes.forEach(function(t){return t.hover(i)});if(this._legend)this._legendClass.hover(i)}return this}},{key:"label",value:function t(e){return arguments.length?(this._label=typeof e==="function"?e:m.constant(e),this):this._label}},{key:"legend",value:function t(e){return arguments.length?(this._legend=e,this):this._legend}},{key:"legendConfig",value:function t(e){return arguments.length?(this._legendConfig=m.assign(this._legendConfig,e),this):this._legendConfig}},{key:"legendCutoff",value:function t(e){return arguments.length?(this._legendCutoff=e,this):this._legendCutoff}},{key:"legendTooltip",value:function t(e){return arguments.length?(this._legendTooltip=m.assign(this._legendTooltip,e),this):this._legendTooltip}},{key:"legendPadding",value:function t(e){return arguments.length?(this._legendPadding=typeof e==="function"?e:m.constant(e),this):this._legendPadding}},{key:"legendPosition",value:function t(e){return arguments.length?(this._legendPosition=e,this):this._legendPosition}},{key:"legendSort",value:function t(e){return arguments.length?(this._legendSort=e,this):this._legendSort}},{key:"loadingHTML",value:function t(e){return arguments.length?(this._loadingHTML=typeof e==="function"?e:m.constant(e),this):this._loadingHTML}},{key:"loadingMessage",value:function t(e){return arguments.length?(this._loadingMessage=e,this):this._loadingMessage}},{key:"messageMask",value:function t(e){return arguments.length?(this._messageMask=e,this):this._messageMask}},{key:"messageStyle",value:function t(e){return arguments.length?(this._messageStyle=m.assign(this._messageStyle,e),this):this._messageStyle}},{key:"noDataHTML",value:function t(e){return arguments.length?(this._noDataHTML=typeof e==="function"?e:m.constant(e),this):this._noDataHTML}},{key:"noDataMessage",value:function t(e){return arguments.length?(this._noDataMessage=e,this):this._noDataMessage}},{key:"scrollContainer",value:function t(e){return arguments.length?(this._scrollContainer=e,this):this._scrollContainer}},{key:"select",value:function t(e){return arguments.length?(this._select=g.select(e),this):this._select}},{key:"shape",value:function t(e){return arguments.length?(this._shape=typeof e==="function"?e:m.constant(e),this):this._shape}},{key:"shapeConfig",value:function t(e){return arguments.length?(this._shapeConfig=m.assign(this._shapeConfig,e),this):this._shapeConfig}},{key:"svgDesc",value:function t(e){return arguments.length?(this._svgDesc=e,this):this._svgDesc}},{key:"svgTitle",value:function t(e){return arguments.length?(this._svgTitle=e,this):this._svgTitle}},{key:"threshold",value:function t(e){if(arguments.length){if(typeof e==="function"){this._threshold=e}else if(isFinite(e)&&!isNaN(e)){this._threshold=m.constant(e*1)}return this}else return this._threshold}},{key:"thresholdKey",value:function t(e){if(arguments.length){if(typeof e==="function"){this._thresholdKey=e}else{this._thresholdKey=m.accessor(e)}return this}else return this._thresholdKey}},{key:"thresholdName",value:function t(e){return arguments.length?(this._thresholdName=e,this):this._thresholdName}},{key:"time",value:function t(e){if(arguments.length){if(typeof e==="function"){this._time=e}else{this._time=m.accessor(e);if(!this._aggs[e]){this._aggs[e]=function(t){var e=m.unique(t);return e.length===1?e[0]:e}}}this._timeFilter=false;return this}else return this._time}},{key:"timeFilter",value:function t(e){return arguments.length?(this._timeFilter=e,this):this._timeFilter}},{key:"timeline",value:function t(e){return arguments.length?(this._timeline=e,this):this._timeline}},{key:"timelineConfig",value:function t(e){return arguments.length?(this._timelineConfig=m.assign(this._timelineConfig,e),this):this._timelineConfig}},{key:"timelinePadding",value:function t(e){return arguments.length?(this._timelinePadding=typeof e==="function"?e:m.constant(e),this):this._timelinePadding}},{key:"title",value:function t(e){return arguments.length?(this._title=typeof e==="function"?e:m.constant(e),this):this._title}},{key:"titleConfig",value:function t(e){return arguments.length?(this._titleConfig=m.assign(this._titleConfig,e),this):this._titleConfig}},{key:"titlePadding",value:function t(e){return arguments.length?(this._titlePadding=typeof e==="function"?e:m.constant(e),this):this._titlePadding}},{key:"tooltip",value:function t(e){return arguments.length?(this._tooltip=e,this):this._tooltip}},{key:"tooltipConfig",value:function t(e){return arguments.length?(this._tooltipConfig=m.assign(this._tooltipConfig,e),this):this._tooltipConfig}},{key:"total",value:function t(e){if(arguments.length){if(typeof e==="function")this._total=e;else if(e)this._total=m.accessor(e);else this._total=false;return this}else return this._total}},{key:"totalConfig",value:function t(e){return arguments.length?(this._totalConfig=m.assign(this._totalConfig,e),this):this._totalConfig}},{key:"totalFormat",value:function t(e){return arguments.length?(this._totalFormat=e,this):this._totalFormat}},{key:"totalPadding",value:function t(e){return arguments.length?(this._totalPadding=typeof e==="function"?e:m.constant(e),this):this._totalPadding}},{key:"width",value:function t(e){return arguments.length?(this._width=e,this):this._width}},{key:"zoom",value:function t(e){return arguments.length?(this._zoom=e,this):this._zoom}},{key:"zoomBrushHandleSize",value:function t(e){return arguments.length?(this._zoomBrushHandleSize=e,this):this._zoomBrushHandleSize}},{key:"zoomBrushHandleStyle",value:function t(e){return arguments.length?(this._zoomBrushHandleStyle=e,this):this._zoomBrushHandleStyle}},{key:"zoomBrushSelectionStyle",value:function t(e){return arguments.length?(this._zoomBrushSelectionStyle=e,this):this._zoomBrushSelectionStyle}},{key:"zoomControlStyle",value:function t(e){return arguments.length?(this._zoomControlStyle=e,this):this._zoomControlStyle}},{key:"zoomControlStyleActive",value:function t(e){return arguments.length?(this._zoomControlStyleActive=e,this):this._zoomControlStyleActive}},{key:"zoomControlStyleHover",value:function t(e){return arguments.length?(this._zoomControlStyleHover=e,this):this._zoomControlStyleHover}},{key:"zoomFactor",value:function t(e){return arguments.length?(this._zoomFactor=e,this):this._zoomFactor}},{key:"zoomMax",value:function t(e){return arguments.length?(this._zoomMax=e,this):this._zoomMax}},{key:"zoomPan",value:function t(e){return arguments.length?(this._zoomPan=e,this):this._zoomPan}},{key:"zoomPadding",value:function t(e){return arguments.length?(this._zoomPadding=e,this):this._zoomPadding}},{key:"zoomScroll",value:function t(e){return arguments.length?(this._zoomScroll=e,this):this._zoomScroll}}]);return e}(m.BaseClass);t.Viz=yt;t.dataFold=k;t.dataLoad=a;Object.defineProperty(t,"__esModule",{value:true})});(function(t){typeof define==="function"&&define.amd?define(t):t()})(function(){"use strict";var t=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function e(t,e){return e={exports:{}},t(e,e.exports),e.exports}var i="object";var n=function(t){return t&&t.Math==Math&&t};var u=n(typeof globalThis==i&&globalThis)||n(typeof window==i&&window)||n(typeof self==i&&self)||n(typeof t==i&&t)||Function("return this")();var o=function(t){try{return!!t()}catch(t){return true}};var f=!o(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7});var r={}.propertyIsEnumerable;var s=Object.getOwnPropertyDescriptor;var a=s&&!r.call({1:2},1);var l=a?function t(e){var i=s(this,e);return!!i&&i.enumerable}:r;var _={f:l};var h=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}};var c={}.toString;var d=function(t){return c.call(t).slice(8,-1)};var g="".split;var b=o(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return d(t)=="String"?g.call(t,""):Object(t)}:Object;var v=function(t){if(t==undefined)throw TypeError("Can't call method on "+t);return t};var p=function(t){return b(v(t))};var m=function(t){return typeof t==="object"?t!==null:typeof t==="function"};var y=function(t,e){if(!m(t))return t;var i,n;if(e&&typeof(i=t.toString)=="function"&&!m(n=i.call(t)))return n;if(typeof(i=t.valueOf)=="function"&&!m(n=i.call(t)))return n;if(!e&&typeof(i=t.toString)=="function"&&!m(n=i.call(t)))return n;throw TypeError("Can't convert object to primitive value")};var C={}.hasOwnProperty;var w=function(t,e){return C.call(t,e)};var k=u.document;var z=m(k)&&m(k.createElement);var S=function(t){return z?k.createElement(t):{}};var x=!f&&!o(function(){return Object.defineProperty(S("div"),"a",{get:function(){return 7}}).a!=7});var P=Object.getOwnPropertyDescriptor;var O=f?P:function t(e,i){e=p(e);i=y(i,true);if(x)try{return P(e,i)}catch(t){}if(w(e,i))return h(!_.f.call(e,i),e[i])};var T={f:O};var A=function(t){if(!m(t)){throw TypeError(String(t)+" is not an object")}return t};var B=Object.defineProperty;var D=f?B:function t(e,i,n){A(e);i=y(i,true);A(n);if(x)try{return B(e,i,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");if("value"in n)e[i]=n.value;return e};var M={f:D};var H=f?function(t,e,i){return M.f(t,e,h(1,i))}:function(t,e,i){t[e]=i;return t};var j=function(e,i){try{H(u,e,i)}catch(t){u[e]=i}return i};var F=e(function(t){var e="__core-js_shared__";var i=u[e]||j(e,{});(t.exports=function(t,e){return i[t]||(i[t]=e!==undefined?e:{})})("versions",[]).push({version:"3.1.3",mode:"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})});var E=F("native-function-to-string",Function.toString);var q=u.WeakMap;var L=typeof q==="function"&&/native code/.test(E.call(q));var N=0;var R=Math.random();var V=function(t){return"Symbol("+String(t===undefined?"":t)+")_"+(++N+R).toString(36)};var I=F("keys");var G=function(t){return I[t]||(I[t]=V(t))};var W={};var Y=u.WeakMap;var K,X,J;var Q=function(t){return J(t)?X(t):K(t,{})};var U=function(i){return function(t){var e;if(!m(t)||(e=X(t)).type!==i){throw TypeError("Incompatible receiver, "+i+" required")}return e}};if(L){var Z=new Y;var $=Z.get;var tt=Z.has;var et=Z.set;K=function(t,e){et.call(Z,t,e);return e};X=function(t){return $.call(Z,t)||{}};J=function(t){return tt.call(Z,t)}}else{var it=G("state");W[it]=true;K=function(t,e){H(t,it,e);return e};X=function(t){return w(t,it)?t[it]:{}};J=function(t){return w(t,it)}}var nt={set:K,get:X,has:J,enforce:Q,getterFor:U};var ot=e(function(t){var e=nt.get;var a=nt.enforce;var l=String(E).split("toString");F("inspectSource",function(t){return E.call(t)});(t.exports=function(t,e,i,n){var o=n?!!n.unsafe:false;var r=n?!!n.enumerable:false;var s=n?!!n.noTargetGet:false;if(typeof i=="function"){if(typeof e=="string"&&!w(i,"name"))H(i,"name",e);a(i).source=l.join(typeof e=="string"?e:"")}if(t===u){if(r)t[e]=i;else j(e,i);return}else if(!o){delete t[e]}else if(!s&&t[e]){r=true}if(r)t[e]=i;else H(t,e,i)})(Function.prototype,"toString",function t(){return typeof this=="function"&&e(this).source||E.call(this)})});var rt=u;var st=function(t){return typeof t=="function"?t:undefined};var at=function(t,e){return arguments.length<2?st(rt[t])||st(u[t]):rt[t]&&rt[t][e]||u[t]&&u[t][e]};var lt=Math.ceil;var ht=Math.floor;var ct=function(t){return isNaN(t=+t)?0:(t>0?ht:lt)(t)};var ut=Math.min;var dt=function(t){return t>0?ut(ct(t),9007199254740991):0};var ft=Math.max;var _t=Math.min;var gt=function(t,e){var i=ct(t);return i<0?ft(i+e,0):_t(i,e)};var vt=function(a){return function(t,e,i){var n=p(t);var o=dt(n.length);var r=gt(i,o);var s;if(a&&e!=e)while(o>r){s=n[r++];if(s!=s)return true}else for(;o>r;r++){if((a||r in n)&&n[r]===e)return a||r||0}return!a&&-1}};var pt={includes:vt(true),indexOf:vt(false)};var mt=pt.indexOf;var yt=function(t,e){var i=p(t);var n=0;var o=[];var r;for(r in i)!w(W,r)&&w(i,r)&&o.push(r);while(e.length>n)if(w(i,r=e[n++])){~mt(o,r)||o.push(r)}return o};var bt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];var Ct=bt.concat("length","prototype");var wt=Object.getOwnPropertyNames||function t(e){return yt(e,Ct)};var kt={f:wt};var zt=Object.getOwnPropertySymbols;var St={f:zt};var xt=at("Reflect","ownKeys")||function t(e){var i=kt.f(A(e));var n=St.f;return n?i.concat(n(e)):i};var Pt=function(t,e){var i=xt(e);var n=M.f;var o=T.f;for(var r=0;r<i.length;r++){var s=i[r];if(!w(t,s))n(t,s,o(e,s))}};var Ot=/#|\.prototype\./;var Tt=function(t,e){var i=Bt[At(t)];return i==Mt?true:i==Dt?false:typeof e=="function"?o(e):!!e};var At=Tt.normalize=function(t){return String(t).replace(Ot,".").toLowerCase()};var Bt=Tt.data={};var Dt=Tt.NATIVE="N";var Mt=Tt.POLYFILL="P";var Ht=Tt;var jt=T.f;var Ft=function(t,e){var i=t.target;var n=t.global;var o=t.stat;var r,s,a,l,h,c;if(n){s=u}else if(o){s=u[i]||j(i,{})}else{s=(u[i]||{}).prototype}if(s)for(a in e){h=e[a];if(t.noTargetGet){c=jt(s,a);l=c&&c.value}else l=s[a];r=Ht(n?a:i+(o?".":"#")+a,t.forced);if(!r&&l!==undefined){if(typeof h===typeof l)continue;Pt(h,l)}if(t.sham||l&&l.sham){H(h,"sham",true)}ot(s,a,h,t)}};var Et=function(t){if(typeof t!="function"){throw TypeError(String(t)+" is not a function")}return t};var qt=function(n,o,t){Et(n);if(o===undefined)return n;switch(t){case 0:return function(){return n.call(o)};case 1:return function(t){return n.call(o,t)};case 2:return function(t,e){return n.call(o,t,e)};case 3:return function(t,e,i){return n.call(o,t,e,i)}}return function(){return n.apply(o,arguments)}};var Lt=function(t){return Object(v(t))};var Nt=Array.isArray||function t(e){return d(e)=="Array"};var Rt=!!Object.getOwnPropertySymbols&&!o(function(){return!String(Symbol())});var Vt=u.Symbol;var It=F("wks");var Gt=function(t){return It[t]||(It[t]=Rt&&Vt[t]||(Rt?Vt:V)("Symbol."+t))};var Wt=Gt("species");var Yt=function(t,e){var i;if(Nt(t)){i=t.constructor;if(typeof i=="function"&&(i===Array||Nt(i.prototype)))i=undefined;else if(m(i)){i=i[Wt];if(i===null)i=undefined}}return new(i===undefined?Array:i)(e===0?0:e)};var Kt=[].push;var Xt=function(f){var _=f==1;var g=f==2;var v=f==3;var p=f==4;var m=f==6;var y=f==5||m;return function(t,e,i,n){var o=Lt(t);var r=b(o);var s=qt(e,i,3);var a=dt(r.length);var l=0;var h=n||Yt;var c=_?h(t,a):g?h(t,0):undefined;var u,d;for(;a>l;l++)if(y||l in r){u=r[l];d=s(u,l,o);if(f){if(_)c[l]=d;else if(d)switch(f){case 3:return true;case 5:return u;case 6:return l;case 2:Kt.call(c,u)}else if(p)return false}}return m?-1:v||p?p:c}};var Jt={forEach:Xt(0),map:Xt(1),filter:Xt(2),some:Xt(3),every:Xt(4),find:Xt(5),findIndex:Xt(6)};var Qt=Object.keys||function t(e){return yt(e,bt)};var Ut=f?Object.defineProperties:function t(e,i){A(e);var n=Qt(i);var o=n.length;var r=0;var s;while(o>r)M.f(e,s=n[r++],i[s]);return e};var Zt=at("document","documentElement");var $t=G("IE_PROTO");var te="prototype";var ee=function(){};var ie=function(){var t=S("iframe");var e=bt.length;var i="<";var n="script";var o=">";var r="java"+n+":";var s;t.style.display="none";Zt.appendChild(t);t.src=String(r);s=t.contentWindow.document;s.open();s.write(i+n+o+"document.F=Object"+i+"/"+n+o);s.close();ie=s.F;while(e--)delete ie[te][bt[e]];return ie()};var ne=Object.create||function t(e,i){var n;if(e!==null){ee[te]=A(e);n=new ee;ee[te]=null;n[$t]=e}else n=ie();return i===undefined?n:Ut(n,i)};W[$t]=true;var oe=Gt("unscopables");var re=Array.prototype;if(re[oe]==undefined){H(re,oe,ne(null))}var se=function(t){re[oe][t]=true};var ae=Jt.find;var le="find";var he=true;if(le in[])Array(1)[le](function(){he=false});Ft({target:"Array",proto:true,forced:he},{find:function t(e){return ae(this,e,arguments.length>1?arguments[1]:undefined)}});se(le);var ce=pt.includes;Ft({target:"Array",proto:true},{includes:function t(e){return ce(this,e,arguments.length>1?arguments[1]:undefined)}});se("includes");var ue=Object.assign;var de=!ue||o(function(){var t={};var e={};var i=Symbol();var n="abcdefghijklmnopqrst";t[i]=7;n.split("").forEach(function(t){e[t]=t});return ue({},t)[i]!=7||Qt(ue({},e)).join("")!=n})?function t(e,i){var n=Lt(e);var o=arguments.length;var r=1;var s=St.f;var a=_.f;while(o>r){var l=b(arguments[r++]);var h=s?Qt(l).concat(s(l)):Qt(l);var c=h.length;var u=0;var d;while(c>u){d=h[u++];if(!f||a.call(l,d))n[d]=l[d]}}return n}:ue;Ft({target:"Object",stat:true,forced:Object.assign!==de},{assign:de});var fe=Gt("match");var _e=function(t){var e;return m(t)&&((e=t[fe])!==undefined?!!e:d(t)=="RegExp")};var ge=function(t){if(_e(t)){throw TypeError("The method doesn't accept regular expressions")}return t};var ve=Gt("match");var pe=function(e){var i=/./;try{"/./"[e](i)}catch(t){try{i[ve]=false;return"/./"[e](i)}catch(t){}}return false};Ft({target:"String",proto:true,forced:!pe("includes")},{includes:function t(e){return!!~String(v(this)).indexOf(ge(e),arguments.length>1?arguments[1]:undefined)}});var me="".startsWith;var ye=Math.min;Ft({target:"String",proto:true,forced:!pe("startsWith")},{startsWith:function t(e){var i=String(v(this));ge(e);var n=dt(ye(arguments.length>1?arguments[1]:undefined,i.length));var o=String(e);return me?me.call(i,o,n):i.slice(n,n+o.length)===o}});if(typeof window!=="undefined"){(function(){var n=function(t,e){var i=t.nodeType;if(i===3){e.push(t.textContent.replace(/&/,"&amp;").replace(/</,"&lt;").replace(">","&gt;"))}else if(i===1){e.push("<",t.tagName);if(t.hasAttributes()){[].forEach.call(t.attributes,function(t){e.push(" ",t.item.name,"='",t.item.value,"'")})}if(t.hasChildNodes()){e.push(">");[].forEach.call(t.childNodes,function(t){n(t,e)});e.push("</",t.tagName,">")}else{e.push("/>")}}else if(i==8){e.push("\x3c!--",t.nodeValue,"--\x3e")}};Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){var t=[];var e=this.firstChild;while(e){n(e,t);e=e.nextSibling}return t.join("")},set:function(t){while(this.firstChild){this.removeChild(this.firstChild)}try{var e=new DOMParser;e.async=false;var i="<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>"+t+"</svg>";var n=e.parseFromString(i,"text/xml").documentElement;var o=n.firstChild;while(o){this.appendChild(this.ownerDocument.importNode(o,true));o=o.nextSibling}}catch(t){}}});Object.defineProperty(SVGElement.prototype,"innerSVG",{get:function(){return this.innerHTML},set:function(t){this.innerHTML=t}})})()}});