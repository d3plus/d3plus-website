/*
  d3plus-network v0.5.11
  Javascript network visualizations built upon d3 modules.
  Copyright (c) 2019 D3plus - https://d3plus.org
  @license MIT
*/
(function(e,n){typeof exports==="object"&&typeof module!=="undefined"?n(exports,require("d3-array"),require("d3-collection"),require("d3-force"),require("d3-polygon"),require("d3-scale"),require("d3-zoom"),require("d3plus-common"),require("d3plus-shape"),require("d3plus-viz"),require("d3plus-color"),require("d3-sankey")):typeof define==="function"&&define.amd?define("d3plus-network",["exports","d3-array","d3-collection","d3-force","d3-polygon","d3-scale","d3-zoom","d3plus-common","d3plus-shape","d3plus-viz","d3plus-color","d3-sankey"],n):(e=e||self,n(e.d3plus={},e.d3Array,e.d3Collection,e.d3Force,e.d3Polygon,e.scales,e.d3Zoom,e.d3plusCommon,e.shapes,e.d3plusViz,e.d3plusColor,e.d3Sankey))})(this,function(e,H,U,J,K,Z,f,Q,$,a,I,n){"use strict";function ee(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){ee=function(e){return typeof e}}else{ee=function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}}return ee(e)}function t(e,n){if(!(e instanceof n)){throw new TypeError("Cannot call a class as a function")}}function r(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}function i(e,n,t){if(n)r(e.prototype,n);if(t)r(e,t);return e}function o(e,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:true,configurable:true}});if(n)s(e,n)}function ne(e){ne=Object.setPrototypeOf?Object.getPrototypeOf:function e(n){return n.__proto__||Object.getPrototypeOf(n)};return ne(e)}function s(e,n){s=Object.setPrototypeOf||function e(n,t){n.__proto__=t;return n};return s(e,n)}function l(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function h(e,n){if(n&&(typeof n==="object"||typeof n==="function")){return n}return l(e)}function u(e,n){while(!Object.prototype.hasOwnProperty.call(e,n)){e=ne(e);if(e===null)break}return e}function te(e,n,t){if(typeof Reflect!=="undefined"&&Reflect.get){te=Reflect.get}else{te=function e(n,t,r){var i=u(n,t);if(!i)return;var a=Object.getOwnPropertyDescriptor(i,t);if(a.get){return a.get.call(r)}return a.value}}return te(e,n,t||e)}var c=function(e){o(X,e);function X(){var c;t(this,X);c=h(this,ne(X).call(this));c._links=[];c._linkSize=Q.constant(1);c._linkSizeMin=1;c._linkSizeScale="sqrt";c._noDataMessage=false;c._nodes=[];c._on["click.shape"]=function(e,n){c._tooltipClass.data([]).render();if(c._hover&&c._drawDepth>=c._groupBy.length-1){var t="".concat(c._nodeGroupBy&&c._nodeGroupBy[c._drawDepth](e,n)?c._nodeGroupBy[c._drawDepth](e,n):c._id(e,n));if(c._focus&&c._focus===t){c.active(false);c._on.mouseenter.bind(l(c))(e,n);c._focus=undefined;c._zoomToBounds(null)}else{c.hover(false);var r=c._linkLookup[t],i=c._nodeLookup[t];var a=[t];var o=[i.x-i.r,i.x+i.r],s=[i.y-i.r,i.y+i.r];r.forEach(function(e){a.push(e.id);if(e.x-e.r<o[0])o[0]=e.x-e.r;if(e.x+e.r>o[1])o[1]=e.x+e.r;if(e.y-e.r<s[0])s[0]=e.y-e.r;if(e.y+e.r>s[1])s[1]=e.y+e.r});c.active(function(e,n){if(e.source&&e.target)return e.source.id===t||e.target.id===t;else return a.includes("".concat(c._ids(e,n)[c._drawDepth]))});c._focus=t;var u=f.zoomTransform(c._container.node());o=o.map(function(e){return e*u.k+u.x});s=s.map(function(e){return e*u.k+u.y});c._zoomToBounds([[o[0],s[0]],[o[1],s[1]]])}}};c._on["click.legend"]=function(e,n){var t=c._id(e);var r=c._ids(e);r=r[r.length-1];if(c._hover&&c._drawDepth>=c._groupBy.length-1){if(c._focus&&c._focus===t){c.active(false);c._focus=undefined;c._zoomToBounds(null)}else{c.hover(false);var i=t.map(function(e){return c._nodeLookup[e]});var a=["".concat(r)];var o=[i[0].x-i[0].r,i[0].x+i[0].r],s=[i[0].y-i[0].r,i[0].y+i[0].r];i.forEach(function(e){a.push(e.id);if(e.x-e.r<o[0])o[0]=e.x-e.r;if(e.x+e.r>o[1])o[1]=e.x+e.r;if(e.y-e.r<s[0])s[0]=e.y-e.r;if(e.y+e.r>s[1])s[1]=e.y+e.r});c.active(function(e,n){if(e.source&&e.target)return a.includes(e.source.id)&&a.includes(e.target.id);else{var t=c._ids(e,n);return a.includes("".concat(t[t.length-1]))}});c._focus=t;var u=f.zoomTransform(c._container.node());o=o.map(function(e){return e*u.k+u.x});s=s.map(function(e){return e*u.k+u.y});c._zoomToBounds([[o[0],s[0]],[o[1],s[1]]])}c._on.mouseenter.bind(l(c))(e,n);c._on["mousemove.legend"].bind(l(c))(e,n)}};c._on.mouseenter=function(){};c._on["mouseleave.shape"]=function(){c.hover(false)};var u=c._on["mousemove.shape"];c._on["mousemove.shape"]=function(e,n){u(e,n);var t="".concat(c._nodeGroupBy&&c._nodeGroupBy[c._drawDepth](e,n)?c._nodeGroupBy[c._drawDepth](e,n):c._id(e,n)),r=c._linkLookup[t],i=c._nodeLookup[t];var a=[t];var o=[i.x-i.r,i.x+i.r],s=[i.y-i.r,i.y+i.r];r.forEach(function(e){a.push(e.id);if(e.x-e.r<o[0])o[0]=e.x-e.r;if(e.x+e.r>o[1])o[1]=e.x+e.r;if(e.y-e.r<s[0])s[0]=e.y-e.r;if(e.y+e.r>s[1])s[1]=e.y+e.r});c.hover(function(e,n){if(e.source&&e.target)return e.source.id===t||e.target.id===t;else return a.includes("".concat(c._ids(e,n)[c._drawDepth]))})};c._sizeMin=5;c._sizeScale="sqrt";c._shape=Q.constant("Circle");c._shapeConfig=Q.assign(c._shapeConfig,{ariaLabel:function e(n,t){var r=c._size?", ".concat(c._size(n,t)):"";return"".concat(c._drawLabel(n,t)).concat(r,".")},labelConfig:{duration:0,fontMin:1,fontResize:true,labelPadding:0,textAnchor:"middle",verticalAlign:"middle"},Path:{fill:"none",label:false,stroke:"#eee"}});c._x=Q.accessor("x");c._y=Q.accessor("y");c._zoom=true;return c}i(X,[{key:"_draw",value:function e(n){var i=this;te(ne(X.prototype),"_draw",this).call(this,n);var t=this._height-this._margin.top-this._margin.bottom,r="translate(".concat(this._margin.left,", ").concat(this._margin.top,")"),a=this._transition,o=this._width-this._margin.left-this._margin.right;var s=this._filteredData.reduce(function(e,n,t){e[i._id(n,t)]=n;return e},{});var u=this._nodes.reduce(function(e,n,t){e[i._nodeGroupBy?i._nodeGroupBy[i._drawDepth](n,t):n.id]=n;return e},{});u=Array.from(new Set(Object.keys(s).concat(Object.keys(u)))).map(function(e,n){var t=s[e],r=u[e];if(r===undefined)return false;return{__d3plus__:true,data:t||r,i:n,id:e,fx:t!==undefined&&i._x(t)!==undefined?i._x(t):i._x(r),fy:t!==undefined&&i._y(t)!==undefined?i._y(t):i._y(r),node:r,r:i._size?t!==undefined&&i._size(t)!==undefined?i._size(t):i._size(r):i._sizeMin,shape:t!==undefined&&i._shape(t)!==undefined?i._shape(t):i._shape(r)}}).filter(function(e){return e});var c=this._nodeLookup=u.reduce(function(e,n){e[n.id]=n;return e},{});var f=u.map(function(e){return e.node});var l=this._links.map(function(e){var n=ee(e.source);return{size:i._linkSize(e),source:n==="number"?u[f.indexOf(i._nodes[e.source])]:n==="string"?c[e.source]:c[e.source.id],target:n==="number"?u[f.indexOf(i._nodes[e.target])]:n==="string"?c[e.target]:c[e.target.id]}});this._linkLookup=l.reduce(function(e,n){if(!e[n.source.id])e[n.source.id]=[];e[n.source.id].push(n.target);if(!e[n.target.id])e[n.target.id]=[];e[n.target.id].push(n.source);return e},{});var h=u.some(function(e){return e.fx===undefined||e.fy===undefined});if(h){var d=Z.scaleLinear().domain(H.extent(l,function(e){return e.size})).range([.1,.5]);var v=J.forceSimulation().force("link",J.forceLink(l).id(function(e){return e.id}).distance(1).strength(function(e){return d(e.size)}).iterations(4)).force("charge",J.forceManyBody().strength(-1)).stop();var p=300;var _=.001;var g=1-Math.pow(_,1/p);v.velocityDecay(0);v.alphaMin(_);v.alphaDecay(g);v.alphaDecay(0);v.nodes(u);v.tick(p).stop();var y=K.polygonHull(u.map(function(e){return[e.vx,e.vy]}));var m=$.largestRect(y),k=m.angle,b=m.cx,x=m.cy;u.forEach(function(e){var n=$.pointRotate([e.vx,e.vy],-1*(Math.PI/180*k),[b,x]);e.fx=n[0];e.fy=n[1]})}var z=H.extent(u.map(function(e){return e.fx})),w=H.extent(u.map(function(e){return e.fy}));var S=Z.scaleLinear().domain(z).range([0,o]),M=Z.scaleLinear().domain(w).range([0,t]);var O=(z[1]-z[0])/(w[1]-w[0]),P=o/t;if(O>P){var C=t*P/O;M.range([(t-C)/2,t-(t-C)/2])}else{var E=o*O/P;S.range([(o-E)/2,o-(o-E)/2])}u.forEach(function(e){e.x=S(e.fx);e.y=M(e.fy)});var j=H.extent(u.map(function(e){return e.r}));var L=this._sizeMax||H.max([1,H.min(H.merge(u.map(function(n){return u.map(function(e){return n===e?null:$.pointDistance([n.x,n.y],[e.x,e.y])})})))/2]);var A=Z["scale".concat(this._sizeScale.charAt(0).toUpperCase()).concat(this._sizeScale.slice(1))]().domain(j).range([j[0]===j[1]?L:H.min([L/2,this._sizeMin]),L]),q=S.domain(),B=M.domain();var T=q[1]-q[0],D=B[1]-B[0];u.forEach(function(e){var n=A(e.r);if(q[0]>S.invert(e.x-n))q[0]=S.invert(e.x-n);if(q[1]<S.invert(e.x+n))q[1]=S.invert(e.x+n);if(B[0]>M.invert(e.y-n))B[0]=M.invert(e.y-n);if(B[1]<M.invert(e.y+n))B[1]=M.invert(e.y+n)});var G=q[1]-q[0],I=B[1]-B[0];L*=H.min([T/G,D/I]);A.range([j[0]===j[1]?L:H.min([L/2,this._sizeMin]),L]);S.domain(q);M.domain(B);u.forEach(function(e){e.x=S(e.fx);e.fx=e.x;e.y=M(e.fy);e.fy=e.y;e.r=A(e.r);e.width=e.r*2;e.height=e.r*2});this._container=this._select.selectAll("svg.d3plus-network").data([0]);this._container=this._container.enter().append("svg").attr("class","d3plus-network").attr("opacity",0).attr("width",o).attr("height",t).attr("x",this._margin.left).attr("y",this._margin.top).style("background-color","transparent").merge(this._container);this._container.transition(this._transition).attr("opacity",1).attr("width",o).attr("height",t).attr("x",this._margin.left).attr("y",this._margin.top);var R=this._container.selectAll("rect.d3plus-network-hitArea").data([0]);R.enter().append("rect").attr("class","d3plus-network-hitArea").merge(R).attr("width",o).attr("height",t).attr("fill","transparent").on("click",function(){if(i._focus){i.active(false);i._focus=undefined;i._zoomToBounds(null)}});this._zoomGroup=this._container.selectAll("g.d3plus-network-zoomGroup").data([0]);var W=this._zoomGroup=this._zoomGroup.enter().append("g").attr("class","d3plus-network-zoomGroup").merge(this._zoomGroup);var N=H.extent(l,function(e){return e.size});if(N[0]!==N[1]){var F=Z["scale".concat(this._linkSizeScale.charAt(0).toUpperCase()).concat(this._linkSizeScale.slice(1))]().domain(N).range([this._linkSizeMin,A.range()[0]]);l.forEach(function(e){e.size=F(e.size)})}var V=Q.configPrep.bind(this)(this._shapeConfig,"edge","Path");delete V.on;this._shapes.push((new $.Path).config(V).strokeWidth(function(e){return e.size}).activeStyle({"stroke-width":function e(n){return n.size}}).d(function(e){return"M".concat(e.source.x,",").concat(e.source.y," ").concat(e.target.x,",").concat(e.target.y)}).data(l).select(Q.elem("g.d3plus-network-links",{parent:W,transition:a,enter:{transform:r},update:{transform:r}}).node()).render());var Y={label:function e(n){return u.length<=i._dataCutoff||i._hover&&i._hover(n)||i._active&&i._active(n)?i._drawLabel(n.data||n.node,n.i):false},select:Q.elem("g.d3plus-network-nodes",{parent:W,transition:a,enter:{transform:r},update:{transform:r}}).node()};U.nest().key(function(e){return e.shape}).entries(u).forEach(function(e){i._shapes.push((new $[e.key]).config(Q.configPrep.bind(i)(i._shapeConfig,"shape",e.key)).config(Y).config(Y[e.key]||{}).data(e.values).render())});return this}},{key:"hover",value:function e(n){this._hover=n;if(this._nodes.length<this._dataCutoff){this._shapes.forEach(function(e){return e.hover(n)});if(this._legend)this._legendClass.hover(n)}return this}},{key:"links",value:function e(n,t){if(arguments.length){var r=this._queue.find(function(e){return e[3]==="links"});var i=[a.dataLoad.bind(this),n,t,"links"];if(r)this._queue[this._queue.indexOf(r)]=i;else this._queue.push(i);return this}return this._links}},{key:"linkSize",value:function e(n){return arguments.length?(this._linkSize=typeof n==="function"?n:Q.constant(n),this):this._linkSize}},{key:"linkSizeMin",value:function e(n){return arguments.length?(this._linkSizeMin=n,this):this._linkSizeMin}},{key:"linkSizeScale",value:function e(n){return arguments.length?(this._linkSizeScale=n,this):this._linkSizeScale}},{key:"nodeGroupBy",value:function e(n){var t=this;if(!arguments.length)return this._nodeGroupBy;if(!(n instanceof Array))n=[n];return this._nodeGroupBy=n.map(function(e){if(typeof e==="function")return e;else{if(!t._aggs[e]){t._aggs[e]=function(e){var n=Array.from(new Set(e));return n.length===1?n[0]:n}}return Q.accessor(e)}}),this}},{key:"nodes",value:function e(n,t){if(arguments.length){var r=this._queue.find(function(e){return e[3]==="nodes"});var i=[a.dataLoad.bind(this),n,t,"nodes"];if(r)this._queue[this._queue.indexOf(r)]=i;else this._queue.push(i);return this}return this._nodes}},{key:"size",value:function e(n){return arguments.length?(this._size=typeof n==="function"||!n?n:Q.accessor(n),this):this._size}},{key:"sizeMax",value:function e(n){return arguments.length?(this._sizeMax=n,this):this._sizeMax}},{key:"sizeMin",value:function e(n){return arguments.length?(this._sizeMin=n,this):this._sizeMin}},{key:"sizeScale",value:function e(n){return arguments.length?(this._sizeScale=n,this):this._sizeScale}},{key:"x",value:function e(n){if(arguments.length){if(typeof n==="function")this._x=n;else{this._x=Q.accessor(n);if(!this._aggs[n])this._aggs[n]=function(e){return H.mean(e)}}return this}else return this._x}},{key:"y",value:function e(n){if(arguments.length){if(typeof n==="function")this._y=n;else{this._y=Q.accessor(n);if(!this._aggs[n])this._aggs[n]=function(e){return H.mean(e)}}return this}else return this._y}}]);return X}(a.Viz);var d=function(e){o(G,e);function G(){var u;t(this,G);u=h(this,ne(G).call(this));u._links=[];u._linkSize=Q.constant(1);u._linkSizeMin=1;u._linkSizeScale="sqrt";u._noDataMessage=false;u._nodes=[];u._on.mouseenter=function(){};u._on["mouseleave.shape"]=function(){u.hover(false)};var c=u._on["mousemove.shape"];u._on["mousemove.shape"]=function(e,n){c(e,n);if(u._focus&&u._focus===e.id){u.hover(false);u._on.mouseenter.bind(l(u))(e,n);u._focus=undefined}else{var t=u._nodeGroupBy&&u._nodeGroupBy[u._drawDepth](e,n)?u._nodeGroupBy[u._drawDepth](e,n):u._id(e,n),r=u._linkLookup[t],i=u._nodeLookup[t];var a=[i.id];var o=[i.x-i.r,i.x+i.r],s=[i.y-i.r,i.y+i.r];r.forEach(function(e){a.push(e.id);if(e.x-e.r<o[0])o[0]=e.x-e.r;if(e.x+e.r>o[1])o[1]=e.x+e.r;if(e.y-e.r<s[0])s[0]=e.y-e.r;if(e.y+e.r>s[1])s[1]=e.y+e.r});u.hover(function(e,n){if(e.source&&e.target)return e.source.id===i.id||e.target.id===i.id;else return a.includes(u._ids(e,n)[u._drawDepth])})}};u._on["click.shape"]=function(e){u._center=e.id;u._draw()};u._sizeMin=5;u._sizeScale="sqrt";u._shape=Q.constant("Circle");u._shapeConfig=Q.assign(u._shapeConfig,{ariaLabel:function e(n,t){var r=u._size?", ".concat(u._size(n,t)):"";return"".concat(u._drawLabel(n,t)).concat(r,".")},labelConfig:{duration:0,fontMin:1,fontResize:true,labelPadding:0,textAnchor:"middle",verticalAlign:"middle"},Path:{fill:"none",label:false,stroke:"#eee",strokeWidth:1}});return u}i(G,[{key:"_draw",value:function e(n){var c=this;te(ne(G.prototype),"_draw",this).call(this,n);var i=this._filteredData.reduce(function(e,n,t){e[c._id(n,t)]=n;return e},{});var f=this._nodes;if(!this._nodes.length&&this._links.length){var t=Array.from(new Set(this._links.reduce(function(e,n){return e.concat([n.source,n.target])},[])));f=t.map(function(e){return ee(e)==="object"?e:{id:e}})}f=f.reduce(function(e,n,t){e[c._nodeGroupBy?c._nodeGroupBy[c._drawDepth](n,t):c._id(n,t)]=n;return e},{});f=Array.from(new Set(Object.keys(i).concat(Object.keys(f)))).map(function(e,n){var t=i[e],r=f[e];if(r===undefined)return false;return{__d3plus__:true,data:t||r,i:n,id:e,node:r,shape:t!==undefined&&c._shape(t)!==undefined?c._shape(t):c._shape(r)}}).filter(function(e){return e});var r=this._nodeLookup=f.reduce(function(e,n){e[n.id]=n;return e},{});var a=this._links.map(function(t){var e=["source","target"];var n=e.reduce(function(e,n){e[n]=typeof t[n]==="number"?f[t[n]]:r[t[n].id||t[n]];return e},{});n.size=c._linkSize(t);return n});var o=a.reduce(function(e,n){if(!e[n.source.id]){e[n.source.id]=[]}e[n.source.id].push(n);if(!e[n.target.id]){e[n.target.id]=[]}e[n.target.id].push(n);return e},{});var l=this._height-this._margin.top-this._margin.bottom,s="translate(".concat(this._margin.left,", ").concat(this._margin.top,")"),u=this._transition,h=this._width-this._margin.left-this._margin.right;var d=[],v=H.min([l,h])/2,p=v/3;var _=p,g=p*2;var y=r[this._center];y.x=h/2;y.y=l/2;y.r=this._sizeMin?H.max([this._sizeMin,_*.65]):this._sizeMax?H.min([this._sizeMax,_*.65]):_*.65;var m=[y],k=[];o[this._center].forEach(function(e){var n=e.source.id===c._center?e.target:e.source;n.edges=o[n.id].filter(function(e){return e.source.id!==c._center||e.target.id!==c._center});n.edge=e;m.push(n);k.push(n)});k.sort(function(e,n){return e.edges.length-n.edges.length});var b=[];var x=0;k.forEach(function(e){var i=e.id;e.edges=e.edges.filter(function(e){return!m.includes(e.source)&&e.target.id===i||!m.includes(e.target)&&e.source.id===i});x+=e.edges.length||1;e.edges.forEach(function(e){var n=e.source,t=e.target;var r=t.id===i?n:t;m.push(r)})});var z=Math.PI*2;var w=0;k.forEach(function(a,e){var o=a.edges.length||1;var n=z/x*o;if(e===0){w-=n/2}var s=w+n/2-z/4;a.radians=s;a.x=h/2+_*Math.cos(s);a.y=l/2+_*Math.sin(s);w+=n;a.edges.forEach(function(e,n){var t=e.source.id===a.id?e.target:e.source;var r=z/x;var i=s-r*o/2+r/2+r*n;t.radians=i;t.x=h/2+g*Math.cos(i);t.y=l/2+g*Math.sin(i);b.push(t)})});var S=p/2;var M=p/4;var O=S/2-4;if(S/2-4<8){O=H.min([S/2,8])}var P=M/2-4;if(M/2-4<4){P=H.min([M/2,4])}if(P>p/10){P=p/10}if(P>O&&P>10){P=O*.75}if(O>P*1.5){O=P*1.5}O=Math.floor(O);P=Math.floor(P);var C;if(this._size){var E=H.extent(i,function(e){return e.size});if(E[0]===E[1]){E[0]=0}C=Z.scaleLinear().domain(E).rangeRound([3,H.min([O,P])]);var j=y.size;y.r=C(j)}else{C=Z.scaleLinear().domain([1,2]).rangeRound([O,P])}b.forEach(function(e){e.ring=2;var n=c._size?e.size:2;e.r=c._sizeMin?H.max([c._sizeMin,C(n)]):c._sizeMax?H.min([c._sizeMax,C(n)]):C(n)});k.forEach(function(e){e.ring=1;var n=c._size?e.size:1;e.r=c._sizeMin?H.max([c._sizeMin,C(n)]):c._sizeMax?H.min([c._sizeMax,C(n)]):C(n)});f=[y].concat(k).concat(b);k.forEach(function(u){var e=["source","target"];var t=u.edge;e.forEach(function(n){t[n]=f.find(function(e){return e.id===t[n].id})});d.push(t);o[u.id].forEach(function(r){var n=r.source.id===u.id?r.target:r.source;if(n.id!==y.id){var i=b.find(function(e){return e.id===n.id});if(!i){i=k.find(function(e){return e.id===n.id})}if(i){r.spline=true;var a=h/2;var o=l/2;var s=_+(g-_)*.5;var e=["source","target"];e.forEach(function(n,e){r["".concat(n,"X")]=r[n].x+Math.cos(r[n].ring===2?r[n].radians+Math.PI:r[n].radians)*r[n].r;r["".concat(n,"Y")]=r[n].y+Math.sin(r[n].ring===2?r[n].radians+Math.PI:r[n].radians)*r[n].r;r["".concat(n,"BisectX")]=a+s*Math.cos(r[n].radians);r["".concat(n,"BisectY")]=o+s*Math.sin(r[n].radians);r[n]=f.find(function(e){return e.id===r[n].id});if(r[n].edges===undefined)r[n].edges={};var t=e===0?r.target.id:r.source.id;if(r[n].id===u.id){r[n].edges[t]={angle:u.radians+Math.PI,radius:p/2}}else{r[n].edges[t]={angle:i.radians,radius:p/2}}});d.push(r)}}})});f.forEach(function(e){if(e.id!==c._center){var n=c._shapeConfig.labelConfig.fontSize&&c._shapeConfig.labelConfig.fontSize(e)||11;var t=n*1.4;var r=t*2;var i=5;var a=p-e.r;var o=e.radians*(180/Math.PI);var s=e.r+i;var u="start";if(o<-90||o>90){s=-e.r-a-i;u="end";o+=180}e.labelBounds={x:s,y:-t/2,width:a,height:r};e.rotate=o;e.textAnchor=u}else{e.labelBounds={x:-_/2,y:-_/2,width:_,height:_}}});this._linkLookup=a.reduce(function(e,n){if(!e[n.source.id])e[n.source.id]=[];e[n.source.id].push(n.target);if(!e[n.target.id])e[n.target.id]=[];e[n.target.id].push(n.source);return e},{});var L=H.extent(a,function(e){return e.size});if(L[0]!==L[1]){var A=H.min(f,function(e){return e.r});var q=Z["scale".concat(this._linkSizeScale.charAt(0).toUpperCase()).concat(this._linkSizeScale.slice(1))]().domain(L).range([this._linkSizeMin,A]);a.forEach(function(e){e.size=q(e.size)})}var B=Q.configPrep.bind(this)(this._shapeConfig,"edge","Path");delete B.on;this._shapes.push((new $.Path).config(B).strokeWidth(function(e){return e.size}).id(function(e){return"".concat(e.source.id,"_").concat(e.target.id)}).d(function(e){return e.spline?"M".concat(e.sourceX,",").concat(e.sourceY,"C").concat(e.sourceBisectX,",").concat(e.sourceBisectY," ").concat(e.targetBisectX,",").concat(e.targetBisectY," ").concat(e.targetX,",").concat(e.targetY):"M".concat(e.source.x,",").concat(e.source.y," ").concat(e.target.x,",").concat(e.target.y)}).data(d).select(Q.elem("g.d3plus-rings-links",{parent:this._select,transition:u,enter:{transform:s},update:{transform:s}}).node()).render());var T=this;var D={label:function e(n){return f.length<=c._dataCutoff||c._hover&&c._hover(n)||c._active&&c._active(n)?c._drawLabel(n.data||n.node,n.i):false},labelBounds:function e(n){return n.labelBounds},labelConfig:{fontColor:function e(n){return n.id===c._center?Q.configPrep.bind(T)(T._shapeConfig,"shape",n.key).labelConfig.fontColor(n):I.colorLegible(Q.configPrep.bind(T)(T._shapeConfig,"shape",n.key).fill(n))},fontResize:function e(n){return n.id===c._center},padding:0,textAnchor:function e(n){return r[n.id].textAnchor||Q.configPrep.bind(T)(T._shapeConfig,"shape",n.key).labelConfig.textAnchor},verticalAlign:function e(n){return n.id===c._center?"middle":"top"}},rotate:function e(n){return r[n.id].rotate||0},select:Q.elem("g.d3plus-rings-nodes",{parent:this._select,transition:u,enter:{transform:s},update:{transform:s}}).node()};U.nest().key(function(e){return e.shape}).entries(f).forEach(function(e){c._shapes.push((new $[e.key]).config(Q.configPrep.bind(c)(c._shapeConfig,"shape",e.key)).config(D).data(e.values).render())});return this}},{key:"center",value:function e(n){return arguments.length?(this._center=n,this):this._center}},{key:"hover",value:function e(n){this._hover=n;this._shapes.forEach(function(e){return e.hover(n)});if(this._legend)this._legendClass.hover(n);return this}},{key:"links",value:function e(n,t){if(arguments.length){var r=this._queue.find(function(e){return e[3]==="links"});var i=[a.dataLoad.bind(this),n,t,"links"];if(r)this._queue[this._queue.indexOf(r)]=i;else this._queue.push(i);return this}return this._links}},{key:"linkSize",value:function e(n){return arguments.length?(this._linkSize=typeof n==="function"?n:Q.constant(n),this):this._linkSize}},{key:"linkSizeMin",value:function e(n){return arguments.length?(this._linkSizeMin=n,this):this._linkSizeMin}},{key:"linkSizeScale",value:function e(n){return arguments.length?(this._linkSizeScale=n,this):this._linkSizeScale}},{key:"nodeGroupBy",value:function e(n){var t=this;if(!arguments.length)return this._nodeGroupBy;if(!(n instanceof Array))n=[n];return this._nodeGroupBy=n.map(function(e){if(typeof e==="function")return e;else{if(!t._aggs[e]){t._aggs[e]=function(e){var n=Array.from(new Set(e));return n.length===1?n[0]:n}}return Q.accessor(e)}}),this}},{key:"nodes",value:function e(n,t){if(arguments.length){var r=this._queue.find(function(e){return e[3]==="nodes"});var i=[a.dataLoad.bind(this),n,t,"nodes"];if(r)this._queue[this._queue.indexOf(r)]=i;else this._queue.push(i);return this}return this._nodes}},{key:"size",value:function e(n){return arguments.length?(this._size=typeof n==="function"||!n?n:Q.accessor(n),this):this._size}},{key:"sizeMax",value:function e(n){return arguments.length?(this._sizeMax=n,this):this._sizeMax}},{key:"sizeMin",value:function e(n){return arguments.length?(this._sizeMin=n,this):this._sizeMin}},{key:"sizeScale",value:function e(n){return arguments.length?(this._sizeScale=n,this):this._sizeScale}}]);return G}(a.Viz);var v={center:n.sankeyCenter,justify:n.sankeyJustify,left:n.sankeyLeft,right:n.sankeyRight};var p=function(e){o(f,e);function f(){var s;t(this,f);s=h(this,ne(f).call(this));s._nodeId=Q.accessor("id");s._links=Q.accessor("links");s._linksSource="source";s._linksTarget="target";s._noDataMessage=false;s._nodes=Q.accessor("nodes");s._nodeAlign=v.justify;s._nodePadding=8;s._nodeWidth=30;s._on.mouseenter=function(){};s._on["mouseleave.shape"]=function(){s.hover(false)};var u=s._on["mousemove.shape"];s._on["mousemove.shape"]=function(e,n){u(e,n);if(s._focus&&s._focus===e.id){s.hover(false);s._on.mouseenter.bind(l(s))(e,n);s._focus=undefined}else{var t=s._nodeId(e,n),r=s._nodeLookup[t],i=Object.keys(s._nodeLookup).reduce(function(e,n){e[s._nodeLookup[n]]=!isNaN(n)?parseInt(n,10):n;return e},{});var a=s._linkLookup[r];var o=[t];a.forEach(function(e){o.push(i[e])});s.hover(function(e,n){if(e.source&&e.target){return e.source.id===t||e.target.id===t}else{return o.includes(s._nodeId(e,n))}})}};s._path=n.sankeyLinkHorizontal();s._sankey=n.sankey();s._shape=Q.constant("Rect");s._shapeConfig=Q.assign(s._shapeConfig,{Path:{fill:"none",hoverStyle:{"stroke-width":function e(n){return Math.max(1,Math.abs(n.source.y1-n.source.y0)*(n.value/n.source.value)-2)}},label:false,stroke:"#DBDBDB",strokeOpacity:.5,strokeWidth:function e(n){return Math.max(1,Math.abs(n.source.y1-n.source.y0)*(n.value/n.source.value)-2)}},Rect:{}});s._value=Q.constant(1);return s}i(f,[{key:"_draw",value:function e(n){var i=this;te(ne(f.prototype),"_draw",this).call(this,n);var t=this._height-this._margin.top-this._margin.bottom,r=this._width-this._margin.left-this._margin.right;var a=Array.isArray(this._nodes)?this._nodes:this._links.reduce(function(e,n){if(!e.includes(n[i._linksSource]))e.push(n[i._linksSource]);if(!e.includes(n[i._linksTarget]))e.push(n[i._linksTarget]);return e},[]).map(function(e){return{id:e}});var o=a.map(function(e,n){return{__d3plus__:true,data:e,i:n,id:i._nodeId(e,n),node:e,shape:"Rect"}});var s=this._nodeLookup=o.reduce(function(e,n,t){e[n.id]=t;return e},{});var u=this._links.map(function(t,e){var n=[i._linksSource,i._linksTarget];var r=n.reduce(function(e,n){e[n]=s[t[n]];return e},{});return{source:r[i._linksSource],target:r[i._linksTarget],value:i._value(t,e)}});this._linkLookup=u.reduce(function(e,n){if(!e[n.source])e[n.source]=[];e[n.source].push(n.target);if(!e[n.target])e[n.target]=[];e[n.target].push(n.source);return e},{});var c="translate(".concat(this._margin.left,", ").concat(this._margin.top,")");this._sankey.nodeAlign(this._nodeAlign).nodePadding(this._nodePadding).nodeWidth(this._nodeWidth).nodes(o).links(u).size([r,t])();this._shapes.push((new $.Path).config(this._shapeConfig.Path).data(u).d(this._path).select(Q.elem("g.d3plus-Links",{parent:this._select,enter:{transform:c},update:{transform:c}}).node()).render());U.nest().key(function(e){return e.shape}).entries(o).forEach(function(e){i._shapes.push((new $[e.key]).data(e.values).height(function(e){return e.y1-e.y0}).width(function(e){return e.x1-e.x0}).x(function(e){return(e.x1+e.x0)/2}).y(function(e){return(e.y1+e.y0)/2}).select(Q.elem("g.d3plus-sankey-nodes",{parent:i._select,enter:{transform:c},update:{transform:c}}).node()).config(Q.configPrep.bind(i)(i._shapeConfig,"shape",e.key)).render())});return this}},{key:"hover",value:function e(n){this._hover=n;this._shapes.forEach(function(e){return e.hover(n)});if(this._legend)this._legendClass.hover(n);return this}},{key:"links",value:function e(n,t){if(arguments.length){var r=this._queue.find(function(e){return e[3]==="links"});var i=[a.dataLoad.bind(this),n,t,"links"];if(r)this._queue[this._queue.indexOf(r)]=i;else this._queue.push(i);return this}return this._links}},{key:"linksSource",value:function e(n){return arguments.length?(this._linksSource=n,this):this._linksSource}},{key:"linksTarget",value:function e(n){return arguments.length?(this._linksTarget=n,this):this._linksTarget}},{key:"nodeAlign",value:function e(n){return arguments.length?(this._nodeAlign=typeof n==="function"?n:v[n],this):this._nodeAlign}},{key:"nodeId",value:function e(n){return arguments.length?(this._nodeId=typeof n==="function"?n:Q.accessor(n),this):this._nodeId}},{key:"nodes",value:function e(n,t){if(arguments.length){var r=this._queue.find(function(e){return e[3]==="nodes"});var i=[a.dataLoad.bind(this),n,t,"nodes"];if(r)this._queue[this._queue.indexOf(r)]=i;else this._queue.push(i);return this}return this._nodes}},{key:"nodePadding",value:function e(n){return arguments.length?(this._nodePadding=n,this):this._nodePadding}},{key:"nodeWidth",value:function e(n){return arguments.length?(this._nodeWidth=n,this):this._nodeWidth}},{key:"value",value:function e(n){return arguments.length?(this._value=typeof n==="function"?n:Q.accessor(n),this):this._value}}]);return f}(a.Viz);e.Network=c;e.Rings=d;e.Sankey=p;Object.defineProperty(e,"__esModule",{value:true})});(function(e){typeof define==="function"&&define.amd?define(e):e()})(function(){"use strict";var e=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function n(e,n){return n={exports:{}},e(n,n.exports),n.exports}var t="object";var r=function(e){return e&&e.Math==Math&&e};var l=r(typeof globalThis==t&&globalThis)||r(typeof window==t&&window)||r(typeof self==t&&self)||r(typeof e==t&&e)||Function("return this")();var i=function(e){try{return!!e()}catch(e){return true}};var d=!i(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7});var a={}.propertyIsEnumerable;var o=Object.getOwnPropertyDescriptor;var s=o&&!a.call({1:2},1);var u=s?function e(n){var t=o(this,n);return!!t&&t.enumerable}:a;var v={f:u};var c=function(e,n){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:n}};var f={}.toString;var h=function(e){return f.call(e).slice(8,-1)};var p="".split;var k=i(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return h(e)=="String"?p.call(e,""):Object(e)}:Object;var _=function(e){if(e==undefined)throw TypeError("Can't call method on "+e);return e};var g=function(e){return k(_(e))};var y=function(e){return typeof e==="object"?e!==null:typeof e==="function"};var m=function(e,n){if(!y(e))return e;var t,r;if(n&&typeof(t=e.toString)=="function"&&!y(r=t.call(e)))return r;if(typeof(t=e.valueOf)=="function"&&!y(r=t.call(e)))return r;if(!n&&typeof(t=e.toString)=="function"&&!y(r=t.call(e)))return r;throw TypeError("Can't convert object to primitive value")};var b={}.hasOwnProperty;var x=function(e,n){return b.call(e,n)};var z=l.document;var w=y(z)&&y(z.createElement);var S=function(e){return w?z.createElement(e):{}};var M=!d&&!i(function(){return Object.defineProperty(S("div"),"a",{get:function(){return 7}}).a!=7});var O=Object.getOwnPropertyDescriptor;var P=d?O:function e(n,t){n=g(n);t=m(t,true);if(M)try{return O(n,t)}catch(e){}if(x(n,t))return c(!v.f.call(n,t),n[t])};var C={f:P};var E=function(e){if(!y(e)){throw TypeError(String(e)+" is not an object")}return e};var j=Object.defineProperty;var L=d?j:function e(n,t,r){E(n);t=m(t,true);E(r);if(M)try{return j(n,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");if("value"in r)n[t]=r.value;return n};var A={f:L};var q=d?function(e,n,t){return A.f(e,n,c(1,t))}:function(e,n,t){e[n]=t;return e};var B=function(n,t){try{q(l,n,t)}catch(e){l[n]=t}return t};var T=n(function(e){var n="__core-js_shared__";var t=l[n]||B(n,{});(e.exports=function(e,n){return t[e]||(t[e]=n!==undefined?n:{})})("versions",[]).push({version:"3.1.3",mode:"global",copyright:"Â© 2019 Denis Pushkarev (zloirock.ru)"})});var D=T("native-function-to-string",Function.toString);var G=l.WeakMap;var I=typeof G==="function"&&/native code/.test(D.call(G));var R=0;var W=Math.random();var N=function(e){return"Symbol("+String(e===undefined?"":e)+")_"+(++R+W).toString(36)};var F=T("keys");var V=function(e){return F[e]||(F[e]=N(e))};var Y={};var X=l.WeakMap;var H,U,J;var K=function(e){return J(e)?U(e):H(e,{})};var Z=function(t){return function(e){var n;if(!y(e)||(n=U(e)).type!==t){throw TypeError("Incompatible receiver, "+t+" required")}return n}};if(I){var Q=new X;var $=Q.get;var ee=Q.has;var ne=Q.set;H=function(e,n){ne.call(Q,e,n);return n};U=function(e){return $.call(Q,e)||{}};J=function(e){return ee.call(Q,e)}}else{var te=V("state");Y[te]=true;H=function(e,n){q(e,te,n);return n};U=function(e){return x(e,te)?e[te]:{}};J=function(e){return x(e,te)}}var re={set:H,get:U,has:J,enforce:K,getterFor:Z};var ie=n(function(e){var n=re.get;var s=re.enforce;var u=String(D).split("toString");T("inspectSource",function(e){return D.call(e)});(e.exports=function(e,n,t,r){var i=r?!!r.unsafe:false;var a=r?!!r.enumerable:false;var o=r?!!r.noTargetGet:false;if(typeof t=="function"){if(typeof n=="string"&&!x(t,"name"))q(t,"name",n);s(t).source=u.join(typeof n=="string"?n:"")}if(e===l){if(a)e[n]=t;else B(n,t);return}else if(!i){delete e[n]}else if(!o&&e[n]){a=true}if(a)e[n]=t;else q(e,n,t)})(Function.prototype,"toString",function e(){return typeof this=="function"&&n(this).source||D.call(this)})});var ae=l;var oe=function(e){return typeof e=="function"?e:undefined};var se=function(e,n){return arguments.length<2?oe(ae[e])||oe(l[e]):ae[e]&&ae[e][n]||l[e]&&l[e][n]};var ue=Math.ceil;var ce=Math.floor;var fe=function(e){return isNaN(e=+e)?0:(e>0?ce:ue)(e)};var le=Math.min;var he=function(e){return e>0?le(fe(e),9007199254740991):0};var de=Math.max;var ve=Math.min;var pe=function(e,n){var t=fe(e);return t<0?de(t+n,0):ve(t,n)};var _e=function(s){return function(e,n,t){var r=g(e);var i=he(r.length);var a=pe(t,i);var o;if(s&&n!=n)while(i>a){o=r[a++];if(o!=o)return true}else for(;i>a;a++){if((s||a in r)&&r[a]===n)return s||a||0}return!s&&-1}};var ge={includes:_e(true),indexOf:_e(false)};var ye=ge.indexOf;var me=function(e,n){var t=g(e);var r=0;var i=[];var a;for(a in t)!x(Y,a)&&x(t,a)&&i.push(a);while(n.length>r)if(x(t,a=n[r++])){~ye(i,a)||i.push(a)}return i};var ke=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];var be=ke.concat("length","prototype");var xe=Object.getOwnPropertyNames||function e(n){return me(n,be)};var ze={f:xe};var we=Object.getOwnPropertySymbols;var Se={f:we};var Me=se("Reflect","ownKeys")||function e(n){var t=ze.f(E(n));var r=Se.f;return r?t.concat(r(n)):t};var Oe=function(e,n){var t=Me(n);var r=A.f;var i=C.f;for(var a=0;a<t.length;a++){var o=t[a];if(!x(e,o))r(e,o,i(n,o))}};var Pe=/#|\.prototype\./;var Ce=function(e,n){var t=je[Ee(e)];return t==Ae?true:t==Le?false:typeof n=="function"?i(n):!!n};var Ee=Ce.normalize=function(e){return String(e).replace(Pe,".").toLowerCase()};var je=Ce.data={};var Le=Ce.NATIVE="N";var Ae=Ce.POLYFILL="P";var qe=Ce;var Be=C.f;var Te=function(e,n){var t=e.target;var r=e.global;var i=e.stat;var a,o,s,u,c,f;if(r){o=l}else if(i){o=l[t]||B(t,{})}else{o=(l[t]||{}).prototype}if(o)for(s in n){c=n[s];if(e.noTargetGet){f=Be(o,s);u=f&&f.value}else u=o[s];a=qe(r?s:t+(i?".":"#")+s,e.forced);if(!a&&u!==undefined){if(typeof c===typeof u)continue;Oe(c,u)}if(e.sham||u&&u.sham){q(c,"sham",true)}ie(o,s,c,e)}};var De=function(e){if(typeof e!="function"){throw TypeError(String(e)+" is not a function")}return e};var Ge=function(r,i,e){De(r);if(i===undefined)return r;switch(e){case 0:return function(){return r.call(i)};case 1:return function(e){return r.call(i,e)};case 2:return function(e,n){return r.call(i,e,n)};case 3:return function(e,n,t){return r.call(i,e,n,t)}}return function(){return r.apply(i,arguments)}};var Ie=function(e){return Object(_(e))};var Re=Array.isArray||function e(n){return h(n)=="Array"};var We=!!Object.getOwnPropertySymbols&&!i(function(){return!String(Symbol())});var Ne=l.Symbol;var Fe=T("wks");var Ve=function(e){return Fe[e]||(Fe[e]=We&&Ne[e]||(We?Ne:N)("Symbol."+e))};var Ye=Ve("species");var Xe=function(e,n){var t;if(Re(e)){t=e.constructor;if(typeof t=="function"&&(t===Array||Re(t.prototype)))t=undefined;else if(y(t)){t=t[Ye];if(t===null)t=undefined}}return new(t===undefined?Array:t)(n===0?0:n)};var He=[].push;var Ue=function(d){var v=d==1;var p=d==2;var _=d==3;var g=d==4;var y=d==6;var m=d==5||y;return function(e,n,t,r){var i=Ie(e);var a=k(i);var o=Ge(n,t,3);var s=he(a.length);var u=0;var c=r||Xe;var f=v?c(e,s):p?c(e,0):undefined;var l,h;for(;s>u;u++)if(m||u in a){l=a[u];h=o(l,u,i);if(d){if(v)f[u]=h;else if(h)switch(d){case 3:return true;case 5:return l;case 6:return u;case 2:He.call(f,l)}else if(g)return false}}return y?-1:_||g?g:f}};var Je={forEach:Ue(0),map:Ue(1),filter:Ue(2),some:Ue(3),every:Ue(4),find:Ue(5),findIndex:Ue(6)};var Ke=Object.keys||function e(n){return me(n,ke)};var Ze=d?Object.defineProperties:function e(n,t){E(n);var r=Ke(t);var i=r.length;var a=0;var o;while(i>a)A.f(n,o=r[a++],t[o]);return n};var Qe=se("document","documentElement");var $e=V("IE_PROTO");var en="prototype";var nn=function(){};var tn=function(){var e=S("iframe");var n=ke.length;var t="<";var r="script";var i=">";var a="java"+r+":";var o;e.style.display="none";Qe.appendChild(e);e.src=String(a);o=e.contentWindow.document;o.open();o.write(t+r+i+"document.F=Object"+t+"/"+r+i);o.close();tn=o.F;while(n--)delete tn[en][ke[n]];return tn()};var rn=Object.create||function e(n,t){var r;if(n!==null){nn[en]=E(n);r=new nn;nn[en]=null;r[$e]=n}else r=tn();return t===undefined?r:Ze(r,t)};Y[$e]=true;var an=Ve("unscopables");var on=Array.prototype;if(on[an]==undefined){q(on,an,rn(null))}var sn=function(e){on[an][e]=true};var un=Je.find;var cn="find";var fn=true;if(cn in[])Array(1)[cn](function(){fn=false});Te({target:"Array",proto:true,forced:fn},{find:function e(n){return un(this,n,arguments.length>1?arguments[1]:undefined)}});sn(cn);var ln=ge.includes;Te({target:"Array",proto:true},{includes:function e(n){return ln(this,n,arguments.length>1?arguments[1]:undefined)}});sn("includes");var hn=Object.assign;var dn=!hn||i(function(){var e={};var n={};var t=Symbol();var r="abcdefghijklmnopqrst";e[t]=7;r.split("").forEach(function(e){n[e]=e});return hn({},e)[t]!=7||Ke(hn({},n)).join("")!=r})?function e(n,t){var r=Ie(n);var i=arguments.length;var a=1;var o=Se.f;var s=v.f;while(i>a){var u=k(arguments[a++]);var c=o?Ke(u).concat(o(u)):Ke(u);var f=c.length;var l=0;var h;while(f>l){h=c[l++];if(!d||s.call(u,h))r[h]=u[h]}}return r}:hn;Te({target:"Object",stat:true,forced:Object.assign!==dn},{assign:dn});var vn=Ve("match");var pn=function(e){var n;return y(e)&&((n=e[vn])!==undefined?!!n:h(e)=="RegExp")};var _n=function(e){if(pn(e)){throw TypeError("The method doesn't accept regular expressions")}return e};var gn=Ve("match");var yn=function(n){var t=/./;try{"/./"[n](t)}catch(e){try{t[gn]=false;return"/./"[n](t)}catch(e){}}return false};Te({target:"String",proto:true,forced:!yn("includes")},{includes:function e(n){return!!~String(_(this)).indexOf(_n(n),arguments.length>1?arguments[1]:undefined)}});var mn="".startsWith;var kn=Math.min;Te({target:"String",proto:true,forced:!yn("startsWith")},{startsWith:function e(n){var t=String(_(this));_n(n);var r=he(kn(arguments.length>1?arguments[1]:undefined,t.length));var i=String(n);return mn?mn.call(t,i,r):t.slice(r,r+i.length)===i}});if(typeof window!=="undefined"){(function(){var r=function(e,n){var t=e.nodeType;if(t===3){n.push(e.textContent.replace(/&/,"&amp;").replace(/</,"&lt;").replace(">","&gt;"))}else if(t===1){n.push("<",e.tagName);if(e.hasAttributes()){[].forEach.call(e.attributes,function(e){n.push(" ",e.item.name,"='",e.item.value,"'")})}if(e.hasChildNodes()){n.push(">");[].forEach.call(e.childNodes,function(e){r(e,n)});n.push("</",e.tagName,">")}else{n.push("/>")}}else if(t==8){n.push("\x3c!--",e.nodeValue,"--\x3e")}};Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){var e=[];var n=this.firstChild;while(n){r(n,e);n=n.nextSibling}return e.join("")},set:function(e){while(this.firstChild){this.removeChild(this.firstChild)}try{var n=new DOMParser;n.async=false;var t="<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>"+e+"</svg>";var r=n.parseFromString(t,"text/xml").documentElement;var i=r.firstChild;while(i){this.appendChild(this.ownerDocument.importNode(i,true));i=i.nextSibling}}catch(e){}}});Object.defineProperty(SVGElement.prototype,"innerSVG",{get:function(){return this.innerHTML},set:function(e){this.innerHTML=e}})})()}});