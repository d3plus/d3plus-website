/*
  d3plus-common v0.4.1
  Common functions and methods used across D3plus modules.
  Copyright (c) 2016 D3plus - https://d3plus.org
  @license MIT
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-array"),require("d3-collection"),require("d3-selection")):"function"==typeof define&&define.amd?define("d3plus-common",["exports","d3-array","d3-collection","d3-selection"],t):t(e.d3plus=e.d3plus||{},e.d3Array,e.d3Collection,e.d3Selection)}(this,function(e,t,n,r){"use strict";function o(e,t){return void 0===t?function(t){return t[e]}:function(n){return void 0===n[e]?t:n[e]}}function a(e){var r=new Set(t.merge(e.map(function(e){return n.keys(e)}))),o={};return r.forEach(function(n){var r,a=e.map(function(e){return e[n]});a.map(function(e){return typeof e}).indexOf("string")>=0?(r=Array.from(new Set(a).values()),1===r.length&&(r=r[0])):r=t.sum(a),o[n]=r}),o}function i(e,r,o){void 0===o&&(o=[]),!o||o instanceof Array||(o=[o]);var i,u,s=n.nest().key(r).entries(e);if(o.length)for(var l=s.length,c=function(r){var c=s.map(function(e){return Array.from(new Set(e.values.map(function(e){return o[r](e)})))}),f=t.sum(c,function(e){return e.length}),d=new Set(t.merge(c)).size;return f===l&&d===l||r===o.length-1?(u=o[r],i=n.nest().key(u).entries(e).map(function(e){return a(e.values)}),"break"):void 0},f=0;f<o.length;f++){var d=c(f);if("break"===d)break}else u=r,i=s.map(function(e){return a(e.values)});return{data:i,id:u}}function u(e){return function(){return e}}function s(e,t){if(void 0===e.tagName||["BODY","HTML"].indexOf(e.tagName)>=0){var n=window["inner"+(t.charAt(0).toUpperCase()+t.slice(1))],o=r.select(e);return"width"===t?(n-=parseFloat(o.style("margin-left"),10),n-=parseFloat(o.style("margin-right"),10),n-=parseFloat(o.style("padding-left"),10),n-=parseFloat(o.style("padding-right"),10)):(n-=parseFloat(o.style("margin-top"),10),n-=parseFloat(o.style("margin-bottom"),10),n-=parseFloat(o.style("padding-top"),10),n-=parseFloat(o.style("padding-bottom"),10)),n}var a=parseFloat(r.select(e).style(t),10);return"number"==typeof a&&a>0?a:s(e.parentNode,t)}function l(e){return[s(e,"width"),s(e,"height")]}e.accessor=o,e.colorNest=i,e.constant=u,e.getSize=l,e.merge=a,Object.defineProperty(e,"__esModule",{value:!0})});