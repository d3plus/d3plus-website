/*
  d3plus-timeline v0.2.0
  An easy-to-use javascript timeline.
  Copyright (c) 2016 D3plus - https://d3plus.org
  @license MIT
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-brush"),require("d3-selection"),require("d3plus-axis"),require("d3plus-common")):"function"==typeof define&&define.amd?define("d3plus-timeline",["exports","d3-brush","d3-selection","d3plus-axis","d3plus-common"],e):e(t.d3plus=t.d3plus||{},t.d3Brush,t.d3Selection,t.d3plusAxis,t.d3plusCommon)}(this,function(t,e,i,s,n){"use strict";var h=function(t){function h(){var e=this;t.call(this),this._domain=[2001,2010],this._gridSize=0,this._handleConfig={fill:"#444"},this._handleSize=6,this._height=100,this._on={},this.orient("bottom"),this._scale="time",this._selectionConfig={fill:"#777"},this._shape="Rect",this._shapeConfig=Object.assign({},this._shapeConfig,{height:10,width:function(t){return e._domain.map(function(t){return s.date(t).getTime()}).includes(t.id)?2:1}})}return t&&(h.__proto__=t),h.prototype=Object.create(t&&t.prototype),h.prototype.constructor=h,h.prototype._brushBrush=function(){this._brushStyle(),this._on.brush&&this._on.brush()},h.prototype._brushEnd=function(){if(i.event.sourceEvent){var t=(i.event.selection?i.event.selection:[i.event.sourceEvent.offsetX,i.event.sourceEvent.offsetX]).map(this._d3Scale.invert).map(Number),e=this._availableTicks.map(Number);t[0]=s.date(n.closest(t[0],e)),t[1]=s.date(n.closest(t[1],e));var h=t.map(this._d3Scale),o=h[0]===h[1];o&&(h[0]-=.1,h[1]+=.1),this._brushGroup.transition(this._transition).call(this._brush.move,h),this._brushStyle(),this._on.end&&this._on.end(o?t[0]:t)}},h.prototype._brushStart=function(){this._brushStyle(),this._on.start&&this._on.start()},h.prototype._brushStyle=function(){var t=this._position,e=t.height,i="Circle"===this._shape?2*this._shapeConfig.r:"Rect"===this._shape?this._shapeConfig[e]:this._tickSize;this._brushGroup.selectAll(".selection").call(n.attrize,this._selectionConfig).attr("height",i),this._brushGroup.selectAll(".handle").call(n.attrize,this._handleConfig).attr("height",i+this._handleSize)},h.prototype.render=function(i){t.prototype.render.call(this,i);var h=this._position,o=h.height,r=h.y,l=this._outerBounds[r],u=this._d3Scale.range(),a=this._brush=e.brushX().extent([[u[0],l],[u[1],l+this._outerBounds[o]]]).handleSize(this._handleSize).on("start",this._brushStart.bind(this)).on("brush",this._brushBrush.bind(this)).on("end",this._brushEnd.bind(this)),_=this._availableTicks[this._availableTicks.length-1],c=(void 0===this._selection?[_,_]:this._selection instanceof Array?this._selection.slice():[this._selection,this._selection]).map(s.date).map(this._d3Scale);return c[0]===c[1]&&(c[0]-=.1,c[1]+=.1),this._brushGroup=n.elem("g.brushGroup",{parent:this._group}),this._brushGroup.call(a).transition(this._transition).call(a.move,c),this},h.prototype.handleConfig=function(t){return arguments.length?(this._handleConfig=Object.assign(this._handleConfig,t),this):this._handleConfig},h.prototype.handleSize=function(t){return arguments.length?(this._handleSize=t,this):this._handleSize},h.prototype.on=function(t,e){return 2===arguments.length?(this._on[t]=e,this):arguments.length?"string"==typeof t?this._on[t]:(this._on=Object.assign({},this._on,t),this):this._on},h.prototype.selectionConfig=function(t){return arguments.length?(this._selectionConfig=Object.assign(this._selectionConfig,t),this):this._selectionConfig},h.prototype.selection=function(t){return arguments.length?(this._selection=t,this):this._selection},h}(s.Axis);t.Timeline=h,Object.defineProperty(t,"__esModule",{value:!0})});