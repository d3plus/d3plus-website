/*
  d3plus-timeline v0.2.2
  An easy-to-use javascript timeline.
  Copyright (c) 2016 D3plus - https://d3plus.org
  @license MIT
*/
(function(t,i){typeof exports==="object"&&typeof module!=="undefined"?i(exports,require("d3-brush"),require("d3-selection"),require("d3plus-axis"),require("d3plus-common")):typeof define==="function"&&define.amd?define("d3plus-timeline",["exports","d3-brush","d3-selection","d3plus-axis","d3plus-common"],i):i(t.d3plus=t.d3plus||{},t.d3Brush,t.d3Selection,t.d3plusAxis,t.d3plusCommon)})(this,function(t,i,e,s,n){"use strict";var h=function(t){function h(){var i=this;t.call(this);this._brushFilter=function(){return!e.event.button&&e.event.detail<2};this._domain=[2001,2010];this._gridSize=0;this._handleConfig={fill:"#444"};this._handleSize=6;this._height=100;this._on={};this.orient("bottom");this._scale="time";this._selectionConfig={fill:"#777","stroke-width":0};this._shape="Rect";this._shapeConfig=Object.assign({},this._shapeConfig,{height:10,width:function(t){return i._domain.map(function(t){return s.date(t).getTime()}).includes(t.id)?2:1}})}if(t)h.__proto__=t;h.prototype=Object.create(t&&t.prototype);h.prototype.constructor=h;h.prototype._brushBrush=function t(){this._brushStyle();if(this._on.brush)this._on.brush()};h.prototype._brushEnd=function t(){if(!e.event.sourceEvent)return;var i=(e.event.selection?e.event.selection:[e.event.sourceEvent.offsetX,e.event.sourceEvent.offsetX]).map(this._d3Scale.invert).map(Number);var h=this._availableTicks.map(Number);i[0]=s.date(n.closest(i[0],h));i[1]=s.date(n.closest(i[1],h));var o=i.map(this._d3Scale),r=o[0]===o[1];if(r){o[0]-=.1;o[1]+=.1}this._brushGroup.transition(this._transition).call(this._brush.move,o);this._brushStyle();if(this._on.end)this._on.end(r?i[0]:i)};h.prototype._brushStart=function t(){this._brushStyle();if(this._on.start)this._on.start()};h.prototype._brushStyle=function t(){var i=this._position;var e=i.height;var s=this._shape==="Circle"?this._shapeConfig.r*2:this._shape==="Rect"?this._shapeConfig[e]:this._tickSize;this._brushGroup.selectAll(".selection").call(n.attrize,this._selectionConfig).attr("height",s);this._brushGroup.selectAll(".handle").call(n.attrize,this._handleConfig).attr("height",s+this._handleSize)};h.prototype.render=function e(h){t.prototype.render.call(this,h);var o=this._position;var r=o.height;var l=o.y;var u=this._outerBounds[l],a=this._d3Scale.range();var _=this._brush=i.brushX().extent([[a[0],u],[a[1],u+this._outerBounds[r]]]).filter(this._brushFilter).handleSize(this._handleSize).on("start",this._brushStart.bind(this)).on("brush",this._brushBrush.bind(this)).on("end",this._brushEnd.bind(this));var c=this._availableTicks[this._availableTicks.length-1];var p=(this._selection===void 0?[c,c]:this._selection instanceof Array?this._selection.slice():[this._selection,this._selection]).map(s.date).map(this._d3Scale);if(p[0]===p[1]){p[0]-=.1;p[1]+=.1}this._brushGroup=n.elem("g.brushGroup",{parent:this._group});this._brushGroup.call(_).transition(this._transition).call(_.move,p);return this};h.prototype.brushFilter=function t(i){return arguments.length?(this._brushFilter=i,this):this._brushFilter};h.prototype.handleConfig=function t(i){return arguments.length?(this._handleConfig=Object.assign(this._handleConfig,i),this):this._handleConfig};h.prototype.handleSize=function t(i){return arguments.length?(this._handleSize=i,this):this._handleSize};h.prototype.on=function t(i,e){return arguments.length===2?(this._on[i]=e,this):arguments.length?typeof i==="string"?this._on[i]:(this._on=Object.assign({},this._on,i),this):this._on};h.prototype.selectionConfig=function t(i){return arguments.length?(this._selectionConfig=Object.assign(this._selectionConfig,i),this):this._selectionConfig};h.prototype.selection=function t(i){return arguments.length?(this._selection=i,this):this._selection};return h}(s.Axis);t.Timeline=h;Object.defineProperty(t,"__esModule",{value:true})});